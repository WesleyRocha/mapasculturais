{"version":3,"sources":["application/themes/obec/assets/js/tim.js","application/themes/BaseV1/assets/js/mapasculturais.js","application/themes/BaseV1/assets/js/ng-mapasculturais.js","application/themes/BaseV1/assets/js/ng.mc.module.notifications.js","application/themes/BaseV1/assets/js/map.js","application/themes/BaseV1/assets/js/ng.search.controller.spatial.js","application/themes/BaseV1/assets/js/ng.search.service.find.js","application/themes/BaseV1/assets/js/ng.search.service.findOne.js","application/themes/BaseV1/assets/js/ng.search.controller.map.js","application/themes/BaseV1/assets/js/ng.search.app.js"],"names":["$","document","unbind","MapasCulturais","mode","i","s","o","g","r","a","m","q","push","arguments","l","Date","createElement","getElementsByTagName","async","src","parentNode","insertBefore","window","ga","ready","deviceAgent","navigator","userAgent","toLowerCase","isTouchDevice","documentElement","match","addClass","remove","lastScrollTop","$mainHeader","headerHeight","outerHeight","header_animation_status","length","is","css","body","hasClass","magnificPopup","delegate","type","closeMarkup","gallery","enabled","arrowMarkup","tPrev","tNext","tCounter","adjustHeader","$mapa","$editableEntity","$busca","buscaTop","headerDosResultadosHeight","scrollTop","this","diffScrollTop","newHeaderTop","parseInt","parent","append","find","appendTo","data","height","leaflet","map","invalidateSize","removeClass","position","top","stop","fadeIn","fadeOut","scroll","resize","each","$active","$content","$links","filter","location","hash","attr","not","hide","replace","on","e","show","preventDefault","toString","click","slimScroll","distance","color","alwaysVisible","railVisible","maxHeight","parents","$input","setTimeout","select","focus","event","stopPropagation","target","url_template","params","entity","keyword","val","search_url","Mustache","render","keyCode","blur","prev","next","display","opacity","kc","tabindex","$items","find_next_page_menu_item","$next_page_item","offset","find_prev_page_menu_item","show_hide_scrolls","skip_animation","speed","animate","scroll_timeout","clearTimeout","__this","scrollto","Math","ceil","nav_mouseenter","apply","$target","skip_show","$page_item","html","mouseenter","mouseleave","width","hover","siblings","marginLeft","$slider","hl","tip","init","$this","_left","left","outerWidth","scrollLeft","_top","_height","content","indexOf","substr","zIndex","diff","jQuery","TemplateManager","Modal","initKeyboard","initDialogs","initButtons","EditBox","initBoxes","Video","setupVideoGallery","Search","slideUp","request","controller","App","$els","useRegistrations","reason","editable","$self","eval","one","fadeToggle","$dropdown","$submenu","roleToRemove","roleToAdd","label","change","post","baseURL","id","role","error","spinnerURL","assetURL","appName","ua","isNaN","version","split","getTypeName","utils","getObjectProperties","obj","keys","key","sortOjectProperties","newObj","sort","forEach","isObjectEquals","obj1","obj2","JSON","stringify","inArray","array","arraySearch","createUrl","controller_id","action_name","args","shortcuts","routes","actions","controllers","u","route","default_action_name","auth","cb","require","finish","templates","$templates","text","getTemplate","selector","trigger","defaultAvatarURL","assets","avatarAgent","editableEntityAddHash","href","cleanHref","Messages","delayToFadeOut","fadeOutSpeed","showMessage","message","$container","$message","$mainSection","slideDown","marginTop","delay","success","help","alert","confirm","time","keyup","$dialog","prepend","close","dialog_selector","open","setPosition","$box","my","at","of","submit_label","cancel_label","submit","$button","AjaxUploader","resetProgressBar","first","collection","parseURL","url","purl","isYoutube","parsedURL","getYoutubeData","youtubeVideoID","thumbnalURL","videoID","playerURL","getVideoBasicData","host","provider","param","gallerySelector","getAndSetVideoData","setupVideoGalleryItem","$firstItem","videoData","$element","thumbnailURL","video_id","setTitle","videoTitle","videoURL","callback","trim","details","getJSON","entry","title","$t","tmpArray","format","thumbnail_small","withDetails","functionName","limit","$selector","name","select2","placeholder","minimumInputLength","allowClear","initSelection","ajax","apiMethod","formats","dataType","quietMillis","term","page","searchParams","getEntityController","ajaxData","results","more","formatResult","result","formatSelection","selection","formatNoMatches","noMatches","escapeMarkup","input","onSave","console","log","onHidden","entitiyControllers","default","@select","@limit","@page","@order","@files","agent","processEntity","areas","terms","area","join","linguagens","linguagem","tags","thumbnail","entityDefaultAvatar","toUpperCase","slice","renderTemplate","template","getEntityThumbnail","thumbName","files","searchResultTemplate","excludedIds","chooseProject","onClear","chooseSpace","avatarUrl","shortDescription","avatar","avatarSmall","createAgentRelation","$selectionTarget","targetAction","selectionTemplate","groupname","agentId","group","has_control","RelatedAgents","addAgentToGroup","markup","noResultTemplate","agentRelationGroupExludeIds","concat","toArray","parentSpace","excludeIds","childrenIds","parentProject","projectRegistration","cookies","get","user","isUserProfile","changeOwner","ownerId","nameEQ","ca","cookie","c","charAt","substring","set","value","options","extend","expires","days","t","setDate","getDate","toUTCString","String","encodeURIComponent","raw","path","domain","secure","Map","initialize","mapSelector","locateMeControl","exportToGlobalScope","mapCenter","angular","app","module","config","$httpProvider","responseInterceptors","$q","$rootScope","promise","$broadcast","then","response","reject","factory","$log","$http","service","deferred","defer","resolve","updateOne","action","$sce","$scope","$interval","NotificationService","panelURI","notifications","index","trustAsHtml","getNotifications","approve","delete","adjustScroll","directive","scope","element","attrs","$last","$evalAsync","onLastRepeat","moduleName","ctrl","querySelector","parentElement","bootstrap","L","Icon","Default","imagePath","initializerOptions","mapsDefaults","defaultIconOptions","shadowUrl","pinShadow","iconSize","shadowSize","iconAnchor","shadowAnchor","popupAnchor","iconTypeMapping","pinAgent","coletivo","space","pinSpace","pinEvent","pinMarker","iconOptions","iconType","opts","parse","iconUrl","icon","isEditable","isMapEditable","cursor","$dataTarget","isPositionDefined","defaultZoom","zoomPrecise","zoomDefault","defaultLocateMaxZoom","defaultAproximatePrecisionZoom","zoomApproximate","defaultMaxCircleRadius","LatLng","latitude","longitude","dragging","zoomControl","doubleClickZoom","scrollWheelZoom","center","lat","lng","zoom","minZoom","zoomMin","openStreetMap","tileLayer","attribution","maxZoom","zoomMax","addLayer","timeout","disable","reenableScrollWheelZoom","enable","marker","getCenter","draggable","markerIcon","Object","setIcon","setLatLng","addTo","latlng","radius","accuracy","locate","setView","Polygon","prototype","pts","_latlngs","off","twicearea","x","y","nPts","p1","p2","f","j","geocoder","google","maps","Geocoder","geocode_callback","status","GeocoderStatus","OK","geometry","foundLocation","latLng","newValue","strAddress","geocode","address","Control","onAdd","controlDiv","DomUtil","create","DomEvent","addListener","controlUI","innerHTML","addControl","camadasBase","includeGoogleLayers","googleSatelite","Google","googleMapa","_type","googleHibrido","googleRelevo","camadasGoogle","Google Satélite","Google Mapa","Google Satélite Puro","Google Relevo","geoDivisions","lvector","PRWSF","vectorLayersURL","geotable","fields","geomFieldName","mapGeometryFieldQuery","uniqueField","srid","showAll","mouseoverEvent","feature","labelText","properties","vector","bindLabel","showLabel","singlePopup","symbology","vectorOptions","className","FullScreen","Zoom","geoDivisionsObj","div_id","geoDivisionsHierarchy","div_label","onRemove","layersControl","Layers","setGeoChecboxes","prop","$checkbox","setMap","where","geoDivisionType","_makeJsonpRequest","cache","_processFeatures","$control","publicLocation","empty","undefined","fullScreenApi","requestFullScreen","el","prefix","requestFullscreen","Element","ALLOW_KEYBOARD_INPUT","$window","$location","$timeout","drawnItems","FeatureGroup","global","locationFilters","lf","Circle","filterAddress","drawLocal","draw","handlers","circle","tooltip","start","end","toolbar","buttons","Draw","_onMouseMove","showRadius","useMetric","metric","_tooltip","updatePosition","_isDrawing","_drawShape","_shape","getRadius","toFixed","updateContent","subtext","GeometryUtil","readableDistance","drawControl","polygon","rectangle","polyline","shapeOptions","edit","layerType","layer","_latlng","_mRadius","$apply","bindPopup","locationMarker","removeLayer","$timout","cancel","dataTimeout","neighborhoodRadius","defaultLocationRadius","openPopup","neighborhood","locationCircle","filterNeighborhood","addressString","$watch","oldValue","resultLayer","getBounds","_northEast","fitBounds","timer2","lastResult","activeRequests","canceler","lastEmitedResult","lastEmitedCountResult","lastQueries","enabledEntities","project","listedEntity","list","spinnerCount","$on","search","searchArgs","ev","numRequests","numSuccessRequests","numCountRequests","numCountSuccessRequests","countResults","paginating","resetPagination","viewMode","compareEnabledEntities","equals","agentQueryData","data2searchData","copy","callApi","eventQueryData","spaceQueryData","activeEntity","filterEntity","listQueryData","pagination","isDiff","isPaginating","endCountRequest","endRequest","sData","requestEntity","requestAction","otherRequestEntity","otherRequestAction","apiCount","rs","events","apiFind","header","metadata","spaces","count","countAndRemoveResultsNotInMap","item","resultsNotInMap","$emit","entityData","searchData","selectedAreas","taxonomyTerms","selectedLinguagens","types","classificacaoEtaria","selectedClassificacoesEtarias","classificacoesEtarias","acessibilidade","isVerified","_geoLocation","from","to","ropen","today","moment","registrationFrom","registrationTo","searchFilters","selectData","apiExportURL","querystring","queryString_apiExport","att","apiURL","method","openEntity","apiFindOne","apiSpaceEvents","spaceId","FindOneService","markers","setMapView","getZoom","updateMap","clearLayers","_layers","lastLayer","getLayers","pop","createMarkers","setZoom","panTo","infobox","infoboxContent","$parent","collapsedFilters","entityType","markerClusterGroup","spiderfyOnMaxZoom","showCoverageOnHover","zoomToBoundsOnClick","spiderfyDistanceMultiplier","mapSpiderfyDistanceMultiplier","maxClusterRadius","mapMaxClusterRadius","iconCreateFunction","cluster","iconClass","getChildMarkers","hasAgent","hasEvent","hasSpace","_markers","_childClusters","child_cluster","divIcon","getChildCount","point","addLayers","__c","_addLayer","p","__parent","hasEntityType","_childCount","mapMaxClusterElements","spiderfy","zoomToBounds","timeoutTime","skeletonData","isCombined","add","diffFilter","_diffFilter","isEmpty","isObject","skeleton","isArray","output","currVal","deepExtend","extension","$rison","searchService","assetsUrl","getName","valores","getId","isSelected","toggleSelection","splice","toggleVerified","showInfobox","showFilters","hasFilter","ctx","has","cleanAllFilters","cleanLocationFilters","tabClick","n","parseHash","timer","dataChange","v","k","serialized","scrollTo","scrollY","classificacoes","entityTypes","unshift","agents","projects","infiniteScrollTimeout","addMore","numResults","num","numAgents","numSpaces","numEvents","numEventsInList","numProjects","formatDate","date","dateOptions","dateFormat","showEventDateFilter","eventDateFilter","cleanEventDateFilters","readableProjectRegistrationDates","toggleAdvancedFilters"],"mappings":"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","file":"/vagrant/src/assets/js/app-10b03094699a4e1330a9d26482c8fcb3.js","sourcesContent":["(function($) {\n    // to prevent jQuery bug\n    $(document).unbind('DOMNodeInserted.mask');\n\n    // Analytics\n    if(MapasCulturais.mode !== 'development'){\n        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){\n        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),\n        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)\n        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');\n\n        ga('create', 'UA-53455459-1', 'auto');\n        ga('send', 'pageview');\n    }\n\n\n    $(document).ready(function() {\n\n        var deviceAgent = navigator.userAgent.toLowerCase();\n\n        var isTouchDevice = 'ontouchstart' in document.documentElement ||\n        (deviceAgent.match(/(iphone|ipod|ipad)/) ||\n        deviceAgent.match(/(android)/)  ||\n        deviceAgent.match(/(iemobile)/) ||\n        deviceAgent.match(/iphone/i) ||\n        deviceAgent.match(/ipad/i) ||\n        deviceAgent.match(/ipod/i) ||\n        deviceAgent.match(/blackberry/i) ||\n        deviceAgent.match(/bada/i));\n\n        window.isTouchDevice = isTouchDevice;\n        $('body').addClass('touch-device');\n\n        if(MapasCulturais.mode !== 'development')\n            $('.staging-hidden').remove();\n\n        // posição do header\n        var lastScrollTop = 0;\n\n        var $mainHeader = $('#main-header');\n        var headerHeight = $mainHeader.outerHeight(true);\n\n        var header_animation_status = 0;\n\n        if ($('#editable-entity').length && $('#editable-entity').is(':visible')) {\n            $('#main-section').css('margin-top', headerHeight + $('#editable-entity').outerHeight(true));\n        }\n\n        // inicializa a galeria\n        if ($(document.body).hasClass('action-single') && $(document.body).hasClass('entity')) {\n            $('.js-gallery').magnificPopup({\n                delegate: 'a', // child items selector, by clicking on it popup will open\n                type: 'image',\n                closeMarkup: '<span class=\"mfp-close icon icon-close\"></span>',\n                gallery:{\n                    enabled:true,\n\n                    arrowMarkup: '<button title=\"%title%\" type=\"button\" class=\"mfp-arrow mfp-arrow-%dir%\"><span class=\"icon icon-arrow-%dir% mfp-prevent-close\"></span></button>', // markup of an arrow button\n                    tPrev: 'Anterior', // title for left button\n                    tNext: 'Próxima', // title for right button\n                    tCounter: '%curr% de %total%' // markup of counter\n                }\n            });\n        }\n\n\n        // ajusta o tamanho do mapa internamente no leaflet\n\n        function adjustHeader() {\n            // @TODO: pra otimizar a performance só calcular e executar a animação se esta ainda não terminou para o sentido do scroll,\n            // exemplo: se está scrollando pra baixo e o header já está oculto não precisa calcular e mover ele\n            var $mapa, $editableEntity, $busca, $mapa, buscaTop, headerDosResultadosHeight,\n                    scrollTop = $(this).scrollTop(),\n                    diffScrollTop = (lastScrollTop - scrollTop),\n                    newHeaderTop = parseInt($mainHeader.css('top')) + diffScrollTop;\n\n            if ($('#header-search-row').length) {\n                $busca = $('#header-search-row');\n                $mapa = $('#search-map-container');\n                if (!$busca.parent().is($mainHeader)) {\n                    $mainHeader.append($('<div id=\"header-nav-row\" class=\"clearfix\">').append($mainHeader.find('>*')));\n                    $busca.appendTo($mainHeader);\n                }\n\n                headerDosResultadosHeight = $(\"#search-results-header\").outerHeight(true);\n\n                headerHeight = $mainHeader.outerHeight() - headerDosResultadosHeight;\n\n                buscaTop = $mainHeader.outerHeight(true);\n\n                if (buscaTop < 0)\n                    buscaTop = 0;\n//                $busca.css({position: 'fixed', top: buscaTop, zIndex: 123});\n\n\n                $('#lista').css('margin-top', headerHeight + headerDosResultadosHeight);\n\n                if ($mapa.is(':visible')) {\n                    $busca.addClass('sombra');\n\n                    $mapa.css('top', newHeaderTop + headerHeight + headerDosResultadosHeight);\n\n                    if ($mapa.data('oldHeight') != $mapa.height() && window.leaflet)\n                        window.leaflet.map.invalidateSize();\n\n                    if ($('#infobox'))\n                        $('#infobox').height($('#search-map-container').height() - 44)\n\n                    $mapa.data('oldHeight', $mapa.height());\n                } else if (scrollTop == 0 && !$mapa.is(':visible'))\n                    $busca.removeClass('sombra');\n                else\n                    $busca.addClass('sombra');\n\n\n                $('body').css('min-height', $(window).height() + headerHeight - headerDosResultadosHeight - 30);\n\n            }\n\n            if (newHeaderTop <= -headerHeight) {\n                newHeaderTop = -headerHeight;\n\n            } else if (newHeaderTop >= 0) {\n                newHeaderTop = 0;\n\n            } else if (newHeaderTop < -$(window).scrollTop()) {\n                newHeaderTop = -$(window).scrollTop();\n            }\n            if (parseInt($mainHeader.css('top')) <= -headerHeight + 3)\n                $mainHeader.removeClass('sombra');\n            else\n                $mainHeader.addClass('sombra');\n\n            $mainHeader.css('top', newHeaderTop);\n\n\n\n            if ($('#editable-entity:visible').length) {\n                $editableEntity = $('#editable-entity');\n\n                $editableEntity.css('top', newHeaderTop + headerHeight);\n\n                //Sugestão de colocar o logo e outras coisas na edit bar:\n                // if scrolltop > x\n                if ($editableEntity.position().top == 0) {\n                    $mainHeader.removeClass('sombra');\n                    $editableEntity.addClass('sombra');\n                    $('#small-brand').stop().fadeIn(100);\n                } else {\n                    $editableEntity.removeClass('sombra');\n                    $('#small-brand').stop().fadeOut(100);\n                }\n\n            }\n\n            lastScrollTop = scrollTop;\n        }\n\n        // animações do scroll\n        $(window).scroll(adjustHeader).resize(adjustHeader);\n        adjustHeader();\n        window.adjustHeader = adjustHeader;\n\n        $('ul.abas').each(function() {\n            // For each set of tabs, we want to keep track of\n            // which tab is active and it's associated content\n            var $active, $content, $links = $(this).find('a');\n\n            // If the location.hash matches one of the links, use that as the active tab.\n            // If no match is found, use the first link as the initial active tab.\n            $active = $($links.filter('[href=\"' + location.hash + '\"]')[0] || $links[0]);\n            $active.parent().addClass('active');\n            $content = $($active.attr('href'));\n\n            // Hide the remaining content\n            $links.not($active).each(function() {\n                $($(this).attr('href')).hide();\n            });\n\n            $links.each(function() {\n                $(this).attr('id', 'tab-' + $(this).attr('href').replace('#', ''));\n            });\n\n\n            // Bind the click event handler\n            $(this).on('click', 'a', function(e) {\n                // Make the old tab inactive.\n                $active.parent().removeClass('active');\n                $content.hide();\n\n                // Update the variables with the new link and content\n                $active = $(this);\n                $content = $($(this).attr('href'));\n\n                // Make the tab active.\n                $active.parent().addClass('active');\n                $content.show();\n\n                // Prevent the anchor's default click action\n                e.preventDefault();\n\n                location.hash = $(this).attr('id').replace('tab-', 'tab=');\n            });\n\n            $links.each(function() {\n                if (location.hash.toString().replace('#', '') === $(this).attr('id').replace('tab-', 'tab=')) {\n                    $(this).click();\n                }\n            });\n        });\n\n\n\n        $('.tag-box div').slimScroll({\n            position: 'right',\n            distance: '0px',\n            color: '#000',\n            height: '148px',\n            alwaysVisible: true,\n            railVisible: true\n        });\n        $('.submenu-dropdown .filter-list').slimScroll({\n            position: 'right',\n            distance: '3px',\n            color: '#000',\n            height: '222px',\n            alwaysVisible: true,\n            railVisible: true\n        });\n        $('.js-slimScroll').each(function() {\n\n            $(this).slimScroll({\n                position: 'right',\n                distance: '0px',\n                color: '#000',\n                height: '192px'\n            });\n\n            $(this).css({height: 'initial', maxHeight: 192}).parents('.slimScrollDiv').css({height: 'initial', maxHeight: 216});\n        });\n\n        $('#share-tools a.icon-share').click(function() {\n            if ($('form#share-url').is(':hidden')) {\n                $('form#share-url').show();\n                var $input = $('form#share-url input');\n                $input.on('focus click', function() {\n                    window.setTimeout(function() {\n                        $input.select();\n                    }, 0);\n                }).focus();\n                //$input.focus();\n                event.stopPropagation();\n            } else {\n                $('form#share-url').hide();\n            }\n        });\n        $('html').on('click', function(event) {\n            if (!$(event.target).parents('#share-tools').length) {\n                $('form#share-url').hide();\n            }\n        });\n\n        //Botão de busca da home\n        if($('#home-search-form').length){\n            $('#campo-de-busca').focus();\n            $('#home-search-filter .submenu-dropdown li').click(function() {\n                var url_template = $(this).data('searh-url-template') ?\n                        $(this).data('searh-url-template') : $(\"#home-search-filter\").data('searh-url-template');\n\n                var params = {\n                    entity: $(this).data('entity'),\n                    keyword: $('#campo-de-busca').val()\n                };\n                var search_url = Mustache.render(url_template, params);\n                document.location = search_url;\n            }).on('keydown', function(event){\n\n                if(event.keyCode === 13 || event.keyCode === 32){\n                    event.preventDefault();\n                    $(this).click();\n                }else if(event.keyCode === 27){\n                    $(this).attr('css', '');\n                    $(this).blur();\n                    $('#campo-de-busca').focus();\n                    return false;\n                }else if(event.keyCode === 38){\n                    // up\n                    if($('#home-search-filter .submenu-dropdown li:focus').is($('#home-search-filter .submenu-dropdown li:first'))){\n                       $('#home-search-filter .submenu-dropdown li:last').focus();\n                    }else{\n                        $('#home-search-filter .submenu-dropdown li:focus').prev().focus();\n                    }\n                    event.preventDefault();\n\n                }else if(event.keyCode === 40){\n                    // down\n                    if($('#home-search-filter .submenu-dropdown li:focus').is($('#home-search-filter .submenu-dropdown li:last'))){\n                       $('#home-search-filter .submenu-dropdown li:first').focus();\n                    }else{\n                        $('#home-search-filter .submenu-dropdown li:focus').next().focus();\n                    }\n                    event.preventDefault();\n                }\n\n            });\n\n            $('#home-search-form').on('submit', function(){\n                $('.submenu-dropdown').css({display:'block',opacity:1});\n                $('.submenu-dropdown li:first').focus();\n                return false;\n            });\n            $('#home-search-form #campo-de-busca').on('blur', function(){\n                $('.submenu-dropdown').attr('style','');\n            });\n            $('#home-search-form #campo-de-busca').on('keydown', function(event){\n                var kc = event.keyCode;\n                if(event.keyCode === 9){\n                    $('.submenu-dropdown').css({display:'block',opacity:1});\n                }\n            });\n            var tabindex = 1;\n            $('.submenu-dropdown li').each(function(){\n                tabindex++;\n                $(this).attr('tabindex', tabindex);\n                $(this).on('focus', function(){\n                    $('.submenu-dropdown').css({display:'block',opacity:1});\n                });\n                $(this).on('blur', function(){\n                    $('.submenu-dropdown').attr('style','');\n                });\n            });\n        }\n        //Scroll da Home ////////////////////////////////////////////////////\n\n        $('#home-intro div.view-more a').click(function() {\n            $('nav#home-nav a.down').click();\n            return false;\n        });\n\n        if ($('.js-page-menu-item').length) {\n            var $items = $('.js-page-menu-item');\n\n            // encontra o próximo item para o scroll para baixo\n            var find_next_page_menu_item = function() {\n                var $next_page_item = null;\n\n                $items.each(function() {\n                    if ($(this).offset().top - $(window).scrollTop() > $('#main-header').outerHeight(true) + 50) {\n                        $next_page_item = $(this);\n                        return false;\n                    }\n                });\n\n                return $next_page_item;\n            };\n\n            // encontra o próximo item para o scroll para cima\n            var find_prev_page_menu_item = function() {\n                var $next_page_item = null;\n\n                $items.each(function() {\n                    if ($(this).offset().top - $(window).scrollTop() < 0) {\n                        $next_page_item = $(this);\n                    } else {\n                        return false;\n                    }\n                });\n\n                return $next_page_item;\n            };\n\n            // oculta a setinha de scroll se estiver no topo ou no final da página\n            var show_hide_scrolls = function(skip_animation) {\n                var speed = skip_animation ? 0 : 200;\n                find_prev_page_menu_item() ?\n                        $('nav#home-nav a.up').animate({opacity: 1}, speed) :\n                        $('nav#home-nav a.up').animate({opacity: 0}, speed);\n\n                if(find_next_page_menu_item()){\n                    $('nav#home-nav a.down').animate(speed);\n                    $('nav#home-nav a.down').fadeIn(speed);\n                } else {\n                    $('nav#home-nav a.down').fadeOut(speed);\n                }\n            };\n\n            var scroll_timeout = null;\n            $(window).scroll(function() {\n                clearTimeout(scroll_timeout);\n                scroll_timeout = setTimeout(show_hide_scrolls, 100);\n            });\n\n            $('nav#home-nav a.down').click(function() {\n                var __this = this;\n                var $next_page_item = find_next_page_menu_item();\n                var scrollto;\n\n                if ($next_page_item) {\n\n                    scrollto = $next_page_item.offset().top;// - $('#main-header').outerHeight(true);\n\n\n                    $('html, body').animate({scrollTop: Math.ceil(scrollto)}, 800, function() {\n                        nav_mouseenter.apply(__this, [true]);\n                    });\n                }\n                return false;\n            });\n\n\n            $('nav#home-nav a.up').click(function() {\n                var __this = this;\n                var $next_page_item = find_prev_page_menu_item();\n                var scrollto;\n\n                if ($next_page_item) {\n                    scrollto = $next_page_item.offset().top ; // - $('#main-header').outerHeight(true)  //retirar espaço superuor no scroll up \n\n\n                    $('html, body').animate({scrollTop: Math.ceil(scrollto)}, 800, function() {\n                        nav_mouseenter.apply(__this, [true]);\n                    });\n                } else {\n                    $('body').animate({scrollTop: 0}, 800, function() {\n                        nav_mouseenter.apply(__this, [true]);\n                    });\n                }\n                return false;\n            });\n\n            $('nav#home-nav a').not('.up').not('.down').click(function() {\n                var $target = $($(this).attr('href'));\n                scrollto = $target.offset().top - $('#main-header').outerHeight(true);\n                if (scrollto > $('body').scrollTop())\n                    scrollto += $('#main-header').outerHeight(true);\n                $('html, body').animate({scrollTop: Math.ceil(scrollto)});\n                return false;\n            });\n\n            // Copiado do Ski Brasil, essa parte aqui debaixo não sei se está sendo usada\n            var nav_mouseenter = function(skip_show) {\n\n                if ($(\"#page-menu\").is(':visible'))\n                    return;\n\n                var $page_item = $(this).hasClass('up') ? find_prev_page_menu_item() : find_next_page_menu_item();\n                if ($page_item) {\n                    if (skip_show !== true)\n                        $(this).find('.balao').show();\n\n                    $(this).find('.balao').find('.balao-text').html($page_item.data('menu-label'));\n\n                } else {\n                    $(this).find('.balao').hide().find('.balao-text').html('');\n                }\n\n            };\n\n            $('nav#home-nav a.up, nav#home-nav a.down').mouseenter(nav_mouseenter).mouseleave(function() {\n                $(this).find('.balao').hide().find('.balao-text').html('');\n            });\n        } else {\n            $('nav#home-nav').hide();\n        }\n\n\n        ////////// Menu da Home //////////\n\n        $('#home-nav ul span.nav-title').each(function() {\n            $(this).css('margin-left', ($(this).width() * -1) + 'px');\n            //$(this).css('margin-left', '40px');\n        })\n\n        $('#home-nav ul li a').hover(function() {\n            $(this).siblings('span.nav-title').animate({marginLeft: '40px'}, 'fast');\n        }, function() {\n            var $slider = $(this).siblings('span.nav-title');\n            $slider.animate({marginLeft: ($slider.width() * -1) + 'px'}, 'fast');\n        });\n\n    });\n\n    $(document).ready(function() {\n        hl.tip.init();\n    });\n\n    hl = {\n        /**\n         * modo de usar: <tag class=\".hltip\" title=\"Title: Content text\" >\n         */\n        tip: {\n            init: function() {\n\n                if(window.isTouchDevice) return false;\n\n                $(document.body).on('mouseenter click', \".hltip\", function(e) {\n                    var tip = $(this).data('tip');\n                    var $this = $(this);\n                    var _left = $(this).offset().left + $this.outerWidth(true) / 2 + $(document).scrollLeft();\n                    var _top = $(this).offset().top;\n                    var _height = $(this).height();\n\n                    //alterações para poder atualizar o hltip\n                    if (!tip || $(this).hasClass('hltip-auto-update')) {\n                        var content = $(this).attr('title') ? $(this).attr('title') : $(this).attr('hltitle');\n\n                        if (content.indexOf(':') > 0) {\n                            content = '<div class=\"hltip-title\">' + (content.substr(0, content.indexOf(':'))) + '</div>' + (content.substr(content.indexOf(':') + 1));\n                        }\n                        tip = $('<div class=\"hltip-box\"><div class=\"hltip-arrow-top\"></div><div class=\"hltip-text\">' + content + '</div><div class=\"hltip-arrow-bottom\"></div></div><').hide();\n                        tip.css({\n                            position: 'absolute',\n                            zIndex: 9999\n                        });\n                        $(document.body).append(tip);\n                        tip.css('width', tip.width());\n                        $(this).data('tip', tip);\n                        $(this).attr('hltitle', content);\n                        $(this).attr('title', '');\n                        if ($(this).data('hltip-classes'))\n                            tip.attr('class', $(this).data('hltip-classes') + ' hltip-box');\n                    }\n\n                    _left -= tip.width() / 2;\n\n                    if (_left + tip.width() - $(document).scrollLeft() > $(window).width() - 11)\n                        tip.css('left', $(window).width() - 11 - tip.width() + $(document).scrollLeft());\n                    else if (_left - $(document).scrollLeft() < 6)\n                        tip.css('left', $(document).scrollLeft() + 6);\n                    else\n                        tip.css('left', _left);\n\n                    var diff = $(this).offset().left + $this.outerWidth(true) / 2 + $(document).scrollLeft() - parseInt(tip.css('left'));\n\n                    if (diff < 1)\n                        diff = 1;\n                    else if (diff > parseInt(tip.outerWidth()) - 11)\n                        diff = parseInt(tip.outerWidth()) - 11;\n\n                    if ($(window).height() + $(document).scrollTop() - 11 < _top + _height + tip.height()) {\n                        tip.find('.hltip-arrow-top').hide();\n                        tip.find('.hltip-arrow-bottom').show();\n                        tip.css('top', _top - tip.height() - 6);\n\n                        tip.find('.hltip-arrow-bottom').css('margin-left', diff - tip.find('.hltip-arrow-bottom').outerWidth() / 2);\n                    } else {\n                        tip.find('.hltip-arrow-top').show();\n                        tip.find('.hltip-arrow-bottom').hide();\n                        tip.find('.hltip-arrow-top').css('margin-left', diff - tip.find('.hltip-arrow-top').outerWidth() / 2);\n                        tip.css('top', _top + _height + 6);\n                    }\n\n                    if (!tip.is(':visible')) {\n                        tip.fadeIn('fast');\n                    }\n                });\n\n                $(document.body).on('mouseleave mouseup', \".hltip\", function(e) {\n                    if ($(this).data('tip'))\n                        $(this).data('tip').fadeOut('fast');\n\n                });\n            }\n\n        }\n    };\n})(jQuery);\n","MapasCulturais = MapasCulturais || {};\n\n$(function(){\n//    $.fn.select2.defaults.separator = '; ';\n//    $.fn.editabletypes.select2.defaults.viewseparator = '; ';\n    MapasCulturais.TemplateManager.init();\n    MapasCulturais.Modal.initKeyboard('.js-dialog');\n    MapasCulturais.Modal.initDialogs('.js-dialog');\n    MapasCulturais.Modal.initButtons('.js-open-dialog');\n\n    MapasCulturais.EditBox.initBoxes('.js-editbox');\n    MapasCulturais.EditBox.initButtons('.js-open-editbox');\n\n\n    MapasCulturais.Video.setupVideoGallery('.js-videogallery');\n    MapasCulturais.Search.init(\".js-search\");\n\n    // bind alert close buttons\n    $('.alert .close').click(function(){\n        $(this).parent().slideUp('fast');\n    }).css('cursor', 'pointer');\n    \n    if(MapasCulturais.request.controller === 'app'){\n        MapasCulturais.App.init();\n    }\n\n    // dropdown\n\n    if(MapasCulturais.request.controller === 'project') {\n        var $els = $('#tab-inscricoes,#tab-inscritos').parent();\n        if(!MapasCulturais.entity.useRegistrations){\n            $els.hide();\n        }\n        $('#editable-use-registrations').on('hidden', function(e, reason) {\n            if($(this).editable('getValue', true) == '1'){\n                $els.fadeIn('fast');\n            }else{\n                $els.fadeOut('fast');\n            }\n        });\n    }\n\n    //main nav submenus toggle on click\n    $('body').on('click', '.js-submenu-toggle', function(){\n        var $self = $(this),\n            $target = eval($self.data('submenu-target'));\n        //hides by clicking outside\n        $('body').one('click', function(event){\n            if($self.find(event.target).length == 0){\n                $target.fadeOut(0);\n            }\n        });\n        $target.fadeToggle(100);\n    });\n\n    $('body').on('click', '.dropdown .placeholder', function(){\n        var $dropdown = $(this).parents('.dropdown'),\n            $submenu = $dropdown.find('.submenu-dropdown');\n\n        if($submenu.is(':visible')){\n            $submenu.hide();\n        }else{\n            $submenu.show();\n        }\n\n        if(!$dropdown.data('init')){\n            $dropdown.data('init', true);\n\n            if($dropdown.data('closeonclick')){\n                $submenu.click(function(){\n                    $submenu.hide();\n                });\n            }\n            //mouse leave disabled\n            // var $timeout;\n            // $submenu.on('mouseleave', function(){\n            //     $timeout = setTimeout(function(){\n            //         $submenu.hide();\n            //     }, 100);\n            // });\n            // $submenu.on('mouseenter', function(){\n            //     clearTimeout($timeout);\n            // });\n            // $dropdown.on('mouseenter', function(){\n            //     clearTimeout($timeout);\n            // });\n            $('body').on('click', function(event){\n                if($submenu.find(event.target).length == 0 && $dropdown.find(event.target).length == 0){\n                    $submenu.hide();\n                }\n            });\n        }\n    });\n\n     if($('#funcao-do-agente').length){\n        $('#funcao-do-agente .js-options li').click(function(){\n            var roleToRemove = $('#funcao-do-agente .js-selected span').data('role');\n            var roleToAdd = $(this).data('role');\n            var label = $(this).find('span').html();\n\n            var change = function(){\n                $('#funcao-do-agente .js-selected span').html(label);\n                $('#funcao-do-agente .js-selected span').data('role', roleToAdd);\n            };\n\n            if(roleToRemove)\n                $.post(MapasCulturais.baseURL + 'agent/removeRole/' + MapasCulturais.entity.id, {role: roleToRemove}, function(r){ if(r && !r.error) change(); });\n\n            if(roleToAdd)\n                $.post(MapasCulturais.baseURL + 'agent/addRole/' + MapasCulturais.entity.id, {role: roleToAdd}, function(r){ if(r && !r.error) change(); });\n\n\n        });\n    }\n\n    MapasCulturais.spinnerURL = MapasCulturais.assetURL + '/img/spinner.gif';\n\n\n    // identify Internet Explorer\n    if(navigator.appName != 'Microsoft Internet Explorer' && !(navigator.appName == 'Netscape' && navigator.userAgent.indexOf('Trident') !== -1)){\n        //not IE\n    }else{\n        // is IE\n        $('body').addClass('ie');\n        //identify version\n        var ua = navigator.userAgent.toLowerCase();\n        if(!isNaN(version = parseInt(ua.split('msie')[1]))){ // 7, 8, 9, 10\n            $('body').addClass('ie'+version);\n        }else if( parseInt(ua.split('rv:')[1]) === 11) { // 11\n            $('body').addClass('ie11');\n        }\n    }\n\n    if(MapasCulturais.entity){\n        MapasCulturais.entity.getTypeName = function(){\n            switch(MapasCulturais.request.controller){\n                case 'agent' : return 'agente'; break;\n                case 'space' : return 'espaço'; break;\n                case 'event' : return 'evento'; break;\n                case 'project' : return 'projeto'; break;\n            }\n        };\n    }\n\n});\n\nMapasCulturais.utils = {\n    getObjectProperties: function (obj) {\n        var keys = [];\n        for (var key in obj) {\n            keys.push(key);\n        }\n        return keys;\n    },\n    sortOjectProperties: function(obj){\n        var newObj = {};\n\n        this.getObjectProperties(obj).sort().forEach(function(e){\n            newObj[e] = obj[e];\n        });\n\n        return newObj;\n    },\n\n    isObjectEquals: function(obj1, obj2){\n//        console.log(JSON.stringify(this.sortOjectProperties(obj1)), JSON.stringify(this.sortOjectProperties(obj2)));\n        return JSON.stringify(this.sortOjectProperties(obj1)) === JSON.stringify(this.sortOjectProperties(obj2));\n    },\n\n    inArray: function(array, obj){\n        for(var i in array){\n            if(this.isObjectEquals(array[i], obj)){\n                return true;\n            }\n        }\n        return false;\n    },\n\n    arraySearch: function(array, obj){\n        for(var i in array){\n            if(this.isObjectEquals(array[i], obj)){\n                return i;\n            }\n        }\n        return false;\n    }\n};\n\nMapasCulturais.createUrl = function(controller_id, action_name, args){\n    var shortcuts = this.routes.shortcuts,\n        actions = this.routes.actions,\n        controllers = this.routes.controllers,\n\n        u = MapasCulturais.utils,\n        route = '';\n\n    action_name = action_name || this.routes.default_action_name;\n\n    if(args){\n        args = u.sortOjectProperties(args);\n    }\n\n    if(args && u.inArray(shortcuts, [controller_id, action_name, args])){\n        route = u.arraySearch(shortcuts, [controller_id, action_name, args]) + '/';\n        args = null;\n    }else if(u.inArray(shortcuts, [controller_id, action_name])){\n        route = u.arraySearch(shortcuts, [controller_id, action_name]) + '/';\n    }else{\n        if(u.inArray(controllers, controller_id)){\n            route = u.arraySearch(controllers, controller_id) + '/';\n        }else{\n            route = controller_id + '/';\n        }\n\n        if(action_name !== this.routes.default_action_name){\n            if(u.inArray(actions, action_name)){\n                route += u.arraySearch(actions, action_name) + '/';\n            }else{\n                route += action_name + '/';\n            }\n        }\n    }\n\n    if(args){\n        for(var key in args){\n            var val = args[key];\n            if(key == parseInt(key)){ // is integer\n                route += val + '/';\n            }else{\n                route += key + ':' + val + '/';\n            }\n        }\n    }\n\n    return MapasCulturais.baseURL + route;\n};\n\nMapasCulturais.auth = {\n    cb: null,\n    require: function(cb){\n        MapasCulturais.auth.cb = cb;\n            $('#require-authentication').attr('src',MapasCulturais.baseURL + 'panel/requireAuth').fadeIn();\n    },\n\n    finish: function(){\n        if(MapasCulturais.auth.cb){\n            MapasCulturais.auth.cb();\n        }\n\n        MapasCulturais.auth.cb = null;\n        $('#require-authentication').fadeOut();\n    }\n}\n\nMapasCulturais.TemplateManager = {\n    templates: {},\n    init: function(){\n        var $templates = $('.js-mustache-template');\n        var $this = this;\n        $templates.each(function(){\n            $this.templates[$(this).attr('id')] = $(this).text();\n            $(this).remove();\n        });\n    },\n\n    getTemplate: function(id){\n        if(this.templates[id])\n            return this.templates[id];\n        else\n            return null;\n    }\n};\n\nMapasCulturais.App = {\n    init: function(){\n        $('.js-select-on-click').on('click', function(){\n            var selector = $(this).data('selectTarget');\n            $(selector).trigger('doubleClick');\n        });\n        \n        if($('.js-input--app-key').length && $('.js-input--app-key--toggle').length){\n            $('.js-input--app-key--toggle').on('click', function(){\n                if($('.js-input--app-key').attr('type') === 'password'){\n                    $('.js-input--app-key').attr('type', 'text');\n                }else{\n                    $('.js-input--app-key').attr('type', 'password');\n                }\n                \n                return false;\n            });\n        }\n    }\n};\n\nMapasCulturais.defaultAvatarURL = MapasCulturais.assets.avatarAgent;\n\nfunction editableEntityAddHash(){\n    $('#editable-entity').find('.js-toggle-edit').each(function(){\n        var href = $(this).attr('href'),\n            cleanHref = href.indexOf('#') !== -1 ? href.split('#')[0] : href;\n        $(this).attr('href', cleanHref+location.hash);\n    });\n}\njQuery(document).ready(function(){\n    editableEntityAddHash();\n    $(window).on('hashchange', function(){\n        editableEntityAddHash();\n    });\n});\n\n\nMapasCulturais.Messages = {\n    delayToFadeOut: 5000,\n    fadeOutSpeed: 'slow',\n    showMessage: function(type, message) {\n        var $container = $('#editable-entity');\n        var $message = $('<div class=\"alert ' + type + '\">\"').html(message);\n        var $mainSection = $('#main-section');\n        var delayToFadeOut = this.delayToFadeOut;\n        $container.append($message);\n\n        if($container.hasClass('js-not-editable')){\n            $container.slideDown('fast');\n            $mainSection.animate({marginTop: parseInt($mainSection.css('margin-top')) + 42}, 'fast', function(){\n                $message.css('display', 'inline-block').css('display', 'inline-block').delay(delayToFadeOut).fadeOut(this.fadeOutSpeed, function() {\n                    $(this).remove();\n                    if($container.find('>').length === 0){\n                        $container.slideUp('fast');\n                        $mainSection.animate({marginTop: parseInt($mainSection.css('margin-top')) - 42}, 'fast');\n                    }\n                });\n            });\n        }else{\n            $message.css('display', 'inline-block').css('display', 'inline-block').delay(delayToFadeOut).fadeOut(this.fadeOutSpeed, function() {\n                $(this).remove();\n            });\n        }\n\n    },\n    success: function(message) {\n        this.showMessage('success', message);\n    },\n    error: function(message) {\n        this.showMessage('danger', message);\n    },\n    help: function(message) {\n        this.showMessage('info', message);\n    },\n    alert: function(message) {\n        this.showMessage('warning', message);\n    }\n\n}\n\nMapasCulturais.confirm = function (message, cb){\n    if(confirm(message))\n        cb();\n};\n\nMapasCulturais.Modal = {\n    time: 'fast',\n    initKeyboard: function (selector){\n        $(document.body).keyup(function (e){\n            if(e.keyCode == 27){\n                $(selector).each(function(){\n                   if($(this).is(':visible')) {\n                       $(this).find('.js-close').click();\n                   }\n                });\n            }\n        });\n    },\n\n    initDialogs: function(selector){\n        $(selector).each(function(){\n            $('body').append($(this));\n            if($(this).find('.js-dialog-disabled').length)\n                return;\n\n            if($(this).data('dialog-init'))\n                return;\n\n            var $dialog = $(this);\n            /*$dialog.hide();  Moved to style.css */\n\n            $dialog.data('dialog-init', 1);\n            $dialog.prepend('<h2>' + $(this).attr('title') + '</h2>');\n            $dialog.prepend('<a href=\"#\" class=\"js-close icon icon-close\"></a>');\n\n            // close button\n            $dialog.find('.js-close').click(function (){\n                MapasCulturais.Modal.close(selector);\n                return false;\n            });\n        });\n    },\n\n    initButtons: function(selector){\n\n        if($(selector).data('button-initialized')) return false;\n        else $(selector).data('button-initialized', true);\n        $(selector).each(function(){\n            var dialog_selector = $(this).data('dialog');\n            var $dialog = $(dialog_selector);\n            if($dialog.find('.js-dialog-disabled').length)\n                $(this).addClass('inactive').addClass('hltip').attr('title', $dialog.find('.js-dialog-disabled').data('message'));\n\n        });\n        $(selector).click(function(){\n            if($(this).hasClass('inactive'))\n                return false;\n\n            var dialog_selector = $(this).data('dialog');\n            MapasCulturais.Modal.open(dialog_selector);\n            if( $(this).data('dialog-callback') )\n                eval( $(this).data('dialog-callback'))($(this));\n            return false;\n        });\n    },\n\n    close: function(selector){\n        $('body').css('overflow','auto');\n        var $dialog = $(selector);\n        //alert('closing');\n        $dialog.find('.editable').editable('hide');\n        $dialog.hide();\n        return;\n    },\n\n    open: function(selector){\n        var $dialog = $(selector);\n\n        $dialog.find('div.alert.danger').html('').hide();\n        $dialog.find('.js-ajax-upload-progress').hide();\n        $dialog.css('opacity',0).show();\n        setTimeout(function(){\n           var top = $dialog.height() + 100 > $(window).height() ? $(window).scrollTop() + 100 : $(window).scrollTop() + ( $(window).height() - $dialog.height()) / 2 - 50;\n\n           $dialog.css({\n                top: top,\n                left: '50%',\n                marginLeft: -$dialog.width() / 2,\n                opacity: 1\n            });\n        },25);\n\n\n        return;\n    }\n};\n\n\nMapasCulturais.EditBox = {\n    time: 'fast',\n\n    setPosition: function($box, target){\n        if($box.hasClass('mc-left')){\n            $box.position({\n                my: 'right-10 center',\n                at: 'left center',\n                of: target\n            });\n\n        }else if($box.hasClass('mc-right')){\n            $box.position({\n                my: 'left+10 center',\n                at: 'right center',\n                of: target\n            });\n\n        }else if($box.hasClass('mc-top')){\n            $box.position({\n                my: 'center bottom-10',\n                at: 'center top',\n                of: target\n            });\n\n        }else if($box.hasClass('mc-bottom')){\n            $box.position({\n                my: 'center top+10',\n                at: 'center bottom',\n                of: target\n            });\n        }\n    },\n\n    initKeyboard: function (selector){\n        $(document.body).keyup(function (e){\n            if(e.keyCode == 27){\n                $(selector).each(function(){\n                   if($(this).is(':visible')) {\n                       $(this).find('.js-close').click();\n                   }\n                });\n            }\n        });\n    },\n\n    initBoxes: function(selector){\n\n        $(selector).each(function(){\n            var $dialog = $(this);\n\n            if($dialog.find('.js-dialog-disabled').length)\n                return;\n\n            if($dialog.data('dialog-init'))\n                return;\n\n            if($dialog.data('init'))\n                return;\n\n            $dialog.data('init', true);\n\n            /*$dialog.hide();  Moved to style.css */\n\n            $dialog.addClass('edit-box');\n\n            $dialog.data('dialog-init', 1);\n            if($dialog.attr('title')){\n                $dialog.prepend('<header><h1>' + $(this).attr('title') + '</h1></header>');\n            }\n            var submit_label = $dialog.data('submit-label') ? $dialog.data('submit-label') : 'Enviar';\n            var cancel_label = $dialog.data('cancel-label') ? $dialog.data('cancel-label') : 'Cancelar';\n\n            $dialog.append('<footer><button class=\"mc-cancel btn btn-default\">' + cancel_label + '</button> <button type=\"submit\" class=\"mc-submit\">' + submit_label + '</button> </footer><div class=\"mc-arrow\"></div>');\n\n            // close button\n            $dialog.find('.mc-cancel').click(function (){\n                MapasCulturais.EditBox.close($dialog);\n                return false;\n            });\n\n            // submit form\n            $dialog.find('footer button.mc-submit').click(function(){\n                $dialog.find('form').submit();\n            });\n        });\n    },\n\n    initButtons: function(selector){\n        $(selector).each(function(){\n            var $button = $(this);\n            var dialog_selector = $(this).data('target');\n            var $dialog = $(dialog_selector);\n            if($dialog.find('.js-dialog-disabled').length)\n                $(this).addClass('inactive').addClass('hltip').attr('title', $dialog.find('.js-dialog-disabled').data('message'));\n\n        });\n        $(selector).click(function(){\n            var $button = $(this);\n            if($button.hasClass('inactive'))\n                return false;\n\n            var dialog_selector = $button.data('target');\n\n            MapasCulturais.EditBox.open(dialog_selector, $button);\n\n            if($button.data('dialog-title'))\n                $(dialog_selector).find('header h1').html($button.data('dialog-title'));\n\n            if( $button.data('dialog-callback') )\n                eval( $button.data('dialog-callback'))($button);\n\n            return false;\n        });\n    },\n\n    close: function(selector){\n        $('body').css('overflow','auto');\n        var $dialog = $(selector);\n        //alert('closing');\n        $dialog.find('.editable').editable('hide');\n        $dialog.hide();\n        return;\n    },\n\n    open: function(selector, $button){\n        var $dialog = $(selector);\n        $dialog.find('div.alert.danger').html('').hide();\n\n        MapasCulturais.AjaxUploader.resetProgressBar(selector);\n\n        $dialog.show();\n        $dialog.find('input,textarea').not(':hidden').first().focus();\n        $dialog.css('opacity',0);\n        MapasCulturais.EditBox.setPosition($dialog, $button);\n        setTimeout(function(){\n            MapasCulturais.EditBox.setPosition($dialog, $button);\n            $dialog.css('opacity',1);\n        },25);\n\n        return;\n    }\n};\n\n\nMapasCulturais.Video = {\n    collection : {},\n    parseURL : function(url){\n        return purl(url);\n    },\n    isYoutube : function(parsedURL){\n            return parsedURL.attr('host').indexOf('youtube') != -1;\n    },\n    getYoutubeData : function(youtubeVideoID){\n        return {\n            thumbnalURL : 'http://img.youtube.com/vi/'+videoID+'/0.jpg',\n            playerURL : '//www.youtube.com/embed/'+videoID+'?html5=1'\n        }\n    },\n    getVideoBasicData : function(url){\n        var parsedURL = this.parseURL(url);\n        var host = parsedURL.attr('host');\n        var provider = '';\n        var videoID = '';\n        if(parsedURL.attr('host').indexOf('youtube') != -1 ){\n            provider = 'youtube';\n            videoID = parsedURL.param('v');\n        }else if(parsedURL.attr('host').indexOf('vimeo') != -1){\n            provider = 'vimeo';\n            videoID = parsedURL.attr('path').split('/')[1];\n        }\n        return {\n            'parsedURL' : parsedURL,\n            'provider' : provider,\n            'videoID' : videoID\n        }\n    },\n    setupVideoGallery : function(gallerySelector){\n\n        if($(gallerySelector).length == 0)\n            return false;\n\n        $( gallerySelector + ' .js-metalist-item-display').each(function(){\n            MapasCulturais.Video.getAndSetVideoData($(this).data('videolink'), $(this).parent(), MapasCulturais.Video.setupVideoGalleryItem);\n        });\n        var $firstItem = $( gallerySelector + ' .js-metalist-item-display:first').parent();\n        if(!$firstItem.length) {\n            $('#video-player').hide();\n            return false;\n        }\n        $('iframe#video_display').attr('src', $firstItem.data('player-url'));\n        $firstItem.addClass('active');\n    },\n    setupVideoGalleryItem : function(videoData, $element){\n        //$Element should be a.js-metalist-item-display\n        $element.attr('href', '#video');\n        $element.data('player-url', videoData.playerURL);\n        $element.find('img').attr('src', videoData.thumbnailURL);\n\n        var video_id = $element.attr('id');\n\n        $element.on('click', function(){\n            $('iframe#video_display').attr('src', videoData.playerURL);\n            $('iframe#video_display').data('open-video', $(this).attr('id'));\n            $(this).parent().find('.active').removeClass('active');\n            $(this).addClass('active');\n        });\n\n        var $container = $element.parent();\n        if($element.find('.js-remove-item').length){\n            $element.find('.js-remove-item').data('remove-callback', function(){\n                if($('iframe#video_display').data('open-video') == video_id)\n                    $('iframe#video_display').attr('src', '');\n\n                if($container.find('>li').length == 0)\n                    $('#video-player').hide();\n            });\n        }\n\n        if($container.find('>li').length == 1){\n            $element.addClass('active');\n            $('iframe#video_display').attr('src', videoData.playerURL);\n        }\n\n    },\n    setTitle : function(videoData, $element){\n        $element.val(videoData.videoTitle);\n    },\n    getAndSetVideoData : function (videoURL, $element, callback){\n        videoURL = videoURL.trim();\n        var videoData = {\n            parsedURL : purl(videoURL),\n            provider : '',\n            videoID : '',\n            thumbnailURL : '',\n            playerURL : '',\n            details : {}\n        };\n\n        if(videoData.parsedURL.attr('host').indexOf('youtube') != -1){\n            videoData.provider = 'youtube';\n            videoData.videoID = videoData.parsedURL.param('v');\n            videoData.thumbnailURL = 'http://img.youtube.com/vi/'+videoData.videoID+'/0.jpg';\n            videoData.playerURL = '//www.youtube.com/embed/'+videoData.videoID+'?html5=1';\n            callback(videoData, $element);\n            $.getJSON('https://gdata.youtube.com/feeds/api/videos/'+videoData.videoID+'?v=2&alt=json', function(data) {\n                videoData.details = data;\n                videoData.videoTitle = data.entry.title.$t;\n                MapasCulturais.Video.collection[videoURL] = videoData;\n                callback(videoData, $element);\n                return videoData;\n            });\n        }else if(videoData.parsedURL.attr('host').indexOf('vimeo') != -1){\n            videoData.provider = 'vimeo';\n            var tmpArray = videoData.parsedURL.attr('path').split('/');\n            videoData.videoID = tmpArray[tmpArray.length-1];\n            $.getJSON('http://www.vimeo.com/api/v2/video/'+videoData.videoID+'.json?callback=?', {format: \"json\"}, function(data) {\n                videoData.details = data[0];\n                videoData.thumbnailURL = data[0].thumbnail_small;\n                videoData.playerURL = '//player.vimeo.com/video/'+videoData.videoID+'';\n                videoData.videoTitle = data[0].title;\n                callback(videoData, $element);\n                MapasCulturais.Video.collection[videoURL] = videoData;\n                return videoData;\n            });\n        }else{\n            //no valid provider\n            videoData.thumbnailURL = 'http://www.bizreport.com/images/shutterstock/2013/04/onlinevideo_135877229-thumb-380xauto-2057.jpg';\n            callback(videoData, $element);\n            return videoData;\n        }\n\n        var withDetails = function(){\n            // get details from youtube api\n            if(!videoData.details) {\n                $.getJSON('https://gdata.youtube.com/feeds/api/videos/'+videoData.videoID+'?v=2&alt=json', {format: \"json\"}, function(data) {\n                    videoData.details = data;\n                    functionName(videoData, $element);\n                    return videoData;\n                });\n            }\n        };\n    }\n};\n\nMapasCulturais.Search = {\n    limit: 10,\n\n    init : function(selector){\n        if( $(selector).length === 0 || $(selector).hasClass('select2-offscreen')) return false;\n\n        $(selector).each(function(){\n            var $selector = $(this);\n\n            $selector.editable({\n                type:'select2',\n                name: $selector.data('field-name') ? $selector.data('field-name') : null,\n                select2:{\n//                    multiple: $selector.data('multiple'),\n//                    tokenSeparators: [\";\",\";\"],\n//                    separator:'; ',\n//                    viewseparator: '; ',\n                    width: $selector.data('search-box-width'),\n                    placeholder: $selector.data('search-box-placeholder'),\n                    minimumInputLength: 0,\n                    allowClear: $selector.data('allow-clear'),\n                    initSelection: function(e,cb){\n                        cb({id: $selector.data('value'), name: $selector.data('editable').$element.html()});\n                    },\n                    ajax: {\n                        url: function(){\n                            var format = $selector.data('selection-format');\n                            var apiMethod = 'find';\n                            if(MapasCulturais.Search.formats[format] && MapasCulturais.Search.formats[format].apiMethod)\n                                apiMethod =  MapasCulturais.Search.formats[format].apiMethod;\n                            return MapasCulturais.baseURL + 'api/' + $selector.data('entity-controller') + '/' + apiMethod;\n                        },\n                        dataType: 'json',\n                        quietMillis: 350,\n                        data: function (term, page) { // page is the one-based page number tracked by Select2\n                            var searchParams = MapasCulturais.Search.getEntityController(term, page, $selector);\n\n                            var format = $selector.data('selection-format');\n\n                            if(MapasCulturais.Search.formats[format] && MapasCulturais.Search.formats[format].ajaxData)\n                                searchParams = MapasCulturais.Search.formats[format].ajaxData(searchParams, $selector);\n                            else\n                                searchParams = MapasCulturais.Search.ajaxData(searchParams, $selector);\n\n                            return searchParams;\n                        },\n                        results: function (data, page) {\n                            var more = data.length == MapasCulturais.Search.limit;\n                            // notice we return the value of more so Select2 knows if more results can be loaded\n\n                            return {results: data, more: more};\n                        }\n                    },\n                    formatResult: function(entity){\n                        var format = $selector.data('selection-format');\n                        if(MapasCulturais.Search.formats[format] && MapasCulturais.Search.formats[format].result)\n                            return MapasCulturais.Search.formats[format].result(entity, $selector);\n                        else\n                            return MapasCulturais.Search.formatResult(entity, $selector);\n                    }, // omitted for brevity, see the source of this page\n\n                    formatSelection: function(entity){\n                        var format = $selector.data('selection-format');\n                        return MapasCulturais.Search.formats[format].selection(entity, $selector);\n                    }, // omitted for brevity, see the source of this page\n\n                    formatNoMatches: function(term){\n                        var format = $selector.data('selection-format');\n                        return MapasCulturais.Search.formats[format].noMatches(term, $selector);\n                    },\n                    escapeMarkup: function (m) { return m; }, // we do not want to escape markup since we are displaying html in results\n                }\n            });\n            if($selector.data('disable-buttons') ){\n                $selector.on('shown', function(e, editable) {\n                    var format = $selector.data('selection-format');\n\n                    /*Hide editable buttons because the option showbuttons:false autosubmitts the form adding two agents...\n                    Also Auto-open select2 on editable.shown and auto-close editable popup on select2-close*/\n\n                    e.stopPropagation();\n                    if (arguments.length == 2) {\n                        setTimeout(function() {\n                            editable.input.$input.parents('.control-group').addClass('editable-popup-botoes-escondidos');\n                        }, 0);\n                        setTimeout(function() {\n                            editable.input.$input.select2(\"open\");\n                        }, 200);\n                        editable.input.$input.on('select2-close', function(){\n                            setTimeout(function() {\n                                $selector.editable('hide');\n                            }, 200);\n                        });\n                    }\n                });\n            }\n            if($selector.data('auto-open') ){\n                $selector.on('shown', function(e, editable) {\n                    setTimeout(function() {\n                        editable.input.$input.select2(\"open\");\n                    }, 200);\n                });\n            }\n            var format = $selector.data('selection-format');\n            $selector.on('save',function(){\n                try{\n                    MapasCulturais.Search.formats[format].onSave($selector);\n                }catch(e){\n                    console.log(\"EXECEPTION: \", e.message);\n                }\n            });\n            $selector.on('hidden',function(){\n                try{\n                    MapasCulturais.Search.formats[format].onHidden($selector);\n                }catch(e){\n                    console.log(\"EXECEPTION: \", e.message);\n                }\n            });\n\n        });\n    },\n\n\n\n    getEntityController : function(term, page, $selector){\n\n        var entitiyControllers = {\n            'default':{\n                name: 'ilike(*'+term.replace(' ', '*')+'*)', //search term\n                '@select': 'id,name,terms,type',\n                '@limit': MapasCulturais.Search.limit, // page size\n                '@page': page,\n                '@order':'name ASC', // page number\n                '@files':'(avatar.avatarSmall):url'\n            },\n            'agent':{ //apenas adicionei a shortDescription\n                name: 'ilike(*'+term.replace(' ', '*')+'*)', //search term,\n                '@select': 'id,name,terms,type',\n                '@limit': MapasCulturais.Search.limit, // page size\n                '@page': page,\n                '@order':'name ASC', // page number\n                '@files':'(avatar.avatarSmall):url'\n            }\n        };\n\n        if(entitiyControllers[$selector.data('entity-controller')]){\n            return entitiyControllers[$selector.data('entity-controller')];\n        }else{\n            return entitiyControllers['default'];\n        }\n    },\n\n    processEntity: function(entity, $selector){\n        entity.areas = function(){\n            if(this.terms && this.terms.area)\n                return this.terms.area.join(', ');\n            else\n                return '';\n        };\n\n        entity.linguagens = function(){\n            if(this.terms && this.terms.linguagem)\n                return this.terms.linguagem.join(', ');\n            else\n                return '';\n        };\n\n        entity.tags = function(){\n            if(this.terms && this.terms.tags)\n                return this.terms.tags.join(', ');\n            else\n                return '';\n        };\n\n        entity.thumbnail = function(){\n            var entityDefaultAvatar = MapasCulturais.assets['avatar'+$selector.data('entity-controller')[0].toUpperCase() + $selector.data('entity-controller').slice(1)];\n            if(this['@files:avatar.avatarSmall'])\n                return this['@files:avatar.avatarSmall'].url;\n            else\n                return entityDefaultAvatar;\n        };\n\n    },\n\n    renderTemplate : function(template, entity, $selector){\n        this.processEntity(entity, $selector);\n        return Mustache.render(template, entity);\n    },\n\n    getEntityThumbnail : function (entity, thumbName){\n        if(!entity.files || entity.files.length == 0 || !entity.files[thumbName] || entity.files[thumbName].length == 0)\n            return '';\n        else{\n            if(entity.files[thumbName].files['avatarSmall'])\n                return entity.files[thumbName].files['avatarSmall'].url;\n        }\n    },\n\n    formatResult : function (entity, $selector) {\n        var searchResultTemplate = $($selector.data('search-result-template')).text();\n        return this.renderTemplate(searchResultTemplate, entity, $selector);\n    },\n\n    ajaxData: function(searchParams, $selector){\n        var excludedIds = MapasCulturais.request.controller === $selector.data('entity-controller') && MapasCulturais.entity.id ? [MapasCulturais.entity.id] : [];\n\n        if(excludedIds.length > 0)\n            searchParams.id = '!in(' + excludedIds.toString() + ')';\n\n        return searchParams;\n    },\n\n    formats: {\n        chooseProject:{\n            //apiMethod : 'findByUserApprovedRegistration',\n            onSave: function($selector){\n                var entity = $selector.data('entity');\n                $selector.data('value', entity.id);\n                $selector.data('value-name', entity.name);\n            },\n            selection: function(entity, $selector){\n                $selector.data('entity', entity);\n                return entity.name;\n            },\n\n            noMatches: function(term, $selector){\n                return 'Nenhum projeto encontrado.';\n            },\n\n            onClear: function($selector){\n            },\n\n            ajaxData: function(searchParams){\n                searchParams['@permissions'] = 'requestEventRelation';\n                return searchParams;\n            }\n        },\n\n        chooseSpace: {\n            onSave: function($selector){\n                var entity = $selector.data('entity'),\n                    avatarUrl = MapasCulturais.defaultAvatarURL,\n                    shortDescription = entity.shortDescription ? entity.shortDescription.replace(\"\\n\",'<br/>') : '';\n\n                $selector.data('value', entity.id);\n\n                try{\n                    avatarUrl = entity.files.avatar.files.avatarSmall.url;\n                }catch(e){};\n\n                $selector.parents('.js-space').find('.js-space-avatar').attr('src', avatarUrl);\n                $selector.parents('.js-space').find('.js-space-description').html(shortDescription);\n\n                $selector.parents('form').find('input[name=\"spaceId\"]').val(entity.id);\n            },\n            onHidden : function ($selector) {\n                $selector.removeClass('editable-unsaved');\n            },\n\n            selection: function(entity, $selector){\n                $selector.data('entity', entity);\n                return entity.name;\n            },\n\n            noMatches: function(term, $selector){\n                return 'Nenhum espaço encontrado.';\n            },\n\n            onClear: function($selector){ },\n\n            ajaxData: function(searchParams, $selector){\n\n                if($selector.data('value')){\n                    searchParams.id = '!in('+$selector.data('value')+')';\n                }\n\n                //if(!MapasCulturais.cookies.get('mapasculturais.adm'))\n                //    searchParams.owner = 'in(@me.spaces)';\n\n                searchParams['@select'] += ',shortDescription';\n//                searchParams['@permissions'] += '@control';\n                return searchParams;\n            }\n        },\n\n        createAgentRelation: {\n            selection: function (entity, $selector) {\n                var $selectionTarget =   $($selector.data('selection-target'));\n                var targetAction =      $selector.data('target-action');\n                var selectionTemplate = $($selector.data('selection-template')).text();\n\n                var groupname = $selector.parents('.js-related-group').find('.js-related-group-name').text();\n\n                $.post(\n                    MapasCulturais.baseURL + MapasCulturais.request.controller + '/createAgentRelation/id:' + MapasCulturais.entity.id,\n                    {agentId: entity.id, group:groupname, has_control: '0'}\n                );\n\n\n                if(targetAction == 'append'){\n                    MapasCulturais.RelatedAgents.addAgentToGroup(groupname, entity);\n                    return $selector.data('search-box-placeholder');\n                }else{\n                    $selectionTarget.html(markup);\n                    return entity.name;\n                }\n            },\n\n            noMatches: function (term, $selector){\n                var noResultTemplate = $($selector.data('no-result-template')).text();\n                $('#dialog-adicionar-integrante').data('group-element', $selector.parents('.js-related-group').find('.js-relatedAgentsContainer'));\n                //return term + ' HAHAHA!';\n                return noResultTemplate.replace('{{group}}', $selector.parents('.js-related-group').find('.js-related-group-name').text());\n            },\n\n            ajaxData: function(searchParams, $selector){\n                var group = $selector.parents('.js-related-group').find('.js-related-group-name').text();\n\n                var excludedIds = MapasCulturais.request.controller === 'agent' && MapasCulturais.entity.id? [MapasCulturais.entity.id] : [];\n                try{\n                    if(MapasCulturais.agentRelationGroupExludeIds[group])\n                        excludedIds = excludedIds.concat(MapasCulturais.agentRelationGroupExludeIds[group]);\n                }catch(e){}\n\n                excludedIds = excludedIds.concat (\n                    $selector.parents('.js-related-group').find('.agentes .avatar').map(\n                        function(){ return $(this).data('id'); }\n                ).toArray());\n\n\n                if ( excludedIds.length > 0)\n                    searchParams.id = '!in('+excludedIds.toString()+')';\n\n                return searchParams;\n            }\n        },\n\n        parentSpace:{\n            selection: function(entity, $selector){\n                return entity.name;\n            },\n\n            noMatches: function(term, $selector){\n                return 'Nenhum espaço encontrado.';\n            },\n\n            onClear: function($selector){\n            },\n\n            ajaxData: function(searchParams, $selector){\n                if(MapasCulturais.entity.id){\n                    var excludeIds = [MapasCulturais.entity.id].concat(MapasCulturais.entity.childrenIds);\n                    if(excludeIds){\n                        searchParams['id'] = '!IN(' + excludeIds + ')';\n                    }\n\n                }\n                return searchParams;\n            }\n        },\n\n        parentProject:{\n            selection: function(entity, $selector){\n                return entity.name;\n            },\n\n            noMatches: function(term, $selector){\n                return 'Nenhum projeto encontrado.';\n            },\n\n            onClear: function($selector){\n            },\n\n            ajaxData: function(searchParams, $selector){\n                if(MapasCulturais.entity.id){\n                    var excludeIds = [MapasCulturais.entity.id].concat(MapasCulturais.entity.childrenIds);\n                    if(excludeIds){\n                        searchParams['id'] = '!IN(' + excludeIds + ')';\n                    }\n\n                }\n\n                return searchParams;\n            }\n        },\n\n        projectRegistration: {\n            onSave: function($selector){\n                var entity = $selector.data('entity'),\n                    avatarUrl = MapasCulturais.defaultAvatarURL,\n                    shortDescription = entity.shortDescription.replace(\"\\n\",'<br/>');\n\n                $('#registration-agent-id').val(entity.id);\n\n            },\n\n            onHidden : function ($selector) {\n                $selector.removeClass('editable-unsaved');\n            },\n\n            selection: function(entity, $selector){\n                $selector.data('entity', entity);\n                return entity.name;\n            },\n\n            noMatches: function(term, $selector){\n                return 'Nenhum agente encontrado.';\n            },\n\n            onClear: function($selector){ },\n\n            ajaxData: function(searchParams, $selector){\n                var excludedIds = MapasCulturais.request.controller === 'agent' && MapasCulturais.entity.id? [MapasCulturais.entity.id] : [];\n\n                excludedIds.push($selector.data('value'));\n\n                if ( excludedIds.length > 0)\n                    searchParams.id = '!in('+excludedIds.toString()+')';\n\n                if(!MapasCulturais.cookies.get('mapasculturais.adm'))\n                    searchParams.user = 'eq(@me)';\n\n                if($selector.data('profiles-only'))\n                    searchParams.isUserProfile = 'eq(true)';\n\n                searchParams['@select'] += ',shortDescription,';\n                return searchParams;\n            }\n\n        },\n\n        changeOwner:{\n            onSave: function($selector){\n                var entity = $selector.data('entity'),\n                    avatarUrl = MapasCulturais.defaultAvatarURL,\n                    shortDescription = entity.shortDescription.replace(\"\\n\",'<br/>');\n\n                $selector.data('value', entity.id);\n\n                try{\n                    avatarUrl = entity.files.avatar.files.avatarSmall.url;\n                }catch(e){};\n\n                $selector.parents('.js-owner').find('.js-owner-avatar').attr('src', avatarUrl);\n                $selector.parents('.js-owner').find('.js-owner-description').html(shortDescription);\n\n            },\n\n            selection: function(entity, $selector){\n                $selector.data('entity', entity);\n                return entity.name;\n            },\n\n            noMatches: function(term, $selector){\n                return 'Nenhum agente encontrado.';\n            },\n\n            onClear: function($selector){ },\n\n            ajaxData: function(searchParams, $selector){\n                var excludedIds = [$selector.editable('getValue').ownerId];\n\n                if(MapasCulturais.request.controller === 'agent' && MapasCulturais.entity.id){\n                    excludedIds.push(MapasCulturais.entity.id);\n                    if(MapasCulturais.entity.childrenIds){\n                        excludedIds = excludedIds.concat(MapasCulturais.entity.childrenIds);\n                    }\n                }\n\n                if ( excludedIds.length > 0)\n                    searchParams.id = '!in('+excludedIds.toString()+')';\n\n                searchParams['@select'] += ',shortDescription';\n                searchParams['@permissions'] = '@control';\n                return searchParams;\n            }\n        }\n    }\n};\n\n\nMapasCulturais.cookies = {\n    get: function(name) {\n        var nameEQ = name + \"=\";\n        var ca = document.cookie.split(';');\n        for(var i=0;i < ca.length;i++) {\n            var c = ca[i];\n            while (c.charAt(0)==' ') c = c.substring(1,c.length);\n            if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length,c.length);\n        }\n        return null;\n    },\n\n    set: function(key, value, options){\n        options = $.extend({}, options);\n\n        if (value == null) {\n            options.expires = -1;\n        }\n\n        if (typeof options.expires === 'number') {\n            var days = options.expires, t = options.expires = new Date();\n            t.setDate(t.getDate() + days);\n            options.expires = options.expires.toUTCString();\n        }else{\n            options.expires = 'Session';\n        }\n\n        value = String(value);\n\n        return (document.cookie = [\n            encodeURIComponent(key), '=', options.raw ? value : encodeURIComponent(value),\n            options.expires ? '; expires=' + options.expires : '', // use expires attribute, max-age is not supported by IE\n            options.path    ? '; path=' + options.path : '',\n            options.domain  ? '; domain=' + options.domain : '',\n            options.secure  ? '; secure' : ''\n            ].join(''));\n    }\n};\n","//Inicia o mapa para a busca e configura o timeout do scroll\njQuery(document).ready(function() {\n\n    if ($('body').hasClass('action-search')) {\n        MapasCulturais.Map.initialize({mapSelector: '.js-map', locateMeControl: false, exportToGlobalScope: true, mapCenter: MapasCulturais.mapCenter});\n    }\n\n});\n\n\n(function(angular) {\n    var app = angular.module('ng-mapasculturais', []);\n    app.config([\"$httpProvider\", function($httpProvider) {\n\n            $httpProvider.responseInterceptors.push(['$q', '$rootScope', function($q, $rootScope) {\n\n                return function(promise) {\n                    $rootScope.$broadcast(\"event:startProgress\");\n                    return promise\n                        .then(\n                            function(response) {\n                                $rootScope.$broadcast(\"event:endProgress\");\n                                return response;\n                            },\n                            function(response) { //on error\n                                $rootScope.$broadcast(\"event:endProgress\");\n                                return $q.reject(response);\n                            }\n                        );\n\n                };\n            }]);\n        }]);\n})(angular);\n\n","(function(angular){\n    \"use strict\";\n\n    var module = angular.module('mc.module.notifications', []);\n\n    module.factory('NotificationService', ['$log','$http', '$q', '$rootScope', function($log, $http, $q, $rootScope){\n\n        var service = {};\n\n        service.url = MapasCulturais.baseURL + 'notification/';\n\n        service.get = function (){\n            var deferred = $q.defer();\n            $http.get(\n                MapasCulturais.baseURL+'api/notification/find/?&@select=id,status,isRequest,createTimestamp,message,approveUrl,request.permissionTo.approve,request.permissionTo.reject,request.requesterUser.id&user=eq(@me)&@ORDER=createTimestamp%20DESC'\n            ).success(function(data){\n                deferred.resolve(data);\n            }).error(function(){\n                deferred.reject('There was an error');\n            });\n            return deferred.promise;\n        };\n        service.updateOne = function(id, action){\n            var deferred = $q.defer();\n            $http.get(\n                service.url+action+'/'+id)\n            .success(function(data){\n                deferred.resolve(data);\n            }).error(function(){\n                deferred.reject('There was an error');\n            });\n            return deferred.promise;\n        };\n        return service;\n    }]);\n\n    module.controller('NotificationController', ['$log', '$sce', '$scope', '$rootScope', '$interval', 'NotificationService', function($log, $sce, $scope, $rootScope, $interval, NotificationService){\n\n        $scope.panelURI = MapasCulturais.baseURL+'panel';\n        $scope.MapasCulturais = MapasCulturais;\n\n        MapasCulturais.notifications.forEach(function(value,index){\n            MapasCulturais.notifications[index].message = $sce.trustAsHtml(value.message);\n        });\n        $scope.data = MapasCulturais.notifications;\n\n        var getNotifications = function (){\n            NotificationService.get().then(function(data){\n                if(data){\n                    data.forEach(function(value,index){\n                        data[index].message = $sce.trustAsHtml(value.message);\n                    });\n                    $scope.data = data;\n                }\n            });\n        };\n\n        $interval(function(){\n            getNotifications();\n        }, 60*1000);\n\n        $scope.approve = function(id){\n            NotificationService.updateOne(id,'approve').then(getNotifications);\n        };\n        $scope.reject = function(id){\n            NotificationService.updateOne(id,'reject').then(getNotifications);\n        };\n        $scope.delete = function(id){\n            NotificationService.updateOne(id,'delete').then(getNotifications);\n        };\n\n        $scope.adjustScroll = function(){\n            jQuery('.notifications .submenu ul').slimScroll({\n                position: 'right',\n                distance: '0px',\n                color: '#000',\n                height: '316px',\n                alwaysVisible: true,\n                railVisible: true\n            });\n        };\n    }]);\n\n    module.directive('onLastRepeat', function() {\n        return function(scope, element, attrs) {\n            if (scope.$last) { // all are rendered\n                scope.$evalAsync(attrs.onLastRepeat);\n            }\n        };\n    });\n\n    angular.element(document).ready(function(){\n        var app = null;\n        //checks existence of default search and Entity (singles') angular modules\n        ['search.app', 'entity.app'].forEach(function(moduleName){\n            if(!app){\n                try{\n                    app = angular.module(moduleName);\n                }catch(e){}\n            }\n        });\n        //can't find expected app\n        if(!app) {\n            var ctrl = document.querySelector('[ng-controller=NotificationController]');\n\n            // let's search again\n            if(ctrl && !angular.element(ctrl.parentElement).scope()) {\n                angular.bootstrap(ctrl.parentElement, ['mc.module.notifications']);\n            }\n        }\n        app = angular.module('mc.module.notifications');\n    });\n\n})(angular);\n\n\n","(function($){\n    MapasCulturais.Map = {};\n    L.Icon.Default.imagePath = MapasCulturais.assetURL + 'img/';\n\n    MapasCulturais.Map.initialize = function(initializerOptions) {\n\n        var config = MapasCulturais.mapsDefaults,\n            mapSelector = initializerOptions.mapSelector,\n            defaultIconOptions = {\n                shadowUrl: MapasCulturais.assets.pinShadow,\n                iconSize: [35, 43], // size of the icon\n                shadowSize: [40, 16], // size of the shadow\n                iconAnchor: [20, 30], // point of the icon which will correspond to marker's location\n                shadowAnchor: [6, 3], // the same for the shadow\n                popupAnchor: [-3, -76] // point from which the popup should open relative to the iconAnchor\n            },\n            iconTypeMapping = {\n                agent: MapasCulturais.assets.pinAgent,\n                coletivo: MapasCulturais.assets.pinAgent,\n                space: MapasCulturais.assets.pinSpace,\n                event: MapasCulturais.assets.pinEvent,\n                location: MapasCulturais.assets.pinMarker\n            };\n\n        MapasCulturais.Map.iconOptions = {};\n\n        for(var iconType in iconTypeMapping){\n            var opts = (JSON.parse(JSON.stringify(defaultIconOptions)));\n            opts.iconUrl = iconTypeMapping[iconType];\n            MapasCulturais.Map.iconOptions[iconType] = {\n                icon: L.icon(opts)\n            };\n        }\n\n        if(initializerOptions.exportToGlobalScope){\n            window.leaflet = {};\n            window.leaflet.iconOptions = MapasCulturais.Map.iconOptions;\n        }\n\n        $(mapSelector).each(function() {\n            if($(this).data('init')){\n                return;\n            }\n            $(this).data('init',true);\n            var id = $(this).attr('id');\n            var isEditable = initializerOptions.isMapEditable===false ? false : MapasCulturais.isEditable;\n            if (!isEditable)\n                $('#' + id + ':active').css({'cursor': 'default'});\n            var $dataTarget = $('#map-target');\n            var isPositionDefined = $(this).data('lat') ? true : false;\n            var defaultZoom = isPositionDefined ? config.zoomPrecise : config.zoomDefault;\n            var defaultLocateMaxZoom = config.zoomPrecise;\n            var defaultAproximatePrecisionZoom = config.zoomApproximate;\n            var defaultMaxCircleRadius = 1000;\n            var mapCenter = isPositionDefined ? new L.LatLng($(this).data('lat'), $(this).data('lng')) : new L.LatLng(config.latitude, config.longitude);\n            var options = $(this).data('options') ? $(this).data('options') : {dragging: true, zoomControl: true, doubleClickZoom: true, scrollWheelZoom: true};\n\n            var locateMeControl = initializerOptions.locateMeControl ? true : false;\n\n            if(initializerOptions.mapCenter){\n                options.center = new L.LatLng( initializerOptions.mapCenter.lat, initializerOptions.mapCenter.lng);\n            }else{\n                options.center = mapCenter;\n            }\n\n            options.zoom = defaultZoom;\n            options.zoomControl = false;\n            options.minZoom = config.zoomMin;\n            var openStreetMap = L.tileLayer('http://{s}.tile.osm.org/{z}/{x}/{y}.png', {\n                attribution: 'Dados e Imagens &copy; <a href=\"http://www.openstreetmap.org/copyright\">Contrib. OpenStreetMap</a>, ',\n                maxZoom: config.zoomMax\n            });\n\n            var map = new L.Map(id, options).addLayer(openStreetMap);\n            $(this).data('leaflet-map', map);\n            var timeout;\n            $(window).scroll(function() {\n                map.scrollWheelZoom.disable();\n                clearTimeout(timeout);\n                timeout = setTimeout(function() {\n                    if(!MapasCulturais.reenableScrollWheelZoom)\n                        map.scrollWheelZoom.enable();\n                }, 400);\n            });\n\n            var marker = new L.marker(map.getCenter(), {draggable: isEditable && MapasCulturais.request.controller !== 'event' });\n            var markerIcon = {};\n            if (MapasCulturais.request.controller == 'agent' || MapasCulturais.request.controller == 'space')\n                markerIcon = MapasCulturais.Map.iconOptions[MapasCulturais.request.controller].icon;\n            else if(MapasCulturais.request.controller == 'event')\n                markerIcon = MapasCulturais.Map.iconOptions['space'].icon;\n\n            if(Object.keys(markerIcon).length){\n                marker.setIcon(markerIcon);\n                map.addLayer(marker);\n            }\n\n            if (isPositionDefined) {\n                marker.setLatLng(mapCenter).addTo(map);\n            }\n\n            /* Events */\n            marker.on('move', function(e) {\n                if (isEditable) {\n                    $dataTarget.editable('setValue', [e.latlng.lng, e.latlng.lat]);\n                }\n            });\n\n            map.on('locationfound', function(e) {\n                var radius = e.accuracy / 2;\n                if (true || radius > defaultMaxCircleRadius)\n                    radius = defaultMaxCircleRadius;\n\n                marker.setLatLng(e.latlng);\n            });\n\n            map.on('locationerror', function(e) {\n                /** @TODO feedback pro usuario **/\n                // console.log(e.message);\n            });\n\n            map.on('click', function(e) {\n                if (isEditable && MapasCulturais.request.controller !== 'event')\n                    marker.setLatLng(e.latlng);\n            });\n\n            $('#locate-me').click(function() {\n                map.locate({setView: true, maxZoom: defaultLocateMaxZoom});\n            });\n\n            L.Polygon.prototype.getCenter = function() {\n                var pts = this._latlngs;\n                var off = pts[0];\n                var twicearea = 0;\n                var x = 0;\n                var y = 0;\n                var nPts = pts.length;\n                var p1, p2;\n                var f;\n                for (var i = 0, j = nPts - 1; i < nPts; j = i++) {\n                    p1 = pts[i];\n                    p2 = pts[j];\n                    f = (p1.lat - off.lat) * (p2.lng - off.lng) - (p2.lat - off.lat) * (p1.lng - off.lng);\n                    twicearea += f;\n                    x += (p1.lat + p2.lat - 2 * off.lat) * f;\n                    y += (p1.lng + p2.lng - 2 * off.lng) * f;\n                }\n                f = twicearea * 3;\n                return new L.LatLng(\n                    x / f + off.lat,\n                    y / f + off.lng\n                    );\n            };\n\n            // activate google service\n            var geocoder = null;\n            if(typeof google !== 'undefined')\n                geocoder =  new google.maps.Geocoder();\n\n            // callback to handle google geolocation result\n            function geocode_callback(results, status) {\n                if(typeof google === 'undefined'){\n                    return false;\n                }\n                if (status == google.maps.GeocoderStatus.OK) {\n                    var location = results[0].geometry.location;\n                    var foundLocation = new L.latLng(location.lat(), location.lng());\n                    map.setView(foundLocation, config.zoomPrecise);\n                    marker.setLatLng(foundLocation);\n                }\n            }\n\n            $('.js-editable').on('save', function(e, params) {\n                if ($(this).data('edit') == 'endereco') {\n                    $(this).trigger('changeAddress', params.newValue);\n                }\n            });\n\n            $('.js-editable[data-edit=\"endereco\"]').on('changeAddress', function(event, strAddress){\n                geocoder.geocode({'address': strAddress + ', Brasil'}, geocode_callback);\n            });\n\n            //Mais controles\n            if (isEditable) {\n                var locateMeControl = L.Control.extend({\n                    options: {\n                        position: 'topright'\n                    },\n                    onAdd: function(map) {\n                        var controlDiv = L.DomUtil.create('div', 'leaflet-control-command');\n                        L.DomEvent\n                            .addListener(controlDiv, 'click', L.DomEvent.stopPropagation)\n                            .addListener(controlDiv, 'click', L.DomEvent.preventDefault)\n                            .addListener(controlDiv, 'click', function() {\n                                map.locate({setView: true, maxZoom: defaultLocateMaxZoom});\n                            });\n\n                        var controlUI = L.DomUtil.create('div', 'leaflet-control-command-interior', controlDiv);\n                        controlUI.title = 'Localizar sua posição através do navegador';\n                        controlUI.innerHTML = '<span class=\"icon icon-show-map\"></span> Localize-me';\n                        return controlDiv;\n                    }\n                });\n\n                if (initializerOptions.locateMeControl)\n                    map.addControl(new locateMeControl({}));\n            }\n\n\n            var camadasBase = {};\n            camadasBase['OpenStreetMap'] = openStreetMap;\n\n            if(config.includeGoogleLayers && typeof google !== 'undefined') {\n                var googleSatelite = new L.Google();\n\n                var googleMapa = new L.Google();\n                googleMapa._type = 'ROADMAP';\n                googleMapa.options.maxZoom = 23;\n\n                var googleHibrido = new L.Google();\n                googleHibrido._type = 'HYBRID';\n\n                var googleRelevo = new L.Google();\n                googleRelevo._type = 'TERRAIN';\n                googleRelevo.options.maxZoom = 15;\n\n                /*Criação do Mapa*/\n                var camadasGoogle = {\n                    \"Google Satélite\": googleHibrido,\n                    \"Google Mapa\": googleMapa,\n                    \"Google Satélite Puro\": googleSatelite,\n                    \"Google Relevo\": googleRelevo\n                };\n\n                for ( var key in camadasGoogle) {\n                    camadasBase[key] = camadasGoogle[key];\n                };\n            }\n\n            var geoDivisions = new lvector.PRWSF({\n                url: MapasCulturais.vectorLayersURL,\n                geotable: '\"geo_division\"',\n                fields: \"id,name\",\n                //where: 'true',\n                geomFieldName: MapasCulturais.mapGeometryFieldQuery,\n                uniqueField: \"id\",\n                srid: 4326,\n                showAll: true,\n                mouseoverEvent: function(feature, event) {\n                    var labelText = feature.properties.name;\n                    var vector = event.target;\n                    vector.bindLabel('<b style=\"text-transform: capitalize;\">' + labelText.toLowerCase() + '</b>');\n                    map.showLabel(vector.label.setLatLng(vector.getCenter()));\n                },\n                singlePopup: true,\n                symbology: {\n                    type: \"single\",\n                    vectorOptions: {\n                        // @TODO: rename this class\n                        className : 'vetorial-sp'\n                    }\n                }\n            });\n\n            /*Controles*/\n            (new L.Control.FullScreen({position: 'bottomright', title: 'Tela Cheia'})).addTo(map);\n            (new L.Control.Zoom({position: 'bottomright'})).addTo(map);\n            var geoDivisionsObj = {};\n            for(var div_id in MapasCulturais.geoDivisionsHierarchy){\n                var div_label = MapasCulturais.geoDivisionsHierarchy[div_id];\n                geoDivisionsObj['<span class=\"js-geo-division\" data-type=\"' + div_id + '\">' + div_label + '</span>'] = {onAdd:function(map){return;}, onRemove:function(map){return;}};\n            };\n\n            var layersControl = new L.Control.Layers(camadasBase, geoDivisionsObj);\n\n            layersControl.addTo(map);\n            function setGeoChecboxes(type) {\n                $('.js-geo-division').each(function () {\n                    if ($(this).data('type') != type)\n                        $(this).parents('label').find('input:checkbox').prop('checked', false);\n                });\n            }\n\n            $('.js-geo-division').each(function(){\n                var $checkbox = $(this).parents('label').find('input:checkbox');\n                var type = $(this).data('type');\n\n                $checkbox.on('click', function(event){\n                    geoDivisions.setMap(null);\n\n                    if ($(this).prop('checked') === true) {\n                        setGeoChecboxes(type);\n\n                        geoDivisions.options.where = \"type='\" + type.toLowerCase() + \"'\";\n                        geoDivisions.options.geoDivisionType = type;\n                        geoDivisions.setMap(map);\n                    } else {\n                        geoDivisions.setMap(null);\n                    }\n                });\n            });\n\n            geoDivisions._makeJsonpRequest = function(url){\n                $('#resultados span[ng-if=\"!spinnerCount\"]').hide();\n                $('#resultados span[ng-show=\"spinnerCount > 0\"]').removeClass('ng-hide');\n                $.ajax({\n                    url: url,\n                    dataType: 'jsonp',\n                    //jsonpCallback: myCallback,\n                    cache: true,\n                    success: function(data) {\n                        geoDivisions._processFeatures(data);\n                        $('#resultados span[ng-if=\"!spinnerCount\"]').show();\n                        $('#resultados span[ng-show=\"spinnerCount > 0\"]').addClass('ng-hide');\n\n                        setGeoChecboxes(geoDivisions.options.geoDivisionType);\n                    }\n                });\n\n            };\n\n            if (initializerOptions.exportToGlobalScope) {\n                window.leaflet.map = map;\n                window.leaflet.marker = marker;\n            }\n        });\n\n        $('.js-leaflet-control').each(function(){\n            var $control = $(this);\n            $control.addClass('leaflet-control');\n            $('.leaflet-control-container').each(function(){\n                $(this).find($control.data('leaflet-target')).append($control);\n            });\n        });\n\n        $('.js-leaflet-control').on('click dblclick mousedown startdrag', function(e){\n            e.stopPropagation();\n        });\n    };\n\n    $(function(){\n\n        if($('body').hasClass('controller-agent')){\n            if(MapasCulturais.isEditable){\n                var publicLocation = $('[data-edit=\"publicLocation\"]').editable('getValue').publicLocation;\n                var empty = publicLocation === undefined;\n\n                if(!empty){\n                    MapasCulturais.Map.initialize({mapSelector: '.js-map', locateMeControl: false, exportToGlobalScope: true, mapCenter:MapasCulturais.mapCenter});\n                }else{\n                    $('.js-map').parent().hide();\n                }\n\n                $('[data-edit=\"publicLocation\"]').on('hidden', function(){\n                    var publicLocation = $(this).data('editable').value;\n                    var empty = publicLocation === 'null';\n                    if(!empty){\n                        $('.js-map-container').show();\n                        MapasCulturais.Map.initialize({mapSelector: '.js-map', locateMeControl: false, exportToGlobalScope: true, mapCenter:MapasCulturais.mapCenter});\n                    }else{\n                        $('#map-target').editable('setValue', [0, 0]);\n                        $('.js-map-container').hide();\n                    }\n\n                });\n            }else{\n                MapasCulturais.Map.initialize({mapSelector: '.js-map', locateMeControl: false, exportToGlobalScope: true, mapCenter:MapasCulturais.mapCenter});\n            }\n        }\n\n        if($('body').hasClass('controller-space') || $('body').hasClass('controller-event')){\n            MapasCulturais.Map.initialize({mapSelector: '.js-map', locateMeControl: false, exportToGlobalScope: true, mapCenter:MapasCulturais.mapCenter});\n        }\n\n        var timeout;\n        $(window).scroll(function() {\n            try{\n                leaflet.map.scrollWheelZoom.disable();\n                clearTimeout(timeout);\n                timeout = setTimeout(function() {\n                    leaflet.map.scrollWheelZoom.enable();\n                }, 400);\n            }catch(e){ }\n        });\n\n    });\n\n    // Fix Leaflet FUllScreen control that not allows keyboard inputs\n    (function(){\n        window.fullScreenApi.requestFullScreen = function(el) {\n\n            //Change the element to use <html> tag in Search\n            if(MapasCulturais.request.controller === 'site'){\n                el = document.querySelector('html');\n            }\n\n            //Add permission to allow keyboard input\n            return (this.prefix === '') ?\n                el.requestFullscreen(Element.ALLOW_KEYBOARD_INPUT)\n            :\n                el[this.prefix + 'RequestFullScreen'](Element.ALLOW_KEYBOARD_INPUT);\n\n            //Scroll the window to the bottom\n            //didn't work window.scrollTo(0,document.body.scrollHeight);\n        };\n    })();\n})(jQuery);\n","(function(angular) {\n    var app = angular.module('search.controller.spatial', ['ng-mapasculturais']);\n    app.controller('SearchSpatialController', ['$window', '$scope', '$location', \"$rootScope\", \"$timeout\", function($window, $scope, $location, $rootScope, $timeout) {\n\n        var map = null;\n\n        angular.element(document).ready(function() {\n            map = $window.leaflet.map;\n            if(!map) return;\n            map.invalidateSize();\n            var drawnItems = new L.FeatureGroup();\n            map.addLayer(drawnItems);\n            $window.leaflet.map.drawnItems = drawnItems;\n\n\n            if($scope.data.global.locationFilters.enabled){\n                var lf = $scope.data.global.locationFilters;\n                (new L.Circle(\n                    new L.LatLng(lf[lf.enabled].center.lat, lf[lf.enabled].center.lng),\n                    lf[lf.enabled].radius,\n                    {className : 'vetorial-padrao'}\n                ).addTo(map.drawnItems));\n\n                if($scope.data.global.locationFilters.enabled == 'address'){\n                    filterAddress ();\n                }\n            }\n\n\n            L.drawLocal.draw.handlers.circle.tooltip.start = 'Clique e arraste para desenhar o círculo';\n            L.drawLocal.draw.handlers.circle.tooltip.end = 'Solte o mouse para finalizar o desenho';\n            L.drawLocal.draw.toolbar.actions.title = 'Cancelar desenho';\n            L.drawLocal.draw.toolbar.actions.text = 'Cancelar';\n            L.drawLocal.draw.toolbar.buttons.circle = 'Desenhar um círculo';\n\n            L.Draw.Circle = L.Draw.Circle.extend({\n                _onMouseMove: function(e) {\n                    var latlng = e.latlng,\n                        showRadius = this.options.showRadius,\n                        useMetric = this.options.metric,\n                        radius;\n\n                    this._tooltip.updatePosition(latlng);\n                    if (this._isDrawing) {\n                        this._drawShape(latlng);\n\n                        // Get the new radius (rounded to 1 dp)\n                        radius = this._shape.getRadius().toFixed(1);\n\n                        this._tooltip.updateContent({\n                            text: L.drawLocal.draw.handlers.circle.tooltip.end,\n                            subtext: showRadius ? 'Raio: ' + L.GeometryUtil.readableDistance(radius, useMetric).replace('.',',') : ''\n                        });\n                    }\n                }\n            });\n\n            var drawControl = new L.Control.Draw({\n                draw: {\n                    position: 'topleft',\n                    polygon: false,\n                    rectangle: false,\n                    marker: false,\n                    polyline: false,\n                    circle: {\n                        shapeOptions: {\n                            className : 'vetorial-padrao'\n                        }\n                    }\n                },\n                edit: false,\n            });\n            map.addControl(drawControl);\n\n            map.on('draw:created', function(e) {\n                var type = e.layerType,\n                    layer = e.layer;\n\n                if (type === 'circle') {\n                    $scope.data.global.locationFilters = {\n                        enabled : 'circle',\n                        circle : {\n                            center : {\n                                lat: layer._latlng.lat,\n                                lng: layer._latlng.lng\n                            },\n                            radius: parseInt(layer._mRadius),\n                        }\n                    };\n                    $scope.$apply();\n                }\n\n\n                if (type === 'marker') {\n                    layer.bindPopup('A popup!');\n                }\n\n                if($window.leaflet.locationMarker) $window.leaflet.map.removeLayer($window.leaflet.locationMarker);\n                drawnItems.addLayer(layer);\n\n                //ESCONDE O CONTROLE PARA POSTERIORMENTE USAR O BOTÃO (NÃO CONSEGUI SETAR OS EVENTOS DO DRAW CIRCLE SEM ESTE CONTROLE\n                //document.querySelector('.leaflet-draw-draw-circle').style.display = 'none';\n\n            });\n\n\n            //ESCONDE O CONTROLE PARA POSTERIORMENTE USAR O BOTÃO (NÃO CONSEGUI SETAR OS EVENTOS DO DRAW CIRCLE SEM ESTE CONTROLE\n//            document.querySelector('.leaflet-draw-draw-circle').style.display = 'none';\n\n\n            map.on('locationfound', function(e) {\n                $window.$timout.cancel($window.dataTimeout);\n                var radius = e.accuracy / 2,\n                    neighborhoodRadius = $scope.defaultLocationRadius;\n\n                var marker = L.marker(e.latlng, $window.leaflet.iconOptions['location']).addTo(map)\n                    .bindPopup(\"Segundo seu navegador, você está aproximadamente neste ponto com margem de erro de \" + radius.toString().replace('.',',') + \" metros. Buscando resultados dentro de um raio de \" + neighborhoodRadius/1000 + \"KM deste ponto. <a onclick='document.querySelector(\\\".leaflet-draw-draw-circle\\\").click()'>Modificar</a>\")\n                    .openPopup();\n\n                var circle = L.circle(e.latlng, $scope.defaultLocationRadius, {className : 'vetorial-padrao'}).addTo(map.drawnItems);\n\n\n                $scope.data.global.locationFilters = {\n                    enabled : 'neighborhood',\n                    neighborhood : {\n                        center : {\n                            lat: map.getCenter().lat,\n                            lng: map.getCenter().lng\n                        },\n                        radius : $scope.defaultLocationRadius\n                    }\n                };\n                $scope.$apply();\n\n                if($window.leaflet.locationMarker) {\n                    $window.leaflet.map.removeLayer($window.leaflet.locationMarker);\n                    $window.leaflet.map.removeLayer($window.leaflet.locationCircle);\n                }\n                $window.leaflet.locationMarker = marker;\n                $window.leaflet.locationCircle = circle;\n\n            });\n\n            map.on('locationerror', function(e) {\n                /* @TODO alert de erro para o usuário */\n                //console.log(e.message);\n            });\n\n            //to fix address field not getting focus on touch screens\n            $('#endereco').on('click dblclick', function(){\n                var $self = $(this);\n                $self.focus();\n                $self.stopPropagation();\n                //loose focus on click outslide\n                $('body').one('click', function(event){\n                    if($self.parent().find(event.target).length == 0){\n                        $self.blur();\n                    }\n                });\n            });\n\n        });\n\n\n        $scope.filterNeighborhood = function (){\n            $window.leaflet.map.locate({setView : true, maxZoom:13});\n        };\n\n\n        var geocoder = null;\n        if(typeof google !== 'undefined')\n            geocoder =  new google.maps.Geocoder();\n\n        // callback to handle google geolocation result\n        function geocode_callback(results, status) {\n            if(typeof google === 'undefined'){\n                return false;\n            }\n            if (status == google.maps.GeocoderStatus.OK) {\n                var location = results[0].geometry.location;\n                var foundLocation = new L.latLng(location.lat(), location.lng());\n                map.setView(foundLocation, 15);\n                marker.setLatLng(foundLocation);\n            }\n        }\n\n        function filterAddress () {\n            var geocoder = null;\n            var addressString = $scope.data.global.locationFilters.address.text + ', Brasil';\n\n            if (!google){\n                return;\n            }else{\n                geocoder = new google.maps.Geocoder();\n            }\n            geocoder.geocode({'address': addressString}, function(results, status) {\n                if (status == google.maps.GeocoderStatus.OK) {\n                    $window.$timout.cancel($window.dataTimeout);\n                    var location = results[0].geometry.location;\n                    var foundLocation = new L.latLng(location.lat(), location.lng());\n\n                    $window.leaflet.map.setView(foundLocation, 13);\n\n                    if($window.leaflet.locationMarker) {\n                        $window.leaflet.map.removeLayer($window.leaflet.locationMarker);\n                        $window.leaflet.map.removeLayer($window.leaflet.locationCircle);\n                    }\n                    $window.leaflet.locationMarker = new L.marker(foundLocation, $window.leaflet.iconOptions['location']).addTo($window.leaflet.map);\n                    $window.leaflet.locationCircle = L.circle(foundLocation, $scope.defaultLocationRadius, {className : 'vetorial-padrao'})\n                            .addTo($window.leaflet.map.drawnItems);\n\n                    $scope.data.global.locationFilters = {\n                        enabled : 'address',\n                        address : {\n                            text : $scope.data.global.locationFilters.address.text,\n                            center : {\n                                lat: location.lat(),\n                                lng: location.lng()\n                            },\n                            radius : $scope.defaultLocationRadius\n                        }\n                    };\n                    $scope.$apply();\n\n                }\n            });\n        };\n\n        $scope.$watch('data.global.locationFilters.address.text', function(newValue, oldValue){\n            if(!newValue && !oldValue || newValue == oldValue){\n                return;\n            }\n            //if(newValue === '' || newValue === oldValue) return;\n            if(!newValue || !newValue.trim()) {\n                $scope.data.global.locationFilters.enabled = null;\n                if($rootScope.resultLayer.getBounds()._northEast)\n                    map.fitBounds($rootScope.resultLayer.getBounds());\n                return;\n            }\n            $timeout.cancel($scope.timer2);\n            $scope.timer2 = $timeout(function() {\n                filterAddress();\n            }, 1000);\n        });\n\n    }]);\n})(angular);\n","(function(angular) {\n    \"use strict\";\n\n    var app = angular.module('search.service.find', []);\n    app.factory('searchService', ['$http', '$rootScope', '$q', function($http, $rootScope, $q){\n        $rootScope.lastResult = $rootScope.lastResult || { agent:null, space:null, event:null };\n        var activeRequests = 0,\n            canceler = null,\n            lastEmitedResult = 'null',\n            lastEmitedCountResult = 'null',\n            lastQueries = {enabledEntities: null, space: null, agent: null, event: null, project: null, listedEntity: null, list:null, page: null};\n\n        $rootScope.spinnerCount = $rootScope.spinnerCount || 0;\n\n        $rootScope.$on('searchDataChange', search);\n        $rootScope.$on('resultPagination', search);\n\n        $rootScope.searchArgs = {\n            list: {},\n            map: {}\n        };\n\n        function search (ev, data){\n\n            var results = {},\n                numRequests = 0,\n                numSuccessRequests = 0,\n                numCountRequests = 0,\n                numCountSuccessRequests = 0,\n                countResults = {},\n                paginating = ev.name === 'resultPagination';\n\n\n            if(!paginating)\n                $rootScope.resetPagination();\n\n            if(data.global.viewMode === 'map'){\n                var compareEnabledEntities = angular.equals(lastQueries.enabledEntities, data.global.enabled);\n                if(data.global.enabled.agent){\n                    var agentQueryData = data2searchData(data.agent);\n                    if(!angular.equals(agentQueryData, lastQueries.agent) || !compareEnabledEntities){\n                        lastQueries.agent = angular.copy(agentQueryData);\n                        callApi('agent', agentQueryData);\n                    }else{\n                        results.agent = $rootScope.lastResult.agent;\n                    }\n                }\n\n                if(data.global.enabled.event){\n                    var eventQueryData = data2searchData(data.event);\n                    if(!angular.equals(eventQueryData, lastQueries.event) || !compareEnabledEntities){\n                        lastQueries.event = angular.copy(eventQueryData);\n                        callApi('event', eventQueryData);\n                    }else{\n                        results.event = $rootScope.lastResult.event;\n                    }\n                }\n\n                if(data.global.enabled.space){\n                    var spaceQueryData = data2searchData(data.space);\n                    if(!angular.equals(spaceQueryData, lastQueries.space) || !compareEnabledEntities){\n                        lastQueries.space = angular.copy(spaceQueryData);\n                        callApi('space', spaceQueryData);\n                    }else{\n                        results.space = $rootScope.lastResult.space;\n                    }\n                }\n\n                lastQueries.enabledEntities = angular.copy(data.global.enabled);\n            }else{\n                var activeEntity = data.global.filterEntity;\n                var listQueryData = data2searchData(data[activeEntity]);\n\n                if(activeEntity !== lastQueries.listedEntity)\n                    $rootScope.pagination[activeEntity] = 1;\n\n                var isDiff = (paginating && $rootScope.pagination[activeEntity] !== lastQueries.page) || (!angular.equals(listQueryData, lastQueries.list) || lastQueries.listedEntity !== activeEntity);\n\n                if( isDiff ){\n                    $rootScope.isPaginating = true;\n                    lastQueries.listedEntity = activeEntity;\n                    lastQueries.list = angular.copy(listQueryData);\n                    callApi(activeEntity, angular.copy(listQueryData));\n                }else{\n                    $rootScope.isPaginating = false;\n                }\n            }\n\n            endCountRequest();\n            endRequest();\n\n            function callApi(entity, sData){\n                var requestEntity = entity,\n                    requestAction = 'find';\n\n                if(entity === 'event'){\n                    if(data.global.viewMode === 'list'){\n                        requestAction = 'findByLocation';\n                    }else{\n                        requestEntity = 'space' ;\n                        requestAction = 'findByEvents';\n                    }\n\n                }\n                \n                $rootScope.searchArgs[data.global.viewMode][entity] = sData;\n\n\n                //Counting XX events in YY spaces (events in map mode)\n                if(requestEntity === 'space' && requestAction === 'findByEvents'){\n\n                   var otherRequestEntity = 'event';\n                   var otherRequestAction = 'findByLocation';\n\n                   numCountRequests++;\n                   activeRequests++;\n                   $rootScope.spinnerCount++;\n\n                   countResults['event'] = {};\n\n                   apiCount(otherRequestEntity, sData, otherRequestAction).success(function(rs){\n                       numCountSuccessRequests++;\n                       activeRequests--;\n                       $rootScope.spinnerCount--;\n\n                       countResults['event'].events = rs;\n                       endCountRequest();\n                   });\n\n                }\n\n                numRequests++;\n                activeRequests++;\n                $rootScope.spinnerCount++;\n                apiFind(requestEntity, sData, $rootScope.pagination[entity], requestAction).success(function(rs,status,header){\n                    var metadata = JSON.parse(header('API-Metadata'));\n                    numSuccessRequests++;\n                    activeRequests--;\n                    $rootScope.spinnerCount--;\n\n                    results[entity] = rs;\n\n                    endRequest();\n\n                    if(requestEntity === 'space' && requestAction === 'findByEvents')\n                        countResults[entity].spaces = metadata.count;\n                    else\n                        countResults[entity] = metadata.count;\n                    numCountSuccessRequests++;\n                    numCountRequests++;\n                    endCountRequest();\n                });\n\n            }\n\n            function countAndRemoveResultsNotInMap(entity, results){\n                results[entity].forEach(function(item, index) {\n                    if (!item.location || (item.location.latitude == 0 && item.location.longitude == 0)) {\n                        $rootScope.resultsNotInMap[entity]++;\n                    }\n                });\n            }\n\n            function endRequest(){\n                if(numRequests > 0 && numSuccessRequests === numRequests && lastEmitedResult !== JSON.stringify(results)){\n                    if(data.global.viewMode === 'map') {\n                        $rootScope.resultsNotInMap = {agent: 0, space: 0, event: 0};\n                        if(results.agent) {\n                            countAndRemoveResultsNotInMap('agent', results);\n                        }\n                        if(results.space) {\n                            countAndRemoveResultsNotInMap('space', results);\n                        }\n                        if(results.event) {\n                            countAndRemoveResultsNotInMap('event', results);\n                        }\n                    }\n\n                    lastEmitedResult = JSON.stringify(results);\n                    results.paginating = paginating;\n                    $rootScope.lastResult = results;\n                    $rootScope.$emit('searchResultsReady', results);\n                }\n            }\n\n            function endCountRequest(){\n                if(numCountRequests > 0 && numCountSuccessRequests === numCountRequests && lastEmitedCountResult !== JSON.stringify(countResults)){\n                    $rootScope.$emit('searchCountResultsReady', countResults);\n                }\n            }\n\n            function data2searchData(entityData){\n                var searchData = {};\n\n                if(entityData.keyword){\n\n                    searchData['@keyword'] = entityData.keyword.replace(/ /g,'%25');\n                }\n\n                if(entityData.areas && entityData.areas.length){\n                    var selectedAreas = entityData.areas.map(function(e){\n                        return MapasCulturais.taxonomyTerms.area[e];\n                    });\n                    selectedAreas = selectedAreas.map(function(e){ return e.replace(',','\\,'); });\n                    searchData['term:area'] = 'IN(' + selectedAreas  + ')';\n                }\n\n                if(entityData.linguagens && entityData.linguagens.length){\n                    var selectedLinguagens = entityData.linguagens.map(function(e){\n                        return MapasCulturais.taxonomyTerms.linguagem[e];\n                    });\n                    selectedLinguagens = selectedLinguagens.map(function(e){ return e.replace(',','\\\\,'); });\n\n                    searchData['term:linguagem'] = 'IN(' + selectedLinguagens + ')';\n                }\n\n                if(entityData.type){\n                    searchData.type = 'EQ(' + entityData.type + ')';\n                }\n\n                if(entityData.types && entityData.types.length){\n                    searchData.type = 'IN(' + entityData.types + ')';\n                }\n\n                if(entityData.classificacaoEtaria && entityData.classificacaoEtaria.length){\n                    var selectedClassificacoesEtarias = entityData.classificacaoEtaria.map(function(e){\n                        return MapasCulturais.classificacoesEtarias[e];\n                    });\n                    searchData.classificacaoEtaria = 'IN(' + selectedClassificacoesEtarias + ')';\n                }\n\n                if(entityData.acessibilidade){\n                    searchData.acessibilidade = 'EQ(Sim)';\n                }\n\n                if(entityData.isVerified){\n                    searchData.isVerified = 'EQ(true)';\n                }\n                if(data.global.locationFilters.enabled !== null){\n                    var type = data.global.locationFilters.enabled;\n                    var center = data.global.locationFilters[type].center;\n                    var radius = data.global.locationFilters[type].radius;\n                    searchData._geoLocation = 'GEONEAR(' + center.lng + ',' + center.lat + ',' + radius + ')';\n                }\n\n                if(entityData.from)\n                    searchData['@from'] = entityData.from;\n\n                if(entityData.to)\n                    searchData['@to'] = entityData.to;\n\n                // project registration is open?\n                if(entityData.ropen){\n                    var today = moment().format('YYYY-MM-DD');\n                    searchData.registrationFrom = 'LTE(' + today + ')';\n                    searchData.registrationTo   = 'GTE(' + today + ')';\n                }\n\n\n                return searchData;\n            }\n\n            function apiFind(entity, searchData, page, action) {\n                \n                \n                if(MapasCulturais.searchFilters && MapasCulturais.searchFilters[entity]){\n                    angular.extend(searchData, MapasCulturais.searchFilters[entity]);\n                    console.log(entity , searchData, MapasCulturais.searchFilters);\n                }\n                \n                var selectData = 'id,singleUrl,name,type,shortDescription,terms';\n                var apiExportURL = MapasCulturais.baseURL + 'api/';\n\n                if(entity === 'space'){\n                    if(action === 'find') {\n                        selectData += ',endereco,acessibilidade';\n                    }else{\n                        selectData += ',classificacaoEtaria,project.name,project.singleUrl,occurrences';\n                        apiExportURL += 'event/findByLocation/?';\n                    }\n                }else if (entity === 'project'){\n                    selectData += ',registrationFrom,registrationTo';\n                }else if(entity === 'event'){\n                    selectData += ',classificacaoEtaria,project.name,project.singleUrl,occurrences';\n                }\n\n                if(data.global.viewMode === 'list'){\n                    searchData['@select'] = selectData;\n                    searchData['@files'] = '(avatar.avatarMedium):url';\n                    if(page) {\n                        searchData['@page'] = page;\n                        searchData['@limit'] = '10';\n                    }\n                }else{\n                    searchData['@select'] = 'id,name,location';\n                }\n\n                action = action || 'find';\n                searchData['@order'] = 'name ASC';\n                delete searchData['@count'];\n\n                var querystring = '';\n                var queryString_apiExport = '@select='+selectData;\n\n                //removes type column from event export\n                if(apiExportURL.indexOf('event/findByLocation') !== -1)\n                    queryString_apiExport = queryString_apiExport.replace(',type','');\n                else\n                    apiExportURL += entity + '/' + action + '/?';\n\n                for(var att in searchData) {\n                    querystring += \"&\"+att+\"=\"+searchData[att];\n                    if(att != '@select' && att!='@page' && att!='@limit')\n                        queryString_apiExport += \"&\"+att+\"=\"+searchData[att];\n                }\n                $rootScope.apiURL = apiExportURL+queryString_apiExport;\n\n                return $http({method: 'GET', cache:true, url:MapasCulturais.baseURL + 'api/' + entity + '/' + action + '/?'+querystring , data:searchData});\n            }\n\n            function apiCount(entity, searchData, action) {\n\n                action = action || 'find';\n                var querystring = \"\";\n\n                for(var att in searchData) {\n                    querystring += \"&\"+att+\"=\"+searchData[att];\n                }\n                return $http({method: 'GET', cache:true, url: MapasCulturais.baseURL + 'api/'+entity+'/' + action + '/?@count=1&'+querystring, data:searchData});\n            }\n        }\n\n        return 'done';\n    }]);\n\n})(angular);\n\n\n\n\n","(function(angular) {\n    \"use strict\";\n\n    var app = angular.module('search.service.findOne', []);\n    app.factory('FindOneService', ['$http', '$rootScope', function($http, $rootScope){\n        return function(data){\n\n            if(data.global.viewMode === 'list') return;\n            var select = 'id,singleUrl,name,subTitle,type,shortDescription,terms,project.name,project.singleUrl',\n                requestAction = 'findOne',\n                page=null,\n                result = {},\n                sData = {},\n                entity,\n                numRequests = 1;\n\n            $rootScope.spinnerCount++;\n\n            entity = data.global.openEntity.type;\n            sData.id = 'EQ(' + data.global.openEntity.id + ')';\n\n\n\n            if(entity === 'event'){\n                result[entity] = {\n                    space: {},\n                    events: {}\n                };\n\n                if (data.global.enabled.event){\n                    $rootScope.spinnerCount++;\n                    numRequests++;\n\n                    select += ',endereco';\n                    apiFindOne('space', select, sData, page, requestAction).success(function(rs){\n                        result[entity].space = rs;\n                        endRequest();\n                    });\n                    apiSpaceEvents(data.global.openEntity.id, $rootScope.searchArgs.map.event).success(function(rs){\n                        result[entity].events = rs;\n                        endRequest();\n                    });;\n                }else{\n                    endRequest();\n                }\n            }else{\n                apiFindOne(entity, select, sData, page, requestAction).success(function(rs){\n                    result[entity] = rs;\n                    endRequest();\n                });\n            }\n\n            function endRequest(){\n                numRequests--;\n                $rootScope.spinnerCount--;\n                if(numRequests === 0){\n                    $rootScope.$emit('findOneResultReady', result);\n                }\n            }\n\n            function apiFindOne(entity, select, searchData, page, action) {\n                action = action || 'find';\n                if(entity === 'space')\n                    select += ',endereco,acessibilidade';\n                searchData['@select'] = select;\n                searchData['@files'] = '(avatar.avatarSmall):url';\n                var querystring = \"\";\n                for(var att in searchData) {\n                    querystring += \"&\"+att+\"=\"+searchData[att];\n                }\n                return $http({method: 'GET', url: MapasCulturais.baseURL + 'api/' + entity + '/' + action + '/?'+querystring, data:searchData});\n            }\n\n            function apiSpaceEvents(spaceId, searchData) {\n                var action = 'findBySpace';\n                searchData['spaceId'] = spaceId;\n                searchData['@select'] = select + ',classificacaoEtaria';\n                searchData['@files'] = '(avatar.avatarSmall):url';\n                var querystring = \"\";\n                for(var att in searchData) {\n                    querystring += \"&\"+att+\"=\"+searchData[att];\n                }\n                return $http({method: 'GET', url: MapasCulturais.baseURL + 'api/' + entity + '/' + action + '/?'+querystring, data:searchData});\n            }\n        };\n    }]);\n})(angular);\n\n\n\n\n","\n(function(angular) {\n    var app = angular.module('search.controller.map', ['ng-mapasculturais', 'search.service.findOne']);\n    app.controller('SearchMapController', ['$window', '$scope', '$rootScope', 'FindOneService', function($window, $scope, $rootScope, FindOneService) {\n        $scope.init = function (){\n\n            if($scope.data.global.map && $scope.data.global.map.zoom){\n                MapasCulturais.mapCenter = $scope.data.global.map.center;\n            }else{\n                MapasCulturais.mapCenter = null;\n            }\n\n            $scope.map = null;\n            $scope.resultLayer = null;\n            $scope.markers = [];\n\n            angular.element(document).ready(function(){\n                $scope.map = $window.leaflet.map;\n                $scope.map.removeLayer($window.leaflet.marker);\n\n                $scope.map.on('load', function(){\n                    $scope.setMapView();\n                });\n\n                $scope.map.on('drag zoomstart', function(){\n                    $window.$timout.cancel($window.dataTimeout);\n                });\n\n                $scope.map.on('zoomend moveend', function(){\n                    if($scope.data.global.viewMode === 'list')\n                        return;\n                    $scope.data.global.map = {\n                        center : $window.leaflet.map.getCenter(),\n                        zoom : $window.leaflet.map.getZoom()\n                    };\n                    $scope.$apply();\n                });\n\n                $scope.updateMap();\n                $scope.setMapView();\n\n            });\n\n            $rootScope.$on('searchCountResultsReady', function(ev, results){\n                //remove drawing if more than one\n                if($window.leaflet.map.drawnItems){\n                    if(!$scope.data.global.locationFilters.enabled)  {\n                        $window.leaflet.map.drawnItems.clearLayers();\n                        if($window.leaflet.locationMarker) { $window.leaflet.map.removeLayer($window.leaflet.locationMarker);}\n                    }else if(Object.keys($window.leaflet.map.drawnItems._layers).length > 1) {\n                        var lastLayer = $scope.map.drawnItems.getLayers().pop();\n                        $window.leaflet.map.drawnItems.clearLayers();\n                        $window.leaflet.map.drawnItems.addLayer(lastLayer);\n                    }\n                }\n            });\n\n            $rootScope.$on('searchResultsReady', function(ev, results){\n                if($scope.data.global.viewMode === 'list') return;\n                delete $scope.markers;\n                $scope.markers = [];\n                if(results.agent) $scope.createMarkers('agent', results.agent);\n                if(results.event) $scope.createMarkers('event', results.event);\n                if(results.space) $scope.createMarkers('space', results.space);\n\n                $scope.updateMap();\n\n                if($scope.data.global.openEntity && $scope.data.global.openEntity.id){\n                    FindOneService($scope.data);\n                }\n            });\n\n            $rootScope.$on('searchDataChange', function(ev, data){\n                if(!$scope.map) return;\n                $scope.map.invalidateSize();\n                $scope.setMapView();\n            });\n\n        };\n\n        $scope.setMapView = function(){\n            if($scope.map && $scope.data.global.map && $scope.data.global.map.zoom) {\n                $scope.map.setZoom($scope.data.global.map.zoom);\n                $scope.map.panTo($scope.data.global.map.center);\n            }\n        };\n\n        $scope.createMarkers = function(entity, results) {\n            results.forEach(function(item) {\n                var marker;\n\n                if (!item.location || (item.location.latitude == 0 && item.location.longitude == 0)) {\n                    return;\n                }\n\n                marker = new L.marker(\n                    new L.LatLng(item.location.latitude, item.location.longitude),\n                    $window.leaflet.iconOptions[entity]\n                ).bindLabel(\n                    entity === 'event' ?\n                        '<center>Eventos encontrados no espaço <br> <strong>'+item.name+'</strong></center>'\n                        : item.name\n                ).on('click', function() {\n\n                    var infobox = document.querySelector('#infobox');\n                    var infoboxContent = infobox.querySelector('article');\n\n                    $scope.data.global.openEntity = {\n                        id: item.id,\n                        type: entity\n                    };\n\n                    $scope.openEntity = {};\n                    $scope.openEntity[entity] = {name: item.name};\n\n                    $scope.$parent.collapsedFilters = true;\n\n                    $scope.$apply();\n\n                    FindOneService($scope.data);\n                });\n\n\n                marker.entityType = entity;\n                $scope.markers.push(marker);\n\n\n            });\n        };\n\n        $scope.updateMap = function(){\n            if($scope.resultLayer){\n                $scope.resultLayer.clearLayers();\n            }\n            $scope.resultLayer = new L.markerClusterGroup({\n                spiderfyOnMaxZoom: true,\n                showCoverageOnHover: false,\n                zoomToBoundsOnClick: false,\n                spiderfyDistanceMultiplier: MapasCulturais.mapSpiderfyDistanceMultiplier,\n                maxClusterRadius: MapasCulturais.mapMaxClusterRadius,\n                iconCreateFunction: function (cluster) {\n                    var iconClass = 'leaflet-cluster',\n                        markers = getChildMarkers(cluster),\n                        hasAgent = false,\n                        hasEvent = false,\n                        hasSpace = false;\n\n                    function getChildMarkers(cluster){\n                        var markers = cluster._markers.slice();\n                        cluster._childClusters.forEach(function(child_cluster){\n                            markers = markers.concat(getChildMarkers(child_cluster));\n                        });\n                        return markers;\n                    };\n\n                    for(var i in markers){\n                        if(markers[i].entityType === 'agent') hasAgent = true;\n                        if(markers[i].entityType === 'event') hasEvent = true;\n                        if(markers[i].entityType === 'space') hasSpace = true;\n                        if(hasAgent && hasEvent && hasSpace) break;\n                    }\n\n                    if(hasAgent) iconClass += ' cluster-agent';\n                    if(hasEvent) iconClass += ' cluster-event';\n                    if(hasSpace) iconClass += ' cluster-space';\n\n                    return L.divIcon({ html: cluster.getChildCount(), className: iconClass, iconSize: L.point(40, 40) });\n                }\n            });\n\n            $scope.resultLayer.addLayers($scope.markers);\n\n\n            var __c = 0;\n            var _addLayer = $scope.resultLayer._addLayer;\n\n            $scope.resultLayer._addLayer = function(layer, zoom){\n                var r = _addLayer.apply(this,[layer, zoom]);\n\n                var p = layer.__parent;\n\n                while(p){\n                    p.hasEntityType = p.hasEntityType || {};\n                    p.hasEntityType[layer.entityType] = true;\n                    p = p.__parent;\n                }\n\n                return r;\n            };\n\n            angular.element(document).ready(function(){\n                $scope.resultLayer.addTo($scope.map);\n                $rootScope.resultLayer = $scope.resultLayer;\n            });\n\n            $scope.resultLayer.on('clusterclick', function (a) {\n                if(a.layer._childCount <= MapasCulturais.mapMaxClusterElements)\n                    a.layer.spiderfy();\n                else{\n                    a.layer.zoomToBounds();\n                }\n            });\n        };\n        $scope.init();\n\n    }]);\n\n})(angular);\n","(function(angular){\n    \"use strict\";\n\n    window.apply = null;\n\n    var timeoutTime = 300;\n\n    var defaultLocationRadius = 2000;\n\n    var skeletonData = {\n        global: {\n            isVerified: false,\n            isCombined: false,\n            viewMode: 'map',\n            filterEntity: null,\n            openEntity: {\n                id: null,\n                type: null\n            },\n            locationFilters: {\n                enabled: null, // circle, address, neighborhood\n                circle: {\n                    center: {\n                        lat: null,\n                        lng: null\n                    },\n                    radius: null\n                },\n                neighborhood: {\n                    center: {\n                        lat: null,\n                        lng: null\n                    },\n                    radius: defaultLocationRadius\n                },\n                address: {\n                    text: '',\n                    center: {\n                        lat: null,\n                        lng: null\n                    },\n                    radius: defaultLocationRadius\n                }\n            },\n            map: {\n                zoom: null,\n                center: {\n                    lat: null,\n                    lng: null\n                }\n            },\n\n            enabled: {\n                agent: false,\n                space: false,\n                event: false\n            }\n        },\n        agent: {\n            keyword: '',\n            areas: [],\n            type: null,\n            isVerified: false\n        },\n        space: {\n            keyword: '',\n            areas: [],\n            types: [],\n            acessibilidade: false,\n            isVerified: false\n        },\n        event: {\n            keyword: '',\n            linguagens: [],\n            from: moment().format('YYYY-MM-DD'),\n            to: moment().add(1, 'month').format('YYYY-MM-DD'),\n            classificacaoEtaria: [],\n            isVerified: false\n        },\n        project: {\n            keyword: '',\n            linguagens: [],\n            types: [],\n            isVerified: false,\n            // registration open\n            ropen: false\n        }\n    };\n\n    var diffFilter = function (input) {\n        return _diffFilter(input, skeletonData);\n    };\n\n    var isEmpty = function (value) {\n        if(typeof value === 'undefined' ||\n           value === null) return true;\n\n        if(angular.isObject(value)) {\n            if(angular.equals(value, {}) ||\n               angular.equals(value, []))\n                return true;\n        }\n\n        return false;\n    };\n\n    var _diffFilter = function (input, skeleton) {\n        // returns the difference from the input structure and skeleton\n        // don't include nulls\n\n        if(typeof input === 'undefined' || typeof skeleton === 'undefined' || input === skeleton) return;\n\n        if(!angular.isObject(input)|| angular.isArray(skeleton)) {\n            return input;\n        }\n\n        var output = {};\n\n        angular.forEach(input, function(value, key){\n            var currVal = _diffFilter(value, skeleton[key]);\n\n            if(isEmpty(currVal)) return;\n            this[key] = currVal;\n        }, output);\n\n        return output;\n    };\n\n    var deepExtend = function (skeleton, extension) {\n        angular.forEach(extension, function(value, key){\n            if(angular.isObject(value) && !angular.isArray(value)) {\n                deepExtend(skeleton[key], value);\n                delete extension[key];\n            }\n        });\n        angular.extend(skeleton, extension);\n        return skeleton;\n    };\n\n    var app = angular.module('search.app', [\n        'ng-mapasculturais', \n        'rison', \n        'infinite-scroll', \n        'ui.date', \n        'search.service.find', \n        'search.service.findOne', \n        'search.controller.map', \n        'search.controller.spatial',\n        'mc.module.notifications']);\n\n    app.controller('SearchController', ['$scope', '$rootScope', '$location', '$log', '$rison', '$window', '$timeout', 'searchService', 'FindOneService', function($scope, $rootScope, $location, $log, $rison, $window, $timeout, searchService, FindOneService){\n        $scope.defaultLocationRadius = defaultLocationRadius;\n\n        $rootScope.resetPagination = function(){\n            $rootScope.pagination = {\n                agent: 1,\n                space: 1,\n                event: 1,\n                project: 1\n            };\n        }\n        $rootScope.resetPagination();\n\n        $scope.assetsUrl = MapasCulturais.assets;\n\n        $scope.getName = function(valores, id){\n            return valores.filter(function(e){if(e.id === id) return true;})[0].name;\n        };\n\n        $scope.getId = function(valores, name){\n            return valores.filter(function(e){if(e.name === name) return true;})[0].id;\n        };\n\n        $scope.isSelected = function(array, id){\n            return (array.indexOf(id) !== -1);\n        };\n\n        $scope.toggleSelection = function(array, id){\n            var index = array.indexOf(id);\n            if(index !== -1){\n                array.splice(index, 1);\n            } else {\n                array.push(id);\n            }\n        };\n\n        $scope.toggleVerified = function (entity) {\n                $scope.data[entity].isVerified = !$scope.data[entity].isVerified;\n        };\n\n        $scope.showInfobox = function (){\n            return $scope.collapsedFilters && $scope.data.global.openEntity.id>0 && $scope.data.global.viewMode==='map' && $scope.data.global.enabled[$scope.data.global.openEntity.type];\n        };\n        $scope.showFilters = function(entity){\n            if($scope.data.global.viewMode === 'map')\n                return $scope.data.global.enabled[entity];\n            else\n                return $scope.data.global.filterEntity === entity;\n        }\n\n        $scope.hasFilter = function() {\n            var ctx = {has: false};\n            angular.forEach($scope.data, function(value, key) {\n                if(key === 'global') return;\n                this.has = this.has || !angular.equals(_diffFilter($scope.data[key], skeletonData[key]), {});\n            }, ctx);\n\n            return ctx.has ||\n                   $scope.data.global.isVerified ||\n                   $scope.data.global.locationFilters.enabled !== null;\n        };\n\n        $scope.cleanAllFilters = function () {\n            angular.forEach($scope.data, function(value, key) {\n                if(key === 'global') return;\n                $scope.data[key] = angular.copy(skeletonData[key]);\n            });\n            $scope.data.global.isVerified = false;\n            $scope.data.global.locationFilters = angular.copy(skeletonData.global.locationFilters);\n        };\n\n        $scope.cleanLocationFilters = function() {\n            $scope.data.global.locationFilters = angular.copy(skeletonData.global.locationFilters);\n        };\n\n        $scope.tabClick = function(entity){\n            var g = $scope.data.global;\n            g.filterEntity = entity;\n            if(entity === 'project')\n                g.viewMode = 'list';\n\n            if(g.viewMode === 'map'){\n                var n = 0;\n                for(var e in g.enabled)\n                    if(g.enabled[e])\n                        n++;\n\n                if(n===0 || n === 1 && !g.enabled[entity]){\n                    for(var e in g.enabled)\n                        if(e === entity)\n                            g.enabled[e] = true;\n                        else\n                            g.enabled[e] = false;\n                }else if(n > 1 && !g.enabled[entity]){\n                    g.enabled[entity] = true;\n                }\n            }\n        };\n\n        $scope.parseHash = function(){\n            var newValue = $location.hash();\n            if(newValue === '') {\n                $scope.tabClick('agent');\n                return;\n            }\n\n            if(newValue !== $rison.stringify(diffFilter($scope.data))){\n                $scope.data = deepExtend(angular.copy(skeletonData), $rison.parse(newValue));\n                $timeout.cancel($scope.timer);\n                $scope.timer = $timeout(function() {\n                    $rootScope.$emit('searchDataChange', $scope.data);\n                },timeoutTime);\n            }\n        };\n\n        $scope.dataChange = function(newValue, oldValue){\n            if(newValue === undefined) return;\n            if(newValue.global.viewMode === 'map'){\n                var filterEntity = newValue.global.filterEntity;\n                if(!newValue.global.enabled[filterEntity]){\n                    var enabledEntities = 0;\n\n                    angular.forEach(newValue.global.enabled, function(v,k){ if(v) enabledEntities++; });\n\n                    if(enabledEntities === 1){\n                        var obj = {space:false, agent:false, event:false};\n                        obj[filterEntity] = true;\n                        newValue.global.enabled = obj;\n                    }else{\n                        newValue.global.enabled[filterEntity] = true;\n                    }\n                    return;\n                }\n            }\n            var serialized = $rison.stringify(diffFilter(newValue));\n            $window.$timout = $timeout;\n            if($location.hash() !== serialized){\n                $timeout.cancel($scope.timer);\n                if(oldValue && !angular.equals(oldValue.global.enabled, newValue.global.enabled)) {\n                    $location.hash(serialized);\n                    $scope.timer = $timeout(function() {\n                        $rootScope.$emit('searchDataChange', $scope.data);\n                    },timeoutTime);\n                } else {\n                    $scope.timer = $timeout(function() {\n                        $location.hash(serialized);\n                        $rootScope.$emit('searchDataChange', $scope.data);\n                    }, timeoutTime);\n                    $window.dataTimeout = $scope.timer;\n                }\n            }\n            $window.scrollTo(0, $window.scrollY+1);\n            $window.scrollTo(0, $window.scrollY-1);\n        };\n\n        $scope.data = angular.copy(skeletonData);\n\n        $scope.areas = MapasCulturais.taxonomyTerms.area.map(function(el, i){ return {id: i, name: el}; });\n        $scope.linguagens = MapasCulturais.taxonomyTerms.linguagem.map(function(el, i){ return {id: i, name: el}; });\n        $scope.classificacoes = MapasCulturais.classificacoesEtarias.map(function(el, i){ return {id: i, name: el}; });\n\n        MapasCulturais.entityTypes.agent.unshift({id:null, name: 'Todos'});\n        $scope.types = MapasCulturais.entityTypes;\n        $scope.location = $location;\n\n        $rootScope.$on('$locationChangeSuccess', $scope.parseHash);\n\n        if($location.hash() === '') {\n            $scope.tabClick('agent');\n        } else {\n            $scope.parseHash();\n        }\n\n        $scope.$watch('data', $scope.dataChange, true);\n\n        $scope.agents = [];\n        $scope.spaces = [];\n        $scope.events = [];\n        $scope.projects = [];\n\n\n        $rootScope.$on('searchResultsReady', function(ev, results){\n            if($scope.data.global.viewMode !== 'list')\n                return;\n\n            $rootScope.isPaginating = false;\n\n            if(results.paginating){\n                $scope.agents = $scope.agents.concat(results.agent ? results.agent : []);\n                $scope.events = $scope.events.concat(results.event ? results.event : []);\n                $scope.spaces = $scope.spaces.concat(results.space ? results.space : []);\n                $scope.projects = $scope.projects.concat(results.project ? results.project : []);\n            }else{\n                $scope.agents = results.agent ? results.agent : [];\n                $scope.events = results.event ? results.event : [];\n                $scope.spaces = results.space ? results.space : [];\n                $scope.projects = results.project ? results.project : [];\n            }\n        });\n\n        var infiniteScrollTimeout = null;\n\n        $scope.addMore = function(entity){\n            if($scope.data.global.viewMode !== 'list')\n                return;\n\n            if(entity !== $scope.data.global.filterEntity)\n                return;\n\n            if($rootScope.isPaginating)\n                return;\n\n            if($scope[entity + 's'].length === 0 || $scope[entity + 's'].length < 10)\n                return;\n\n            $rootScope.pagination[entity]++;\n            // para não chamar 2 vezes o search quando está carregando a primeira página (o filtro mudou)\n            if($rootScope.pagination[entity] > 1)\n                $rootScope.$emit('resultPagination', $scope.data);\n        };\n\n        $scope.numResults = function (num, entity){\n            if($scope.data.global.viewMode === 'map' && $scope.resultsNotInMap && $scope.resultsNotInMap[entity]){\n                return num - $scope.resultsNotInMap[entity];\n            }else{\n                return num;\n            }\n        }\n\n        $scope.numAgents = 0;\n        $scope.numSpaces = 0;\n        $scope.numEvents = {\n            events: 0,\n            spaces: 0\n        };\n        $scope.numEventsInList = 0;\n        $scope.numProjects = 0;\n\n        $rootScope.$on('searchCountResultsReady', function(ev, results){\n            $scope.numAgents = parseInt(results.agent);\n            $scope.numSpaces = parseInt(results.space);\n\n            if($scope.data.global.viewMode === 'list'){\n                $scope.numEventsInList = results.event;\n            }else{\n                if(results.event){\n                    $scope.numEvents = {\n                        events: parseInt(results.event.events),\n                        spaces: parseInt(results.event.spaces)\n                    };\n                }else{\n                    $scope.numEvents = {\n                        events: 0,\n                        spaces: 0\n                    };\n                };\n            }\n            $scope.numProjects = parseInt(results.project);\n        });\n\n        $rootScope.$on('findOneResultReady', function(ev, result){\n            $scope.openEntity = result;\n        });\n\n        var formatDate = function(date){\n            return moment(date).format('DD/MM/YYYY');\n        };\n\n        $scope.dateOptions = {\n            dateFormat: 'dd/mm/yy'\n        };\n\n        $scope.$watch('data.event.from', function(){\n            if(new Date($scope.data.event.from) > new Date($scope.data.event.to))\n                $scope.data.event.to = $scope.data.event.from;\n        });\n\n        $scope.$watch('data.event.to', function(newValue, oldValue){\n            if(new Date($scope.data.event.to) < new Date($scope.data.event.from))\n                $scope.data.event.from = $scope.data.event.to;\n        });\n\n\n       $scope.showEventDateFilter = function(){\n            var from = $scope.data.event.from,\n                to = $scope.data.event.to;\n\n            return from !== skeletonData.event.from || to !== skeletonData.event.to;\n        };\n\n        $scope.eventDateFilter = function(){\n            var from = $scope.data.event.from,\n                to = $scope.data.event.to;\n\n            if(from === to)\n                return formatDate(from);\n            else\n                return 'de ' + formatDate(from) + ' a ' + formatDate(to);\n        };\n\n        $scope.cleanEventDateFilters = function(){\n            $scope.data.event.from = skeletonData.event.from;\n            $scope.data.event.to = skeletonData.event.to;\n        }\n\n        $scope.readableProjectRegistrationDates = function(project){\n            if(!project.registrationFrom)\n                return false;\n\n            var from = moment(project.registrationFrom.date).format('DD/MM/YYYY');\n            var to = moment(project.registrationTo.date).format('DD/MM/YYYY');\n\n            return from !== to ? 'de ' + from + ' a ' + to : from;\n        };\n\n        $scope.collapsedFilters = true;\n        $scope.toggleAdvancedFilters = function(){\n            $scope.collapsedFilters = !$scope.collapsedFilters;\n            setTimeout(function(){\n                window.adjustHeader();\n            }, 10);\n        };\n\n    }]);\n})(angular);"]}