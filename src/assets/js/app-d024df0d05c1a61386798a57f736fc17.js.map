{"version":3,"sources":["application/themes/BaseV1/assets/js/tim.js","application/themes/BaseV1/assets/js/mapasculturais.js","application/themes/BaseV1/assets/js/ng-mapasculturais.js","application/themes/BaseV1/assets/js/ng.mc.module.notifications.js"],"names":["$","document","unbind","MapasCulturais","mode","i","s","o","g","r","a","m","q","push","arguments","l","Date","createElement","getElementsByTagName","async","src","parentNode","insertBefore","window","ga","ready","deviceAgent","navigator","userAgent","toLowerCase","isTouchDevice","documentElement","match","addClass","remove","body","hasClass","magnificPopup","delegate","type","closeMarkup","gallery","enabled","arrowMarkup","tPrev","tNext","tCounter","adjustHeader","$mapa","$editableEntity","$busca","buscaTop","headerDosResultadosHeight","scrollTop","this","diffScrollTop","lastScrollTop","newHeaderTop","parseInt","$mainHeader","css","length","parent","is","append","find","appendTo","outerHeight","headerHeight","data","height","leaflet","map","invalidateSize","removeClass","position","top","stop","fadeIn","fadeOut","scroll","resize","each","$active","$content","$links","filter","location","hash","attr","not","hide","replace","on","e","show","preventDefault","toString","click","slimScroll","distance","color","alwaysVisible","railVisible","maxHeight","parents","$input","setTimeout","select","focus","event","stopPropagation","target","url_template","params","entity","keyword","val","search_url","Mustache","render","keyCode","blur","prev","next","display","opacity","kc","tabindex","$items","find_next_page_menu_item","$next_page_item","offset","find_prev_page_menu_item","show_hide_scrolls","skip_animation","speed","animate","scroll_timeout","clearTimeout","__this","scrollto","Math","ceil","nav_mouseenter","apply","$target","skip_show","$page_item","html","mouseenter","mouseleave","width","hover","siblings","marginLeft","$slider","hl","tip","init","$this","_left","left","outerWidth","scrollLeft","_top","_height","content","indexOf","substr","zIndex","diff","jQuery","TemplateManager","Modal","initKeyboard","initDialogs","initButtons","EditBox","initBoxes","Video","setupVideoGallery","Search","slideUp","request","controller","App","$els","useRegistrations","reason","editable","$self","eval","one","fadeToggle","$dropdown","$submenu","roleToRemove","roleToAdd","label","change","post","baseURL","id","role","error","spinnerURL","assetURL","appName","ua","isNaN","version","split","getTypeName","utils","getObjectProperties","obj","keys","key","sortOjectProperties","newObj","sort","forEach","isObjectEquals","obj1","obj2","JSON","stringify","inArray","array","arraySearch","createUrl","controller_id","action_name","args","shortcuts","routes","actions","controllers","u","route","default_action_name","auth","cb","require","finish","templates","$templates","text","getTemplate","selector","trigger","defaultAvatarURL","assets","avatarAgent","editableEntityAddHash","href","cleanHref","Messages","delayToFadeOut","fadeOutSpeed","showMessage","message","$container","$message","$mainSection","slideDown","marginTop","delay","success","help","alert","confirm","time","keyup","$dialog","prepend","close","dialog_selector","open","setPosition","$box","my","at","of","submit_label","cancel_label","submit","$button","AjaxUploader","resetProgressBar","first","collection","parseURL","url","purl","isYoutube","parsedURL","getYoutubeData","youtubeVideoID","thumbnalURL","videoID","playerURL","getVideoBasicData","host","provider","param","gallerySelector","getAndSetVideoData","setupVideoGalleryItem","$firstItem","videoData","$element","thumbnailURL","video_id","setTitle","videoTitle","videoURL","callback","trim","details","getJSON","entry","title","$t","tmpArray","format","thumbnail_small","withDetails","functionName","limit","$selector","name","select2","placeholder","minimumInputLength","allowClear","initSelection","ajax","apiMethod","formats","dataType","quietMillis","term","page","searchParams","getEntityController","ajaxData","results","more","formatResult","result","formatSelection","selection","formatNoMatches","noMatches","escapeMarkup","input","onSave","console","log","onHidden","entitiyControllers","default","@select","@limit","@page","@order","@files","agent","processEntity","areas","terms","area","join","linguagens","linguagem","tags","thumbnail","entityDefaultAvatar","toUpperCase","slice","renderTemplate","template","getEntityThumbnail","thumbName","files","searchResultTemplate","excludedIds","chooseProject","onClear","chooseSpace","avatarUrl","shortDescription","avatar","avatarSmall","createAgentRelation","$selectionTarget","targetAction","selectionTemplate","groupname","agentId","group","has_control","RelatedAgents","addAgentToGroup","markup","noResultTemplate","agentRelationGroupExludeIds","concat","toArray","parentSpace","excludeIds","childrenIds","parentProject","projectRegistration","cookies","get","user","isUserProfile","changeOwner","ownerId","nameEQ","ca","cookie","c","charAt","substring","set","value","options","extend","expires","days","t","setDate","getDate","toUTCString","String","encodeURIComponent","raw","path","domain","secure","Map","initialize","mapSelector","locateMeControl","exportToGlobalScope","mapCenter","angular","app","module","config","$httpProvider","responseInterceptors","$q","$rootScope","promise","$broadcast","then","response","reject","factory","$log","$http","service","deferred","defer","resolve","updateOne","action","$sce","$scope","$interval","NotificationService","panelURI","notifications","index","trustAsHtml","getNotifications","approve","delete","adjustScroll","directive","scope","element","attrs","$last","$evalAsync","onLastRepeat","moduleName","ctrl","querySelector","parentElement","bootstrap"],"mappings":"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","file":"/vagrant/src/assets/js/app-d024df0d05c1a61386798a57f736fc17.js","sourcesContent":["(function($) {\n    // to prevent jQuery bug\n    $(document).unbind('DOMNodeInserted.mask');\n\n    // Analytics\n    if(MapasCulturais.mode !== 'development'){\n        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){\n        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),\n        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)\n        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');\n\n        ga('create', 'UA-53455459-1', 'auto');\n        ga('send', 'pageview');\n    }\n\n\n    $(document).ready(function() {\n\n        var deviceAgent = navigator.userAgent.toLowerCase();\n\n        var isTouchDevice = 'ontouchstart' in document.documentElement ||\n        (deviceAgent.match(/(iphone|ipod|ipad)/) ||\n        deviceAgent.match(/(android)/)  ||\n        deviceAgent.match(/(iemobile)/) ||\n        deviceAgent.match(/iphone/i) ||\n        deviceAgent.match(/ipad/i) ||\n        deviceAgent.match(/ipod/i) ||\n        deviceAgent.match(/blackberry/i) ||\n        deviceAgent.match(/bada/i));\n\n        window.isTouchDevice = isTouchDevice;\n        $('body').addClass('touch-device');\n\n        if(MapasCulturais.mode !== 'development')\n            $('.staging-hidden').remove();\n\n        // posição do header\n        // var lastScrollTop = 0;\n\n        // var $mainHeader = $('#main-header');\n        // var headerHeight = $mainHeader.outerHeight(true);\n\n        // var header_animation_status = 0;\n\n        // if ($('#editable-entity').length && $('#editable-entity').is(':visible')) {\n        //     $('#main-section').css('margin-top', headerHeight + $('#editable-entity').outerHeight(true));\n        // }\n\n        // inicializa a galeria\n        if ($(document.body).hasClass('action-single') && $(document.body).hasClass('entity')) {\n            $('.js-gallery').magnificPopup({\n                delegate: 'a', // child items selector, by clicking on it popup will open\n                type: 'image',\n                closeMarkup: '<span class=\"mfp-close icon icon-close\"></span>',\n                gallery:{\n                    enabled:true,\n\n                    arrowMarkup: '<button title=\"%title%\" type=\"button\" class=\"mfp-arrow mfp-arrow-%dir%\"><span class=\"icon icon-arrow-%dir% mfp-prevent-close\"></span></button>', // markup of an arrow button\n                    tPrev: 'Anterior', // title for left button\n                    tNext: 'Próxima', // title for right button\n                    tCounter: '%curr% de %total%' // markup of counter\n                }\n            });\n        }\n\n\n        // ajusta o tamanho do mapa internamente no leaflet\n\n        function adjustHeader() {\n            // @TODO: pra otimizar a performance só calcular e executar a animação se esta ainda não terminou para o sentido do scroll,\n            // exemplo: se está scrollando pra baixo e o header já está oculto não precisa calcular e mover ele\n            var $mapa, $editableEntity, $busca, $mapa, buscaTop, headerDosResultadosHeight,\n                    scrollTop = $(this).scrollTop(),\n                    diffScrollTop = (lastScrollTop - scrollTop),\n                    newHeaderTop = parseInt($mainHeader.css('top')) + diffScrollTop;\n\n            if ($('#header-search-row').length) {\n                $busca = $('#header-search-row');\n                $mapa = $('#search-map-container');\n                if (!$busca.parent().is($mainHeader)) {\n                    $mainHeader.append($('<div id=\"header-nav-row\" class=\"clearfix\">').append($mainHeader.find('>*')));\n                    $busca.appendTo($mainHeader);\n                }\n\n                headerDosResultadosHeight = $(\"#search-results-header\").outerHeight(true);\n\n                headerHeight = $mainHeader.outerHeight() - headerDosResultadosHeight;\n\n                buscaTop = $mainHeader.outerHeight(true);\n\n                if (buscaTop < 0)\n                    buscaTop = 0;\n//                $busca.css({position: 'fixed', top: buscaTop, zIndex: 123});\n\n\n                $('#lista').css('margin-top', headerHeight + headerDosResultadosHeight);\n\n                if ($mapa.is(':visible')) {\n                    $busca.addClass('sombra');\n\n                    $mapa.css('top', newHeaderTop + headerHeight + headerDosResultadosHeight);\n\n                    if ($mapa.data('oldHeight') != $mapa.height() && window.leaflet)\n                        window.leaflet.map.invalidateSize();\n\n                    if ($('#infobox'))\n                        $('#infobox').height($('#search-map-container').height() - 44)\n\n                    $mapa.data('oldHeight', $mapa.height());\n                } else if (scrollTop == 0 && !$mapa.is(':visible'))\n                    $busca.removeClass('sombra');\n                else\n                    $busca.addClass('sombra');\n\n\n                $('body').css('min-height', $(window).height() + headerHeight - headerDosResultadosHeight - 30);\n\n            }\n\n            if (newHeaderTop <= -headerHeight) {\n                newHeaderTop = -headerHeight;\n\n            } else if (newHeaderTop >= 0) {\n                newHeaderTop = 0;\n\n            } else if (newHeaderTop < -$(window).scrollTop()) {\n                newHeaderTop = -$(window).scrollTop();\n            }\n            if (parseInt($mainHeader.css('top')) <= -headerHeight + 3)\n                $mainHeader.removeClass('sombra');\n            else\n                $mainHeader.addClass('sombra');\n\n            $mainHeader.css('top', newHeaderTop);\n\n\n\n            if ($('#editable-entity:visible').length) {\n                $editableEntity = $('#editable-entity');\n\n                $editableEntity.css('top', newHeaderTop + headerHeight);\n\n                //Sugestão de colocar o logo e outras coisas na edit bar:\n                // if scrolltop > x\n                if ($editableEntity.position().top == 0) {\n                    $mainHeader.removeClass('sombra');\n                    $editableEntity.addClass('sombra');\n                    $('#small-brand').stop().fadeIn(100);\n                } else {\n                    $editableEntity.removeClass('sombra');\n                    $('#small-brand').stop().fadeOut(100);\n                }\n\n            }\n\n            lastScrollTop = scrollTop;\n        }\n\n        // animações do scroll\n        $(window).scroll(adjustHeader).resize(adjustHeader);\n        adjustHeader();\n        window.adjustHeader = adjustHeader;\n\n        $('ul.abas').each(function() {\n            // For each set of tabs, we want to keep track of\n            // which tab is active and it's associated content\n            var $active, $content, $links = $(this).find('a');\n\n            // If the location.hash matches one of the links, use that as the active tab.\n            // If no match is found, use the first link as the initial active tab.\n            $active = $($links.filter('[href=\"' + location.hash + '\"]')[0] || $links[0]);\n            $active.parent().addClass('active');\n            $content = $($active.attr('href'));\n\n            // Hide the remaining content\n            $links.not($active).each(function() {\n                $($(this).attr('href')).hide();\n            });\n\n            $links.each(function() {\n                $(this).attr('id', 'tab-' + $(this).attr('href').replace('#', ''));\n            });\n\n\n            // Bind the click event handler\n            $(this).on('click', 'a', function(e) {\n                // Make the old tab inactive.\n                $active.parent().removeClass('active');\n                $content.hide();\n\n                // Update the variables with the new link and content\n                $active = $(this);\n                $content = $($(this).attr('href'));\n\n                // Make the tab active.\n                $active.parent().addClass('active');\n                $content.show();\n\n                // Prevent the anchor's default click action\n                e.preventDefault();\n\n                location.hash = $(this).attr('id').replace('tab-', 'tab=');\n            });\n\n            $links.each(function() {\n                if (location.hash.toString().replace('#', '') === $(this).attr('id').replace('tab-', 'tab=')) {\n                    $(this).click();\n                }\n            });\n        });\n\n\n\n        $('.tag-box div').slimScroll({\n            position: 'right',\n            distance: '0px',\n            color: '#000',\n            height: '148px',\n            alwaysVisible: true,\n            railVisible: true\n        });\n        $('.submenu-dropdown .filter-list').slimScroll({\n            position: 'right',\n            distance: '3px',\n            color: '#000',\n            height: '222px',\n            alwaysVisible: true,\n            railVisible: true\n        });\n        $('.js-slimScroll').each(function() {\n\n            $(this).slimScroll({\n                position: 'right',\n                distance: '0px',\n                color: '#000',\n                height: '192px'\n            });\n\n            $(this).css({height: 'initial', maxHeight: 192}).parents('.slimScrollDiv').css({height: 'initial', maxHeight: 216});\n        });\n\n        $('#share-tools a.icon-share').click(function() {\n            if ($('form#share-url').is(':hidden')) {\n                $('form#share-url').show();\n                var $input = $('form#share-url input');\n                $input.on('focus click', function() {\n                    window.setTimeout(function() {\n                        $input.select();\n                    }, 0);\n                }).focus();\n                //$input.focus();\n                event.stopPropagation();\n            } else {\n                $('form#share-url').hide();\n            }\n        });\n        $('html').on('click', function(event) {\n            if (!$(event.target).parents('#share-tools').length) {\n                $('form#share-url').hide();\n            }\n        });\n\n        //Botão de busca da home\n        if($('#home-search-form').length){\n            $('#campo-de-busca').focus();\n            $('#home-search-filter .submenu-dropdown li').click(function() {\n                var url_template = $(this).data('searh-url-template') ?\n                        $(this).data('searh-url-template') : $(\"#home-search-filter\").data('searh-url-template');\n\n                var params = {\n                    entity: $(this).data('entity'),\n                    keyword: $('#campo-de-busca').val()\n                };\n                var search_url = Mustache.render(url_template, params);\n                document.location = search_url;\n            }).on('keydown', function(event){\n\n                if(event.keyCode === 13 || event.keyCode === 32){\n                    event.preventDefault();\n                    $(this).click();\n                }else if(event.keyCode === 27){\n                    $(this).attr('css', '');\n                    $(this).blur();\n                    $('#campo-de-busca').focus();\n                    return false;\n                }else if(event.keyCode === 38){\n                    // up\n                    if($('#home-search-filter .submenu-dropdown li:focus').is($('#home-search-filter .submenu-dropdown li:first'))){\n                       $('#home-search-filter .submenu-dropdown li:last').focus();\n                    }else{\n                        $('#home-search-filter .submenu-dropdown li:focus').prev().focus();\n                    }\n                    event.preventDefault();\n\n                }else if(event.keyCode === 40){\n                    // down\n                    if($('#home-search-filter .submenu-dropdown li:focus').is($('#home-search-filter .submenu-dropdown li:last'))){\n                       $('#home-search-filter .submenu-dropdown li:first').focus();\n                    }else{\n                        $('#home-search-filter .submenu-dropdown li:focus').next().focus();\n                    }\n                    event.preventDefault();\n                }\n\n            });\n\n            $('#home-search-form').on('submit', function(){\n                $('.submenu-dropdown').css({display:'block',opacity:1});\n                $('.submenu-dropdown li:first').focus();\n                return false;\n            });\n            $('#home-search-form #campo-de-busca').on('blur', function(){\n                $('.submenu-dropdown').attr('style','');\n            });\n            $('#home-search-form #campo-de-busca').on('keydown', function(event){\n                var kc = event.keyCode;\n                if(event.keyCode === 9){\n                    $('.submenu-dropdown').css({display:'block',opacity:1});\n                }\n            });\n            var tabindex = 1;\n            $('.submenu-dropdown li').each(function(){\n                tabindex++;\n                $(this).attr('tabindex', tabindex);\n                $(this).on('focus', function(){\n                    $('.submenu-dropdown').css({display:'block',opacity:1});\n                });\n                $(this).on('blur', function(){\n                    $('.submenu-dropdown').attr('style','');\n                });\n            });\n        }\n        //Scroll da Home ////////////////////////////////////////////////////\n\n        $('#home-intro div.view-more a').click(function() {\n            $('nav#home-nav a.down').click();\n            return false;\n        });\n\n        if ($('.js-page-menu-item').length) {\n            var $items = $('.js-page-menu-item');\n\n            // encontra o próximo item para o scroll para baixo\n            var find_next_page_menu_item = function() {\n                var $next_page_item = null;\n\n                $items.each(function() {\n                    if ($(this).offset().top - $(window).scrollTop() > $('#main-header').outerHeight(true) + 50) {\n                        $next_page_item = $(this);\n                        return false;\n                    }\n                });\n\n                return $next_page_item;\n            };\n\n            // encontra o próximo item para o scroll para cima\n            var find_prev_page_menu_item = function() {\n                var $next_page_item = null;\n\n                $items.each(function() {\n                    if ($(this).offset().top - $(window).scrollTop() < 0) {\n                        $next_page_item = $(this);\n                    } else {\n                        return false;\n                    }\n                });\n\n                return $next_page_item;\n            };\n\n            // oculta a setinha de scroll se estiver no topo ou no final da página\n            var show_hide_scrolls = function(skip_animation) {\n                var speed = skip_animation ? 0 : 200;\n                find_prev_page_menu_item() ?\n                        $('nav#home-nav a.up').animate({opacity: 1}, speed) :\n                        $('nav#home-nav a.up').animate({opacity: 0}, speed);\n\n                if(find_next_page_menu_item()){\n                    $('nav#home-nav a.down').animate(speed);\n                    $('nav#home-nav a.down').fadeIn(speed);\n                } else {\n                    $('nav#home-nav a.down').fadeOut(speed);\n                }\n            };\n\n            var scroll_timeout = null;\n            $(window).scroll(function() {\n                clearTimeout(scroll_timeout);\n                scroll_timeout = setTimeout(show_hide_scrolls, 100);\n            });\n\n            $('nav#home-nav a.down').click(function() {\n                var __this = this;\n                var $next_page_item = find_next_page_menu_item();\n                var scrollto;\n\n                if ($next_page_item) {\n\n                    scrollto = $next_page_item.offset().top;// - $('#main-header').outerHeight(true);\n\n\n                    $('html, body').animate({scrollTop: Math.ceil(scrollto)}, 800, function() {\n                        nav_mouseenter.apply(__this, [true]);\n                    });\n                }\n                return false;\n            });\n\n\n            $('nav#home-nav a.up').click(function() {\n                var __this = this;\n                var $next_page_item = find_prev_page_menu_item();\n                var scrollto;\n\n                if ($next_page_item) {\n                    scrollto = $next_page_item.offset().top - $('#main-header').outerHeight(true);\n\n\n                    $('html, body').animate({scrollTop: Math.ceil(scrollto)}, 800, function() {\n                        nav_mouseenter.apply(__this, [true]);\n                    });\n                } else {\n                    $('body').animate({scrollTop: 0}, 800, function() {\n                        nav_mouseenter.apply(__this, [true]);\n                    });\n                }\n                return false;\n            });\n\n            $('nav#home-nav a').not('.up').not('.down').click(function() {\n                var $target = $($(this).attr('href'));\n                scrollto = $target.offset().top - $('#main-header').outerHeight(true);\n                if (scrollto > $('body').scrollTop())\n                    scrollto += $('#main-header').outerHeight(true);\n                $('html, body').animate({scrollTop: Math.ceil(scrollto)});\n                return false;\n            });\n\n            // Copiado do Ski Brasil, essa parte aqui debaixo não sei se está sendo usada\n            var nav_mouseenter = function(skip_show) {\n\n                if ($(\"#page-menu\").is(':visible'))\n                    return;\n\n                var $page_item = $(this).hasClass('up') ? find_prev_page_menu_item() : find_next_page_menu_item();\n                if ($page_item) {\n                    if (skip_show !== true)\n                        $(this).find('.balao').show();\n\n                    $(this).find('.balao').find('.balao-text').html($page_item.data('menu-label'));\n\n                } else {\n                    $(this).find('.balao').hide().find('.balao-text').html('');\n                }\n\n            };\n\n            $('nav#home-nav a.up, nav#home-nav a.down').mouseenter(nav_mouseenter).mouseleave(function() {\n                $(this).find('.balao').hide().find('.balao-text').html('');\n            });\n        } else {\n            $('nav#home-nav').hide();\n        }\n\n\n        ////////// Menu da Home //////////\n\n        $('#home-nav ul span.nav-title').each(function() {\n            $(this).css('margin-left', ($(this).width() * -1) + 'px');\n            //$(this).css('margin-left', '40px');\n        })\n\n        $('#home-nav ul li a').hover(function() {\n            $(this).siblings('span.nav-title').animate({marginLeft: '40px'}, 'fast');\n        }, function() {\n            var $slider = $(this).siblings('span.nav-title');\n            $slider.animate({marginLeft: ($slider.width() * -1) + 'px'}, 'fast');\n        });\n\n    });\n\n    $(document).ready(function() {\n        hl.tip.init();\n    });\n\n    hl = {\n        /**\n         * modo de usar: <tag class=\".hltip\" title=\"Title: Content text\" >\n         */\n        tip: {\n            init: function() {\n\n                if(window.isTouchDevice) return false;\n\n                $(document.body).on('mouseenter click', \".hltip\", function(e) {\n                    var tip = $(this).data('tip');\n                    var $this = $(this);\n                    var _left = $(this).offset().left + $this.outerWidth(true) / 2 + $(document).scrollLeft();\n                    var _top = $(this).offset().top;\n                    var _height = $(this).height();\n\n                    //alterações para poder atualizar o hltip\n                    if (!tip || $(this).hasClass('hltip-auto-update')) {\n                        var content = $(this).attr('title') ? $(this).attr('title') : $(this).attr('hltitle');\n\n                        if (content.indexOf(':') > 0) {\n                            content = '<div class=\"hltip-title\">' + (content.substr(0, content.indexOf(':'))) + '</div>' + (content.substr(content.indexOf(':') + 1));\n                        }\n                        tip = $('<div class=\"hltip-box\"><div class=\"hltip-arrow-top\"></div><div class=\"hltip-text\">' + content + '</div><div class=\"hltip-arrow-bottom\"></div></div><').hide();\n                        tip.css({\n                            position: 'absolute',\n                            zIndex: 9999\n                        });\n                        $(document.body).append(tip);\n                        tip.css('width', tip.width());\n                        $(this).data('tip', tip);\n                        $(this).attr('hltitle', content);\n                        $(this).attr('title', '');\n                        if ($(this).data('hltip-classes'))\n                            tip.attr('class', $(this).data('hltip-classes') + ' hltip-box');\n                    }\n\n                    _left -= tip.width() / 2;\n\n                    if (_left + tip.width() - $(document).scrollLeft() > $(window).width() - 11)\n                        tip.css('left', $(window).width() - 11 - tip.width() + $(document).scrollLeft());\n                    else if (_left - $(document).scrollLeft() < 6)\n                        tip.css('left', $(document).scrollLeft() + 6);\n                    else\n                        tip.css('left', _left);\n\n                    var diff = $(this).offset().left + $this.outerWidth(true) / 2 + $(document).scrollLeft() - parseInt(tip.css('left'));\n\n                    if (diff < 1)\n                        diff = 1;\n                    else if (diff > parseInt(tip.outerWidth()) - 11)\n                        diff = parseInt(tip.outerWidth()) - 11;\n\n                    if ($(window).height() + $(document).scrollTop() - 11 < _top + _height + tip.height()) {\n                        tip.find('.hltip-arrow-top').hide();\n                        tip.find('.hltip-arrow-bottom').show();\n                        tip.css('top', _top - tip.height() - 6);\n\n                        tip.find('.hltip-arrow-bottom').css('margin-left', diff - tip.find('.hltip-arrow-bottom').outerWidth() / 2);\n                    } else {\n                        tip.find('.hltip-arrow-top').show();\n                        tip.find('.hltip-arrow-bottom').hide();\n                        tip.find('.hltip-arrow-top').css('margin-left', diff - tip.find('.hltip-arrow-top').outerWidth() / 2);\n                        tip.css('top', _top + _height + 6);\n                    }\n\n                    if (!tip.is(':visible')) {\n                        tip.fadeIn('fast');\n                    }\n                });\n\n                $(document.body).on('mouseleave mouseup', \".hltip\", function(e) {\n                    if ($(this).data('tip'))\n                        $(this).data('tip').fadeOut('fast');\n\n                });\n            }\n\n        }\n    };\n})(jQuery);\n","MapasCulturais = MapasCulturais || {};\n\n$(function(){\n//    $.fn.select2.defaults.separator = '; ';\n//    $.fn.editabletypes.select2.defaults.viewseparator = '; ';\n    MapasCulturais.TemplateManager.init();\n    MapasCulturais.Modal.initKeyboard('.js-dialog');\n    MapasCulturais.Modal.initDialogs('.js-dialog');\n    MapasCulturais.Modal.initButtons('.js-open-dialog');\n\n    MapasCulturais.EditBox.initBoxes('.js-editbox');\n    MapasCulturais.EditBox.initButtons('.js-open-editbox');\n\n\n    MapasCulturais.Video.setupVideoGallery('.js-videogallery');\n    MapasCulturais.Search.init(\".js-search\");\n\n    // bind alert close buttons\n    $('.alert .close').click(function(){\n        $(this).parent().slideUp('fast');\n    }).css('cursor', 'pointer');\n    \n    if(MapasCulturais.request.controller === 'app'){\n        MapasCulturais.App.init();\n    }\n\n    // dropdown\n\n    if(MapasCulturais.request.controller === 'project') {\n        var $els = $('#tab-inscricoes,#tab-inscritos').parent();\n        if(!MapasCulturais.entity.useRegistrations){\n            $els.hide();\n        }\n        $('#editable-use-registrations').on('hidden', function(e, reason) {\n            if($(this).editable('getValue', true) == '1'){\n                $els.fadeIn('fast');\n            }else{\n                $els.fadeOut('fast');\n            }\n        });\n    }\n\n    //main nav submenus toggle on click\n    $('body').on('click', '.js-submenu-toggle', function(){\n        var $self = $(this),\n            $target = eval($self.data('submenu-target'));\n        //hides by clicking outside\n        $('body').one('click', function(event){\n            if($self.find(event.target).length == 0){\n                $target.fadeOut(0);\n            }\n        });\n        $target.fadeToggle(100);\n    });\n\n    $('body').on('click', '.dropdown .placeholder', function(){\n        var $dropdown = $(this).parents('.dropdown'),\n            $submenu = $dropdown.find('.submenu-dropdown');\n\n        if($submenu.is(':visible')){\n            $submenu.hide();\n        }else{\n            $submenu.show();\n        }\n\n        if(!$dropdown.data('init')){\n            $dropdown.data('init', true);\n\n            if($dropdown.data('closeonclick')){\n                $submenu.click(function(){\n                    $submenu.hide();\n                });\n            }\n            //mouse leave disabled\n            // var $timeout;\n            // $submenu.on('mouseleave', function(){\n            //     $timeout = setTimeout(function(){\n            //         $submenu.hide();\n            //     }, 100);\n            // });\n            // $submenu.on('mouseenter', function(){\n            //     clearTimeout($timeout);\n            // });\n            // $dropdown.on('mouseenter', function(){\n            //     clearTimeout($timeout);\n            // });\n            $('body').on('click', function(event){\n                if($submenu.find(event.target).length == 0 && $dropdown.find(event.target).length == 0){\n                    $submenu.hide();\n                }\n            });\n        }\n    });\n\n     if($('#funcao-do-agente').length){\n        $('#funcao-do-agente .js-options li').click(function(){\n            var roleToRemove = $('#funcao-do-agente .js-selected span').data('role');\n            var roleToAdd = $(this).data('role');\n            var label = $(this).find('span').html();\n\n            var change = function(){\n                $('#funcao-do-agente .js-selected span').html(label);\n                $('#funcao-do-agente .js-selected span').data('role', roleToAdd);\n            };\n\n            if(roleToRemove)\n                $.post(MapasCulturais.baseURL + 'agent/removeRole/' + MapasCulturais.entity.id, {role: roleToRemove}, function(r){ if(r && !r.error) change(); });\n\n            if(roleToAdd)\n                $.post(MapasCulturais.baseURL + 'agent/addRole/' + MapasCulturais.entity.id, {role: roleToAdd}, function(r){ if(r && !r.error) change(); });\n\n\n        });\n    }\n\n    MapasCulturais.spinnerURL = MapasCulturais.assetURL + '/img/spinner.gif';\n\n\n    // identify Internet Explorer\n    if(navigator.appName != 'Microsoft Internet Explorer' && !(navigator.appName == 'Netscape' && navigator.userAgent.indexOf('Trident') !== -1)){\n        //not IE\n    }else{\n        // is IE\n        $('body').addClass('ie');\n        //identify version\n        var ua = navigator.userAgent.toLowerCase();\n        if(!isNaN(version = parseInt(ua.split('msie')[1]))){ // 7, 8, 9, 10\n            $('body').addClass('ie'+version);\n        }else if( parseInt(ua.split('rv:')[1]) === 11) { // 11\n            $('body').addClass('ie11');\n        }\n    }\n\n    if(MapasCulturais.entity){\n        MapasCulturais.entity.getTypeName = function(){\n            switch(MapasCulturais.request.controller){\n                case 'agent' : return 'agente'; break;\n                case 'space' : return 'espaço'; break;\n                case 'event' : return 'evento'; break;\n                case 'project' : return 'projeto'; break;\n            }\n        };\n    }\n\n});\n\nMapasCulturais.utils = {\n    getObjectProperties: function (obj) {\n        var keys = [];\n        for (var key in obj) {\n            keys.push(key);\n        }\n        return keys;\n    },\n    sortOjectProperties: function(obj){\n        var newObj = {};\n\n        this.getObjectProperties(obj).sort().forEach(function(e){\n            newObj[e] = obj[e];\n        });\n\n        return newObj;\n    },\n\n    isObjectEquals: function(obj1, obj2){\n//        console.log(JSON.stringify(this.sortOjectProperties(obj1)), JSON.stringify(this.sortOjectProperties(obj2)));\n        return JSON.stringify(this.sortOjectProperties(obj1)) === JSON.stringify(this.sortOjectProperties(obj2));\n    },\n\n    inArray: function(array, obj){\n        for(var i in array){\n            if(this.isObjectEquals(array[i], obj)){\n                return true;\n            }\n        }\n        return false;\n    },\n\n    arraySearch: function(array, obj){\n        for(var i in array){\n            if(this.isObjectEquals(array[i], obj)){\n                return i;\n            }\n        }\n        return false;\n    }\n};\n\nMapasCulturais.createUrl = function(controller_id, action_name, args){\n    var shortcuts = this.routes.shortcuts,\n        actions = this.routes.actions,\n        controllers = this.routes.controllers,\n\n        u = MapasCulturais.utils,\n        route = '';\n\n    action_name = action_name || this.routes.default_action_name;\n\n    if(args){\n        args = u.sortOjectProperties(args);\n    }\n\n    if(args && u.inArray(shortcuts, [controller_id, action_name, args])){\n        route = u.arraySearch(shortcuts, [controller_id, action_name, args]) + '/';\n        args = null;\n    }else if(u.inArray(shortcuts, [controller_id, action_name])){\n        route = u.arraySearch(shortcuts, [controller_id, action_name]) + '/';\n    }else{\n        if(u.inArray(controllers, controller_id)){\n            route = u.arraySearch(controllers, controller_id) + '/';\n        }else{\n            route = controller_id + '/';\n        }\n\n        if(action_name !== this.routes.default_action_name){\n            if(u.inArray(actions, action_name)){\n                route += u.arraySearch(actions, action_name) + '/';\n            }else{\n                route += action_name + '/';\n            }\n        }\n    }\n\n    if(args){\n        for(var key in args){\n            var val = args[key];\n            if(key == parseInt(key)){ // is integer\n                route += val + '/';\n            }else{\n                route += key + ':' + val + '/';\n            }\n        }\n    }\n\n    return MapasCulturais.baseURL + route;\n};\n\nMapasCulturais.auth = {\n    cb: null,\n    require: function(cb){\n        MapasCulturais.auth.cb = cb;\n            $('#require-authentication').attr('src',MapasCulturais.baseURL + 'panel/requireAuth').fadeIn();\n    },\n\n    finish: function(){\n        if(MapasCulturais.auth.cb){\n            MapasCulturais.auth.cb();\n        }\n\n        MapasCulturais.auth.cb = null;\n        $('#require-authentication').fadeOut();\n    }\n}\n\nMapasCulturais.TemplateManager = {\n    templates: {},\n    init: function(){\n        var $templates = $('.js-mustache-template');\n        var $this = this;\n        $templates.each(function(){\n            $this.templates[$(this).attr('id')] = $(this).text();\n            $(this).remove();\n        });\n    },\n\n    getTemplate: function(id){\n        if(this.templates[id])\n            return this.templates[id];\n        else\n            return null;\n    }\n};\n\nMapasCulturais.App = {\n    init: function(){\n        $('.js-select-on-click').on('click', function(){\n            var selector = $(this).data('selectTarget');\n            $(selector).trigger('doubleClick');\n        });\n        \n        if($('.js-input--app-key').length && $('.js-input--app-key--toggle').length){\n            $('.js-input--app-key--toggle').on('click', function(){\n                if($('.js-input--app-key').attr('type') === 'password'){\n                    $('.js-input--app-key').attr('type', 'text');\n                }else{\n                    $('.js-input--app-key').attr('type', 'password');\n                }\n                \n                return false;\n            });\n        }\n    }\n};\n\nMapasCulturais.defaultAvatarURL = MapasCulturais.assets.avatarAgent;\n\nfunction editableEntityAddHash(){\n    $('#editable-entity').find('.js-toggle-edit').each(function(){\n        var href = $(this).attr('href'),\n            cleanHref = href.indexOf('#') !== -1 ? href.split('#')[0] : href;\n        $(this).attr('href', cleanHref+location.hash);\n    });\n}\njQuery(document).ready(function(){\n    editableEntityAddHash();\n    $(window).on('hashchange', function(){\n        editableEntityAddHash();\n    });\n});\n\n\nMapasCulturais.Messages = {\n    delayToFadeOut: 5000,\n    fadeOutSpeed: 'slow',\n    showMessage: function(type, message) {\n        var $container = $('#editable-entity');\n        var $message = $('<div class=\"alert ' + type + '\">\"').html(message);\n        var $mainSection = $('#main-section');\n        var delayToFadeOut = this.delayToFadeOut;\n        $container.append($message);\n\n        if($container.hasClass('js-not-editable')){\n            $container.slideDown('fast');\n            $mainSection.animate({marginTop: parseInt($mainSection.css('margin-top')) + 42}, 'fast', function(){\n                $message.css('display', 'inline-block').css('display', 'inline-block').delay(delayToFadeOut).fadeOut(this.fadeOutSpeed, function() {\n                    $(this).remove();\n                    if($container.find('>').length === 0){\n                        $container.slideUp('fast');\n                        $mainSection.animate({marginTop: parseInt($mainSection.css('margin-top')) - 42}, 'fast');\n                    }\n                });\n            });\n        }else{\n            $message.css('display', 'inline-block').css('display', 'inline-block').delay(delayToFadeOut).fadeOut(this.fadeOutSpeed, function() {\n                $(this).remove();\n            });\n        }\n\n    },\n    success: function(message) {\n        this.showMessage('success', message);\n    },\n    error: function(message) {\n        this.showMessage('danger', message);\n    },\n    help: function(message) {\n        this.showMessage('info', message);\n    },\n    alert: function(message) {\n        this.showMessage('warning', message);\n    }\n\n}\n\nMapasCulturais.confirm = function (message, cb){\n    if(confirm(message))\n        cb();\n};\n\nMapasCulturais.Modal = {\n    time: 'fast',\n    initKeyboard: function (selector){\n        $(document.body).keyup(function (e){\n            if(e.keyCode == 27){\n                $(selector).each(function(){\n                   if($(this).is(':visible')) {\n                       $(this).find('.js-close').click();\n                   }\n                });\n            }\n        });\n    },\n\n    initDialogs: function(selector){\n        $(selector).each(function(){\n            $('body').append($(this));\n            if($(this).find('.js-dialog-disabled').length)\n                return;\n\n            if($(this).data('dialog-init'))\n                return;\n\n            var $dialog = $(this);\n            /*$dialog.hide();  Moved to style.css */\n\n            $dialog.data('dialog-init', 1);\n            $dialog.prepend('<h2>' + $(this).attr('title') + '</h2>');\n            $dialog.prepend('<a href=\"#\" class=\"js-close icon icon-close\"></a>');\n\n            // close button\n            $dialog.find('.js-close').click(function (){\n                MapasCulturais.Modal.close(selector);\n                return false;\n            });\n        });\n    },\n\n    initButtons: function(selector){\n\n        if($(selector).data('button-initialized')) return false;\n        else $(selector).data('button-initialized', true);\n        $(selector).each(function(){\n            var dialog_selector = $(this).data('dialog');\n            var $dialog = $(dialog_selector);\n            if($dialog.find('.js-dialog-disabled').length)\n                $(this).addClass('inactive').addClass('hltip').attr('title', $dialog.find('.js-dialog-disabled').data('message'));\n\n        });\n        $(selector).click(function(){\n            if($(this).hasClass('inactive'))\n                return false;\n\n            var dialog_selector = $(this).data('dialog');\n            MapasCulturais.Modal.open(dialog_selector);\n            if( $(this).data('dialog-callback') )\n                eval( $(this).data('dialog-callback'))($(this));\n            return false;\n        });\n    },\n\n    close: function(selector){\n        $('body').css('overflow','auto');\n        var $dialog = $(selector);\n        //alert('closing');\n        $dialog.find('.editable').editable('hide');\n        $dialog.hide();\n        return;\n    },\n\n    open: function(selector){\n        var $dialog = $(selector);\n\n        $dialog.find('div.alert.danger').html('').hide();\n        $dialog.find('.js-ajax-upload-progress').hide();\n        $dialog.css('opacity',0).show();\n        setTimeout(function(){\n           var top = $dialog.height() + 100 > $(window).height() ? $(window).scrollTop() + 100 : $(window).scrollTop() + ( $(window).height() - $dialog.height()) / 2 - 50;\n\n           $dialog.css({\n                top: top,\n                left: '50%',\n                marginLeft: -$dialog.width() / 2,\n                opacity: 1\n            });\n        },25);\n\n\n        return;\n    }\n};\n\n\nMapasCulturais.EditBox = {\n    time: 'fast',\n\n    setPosition: function($box, target){\n        if($box.hasClass('mc-left')){\n            $box.position({\n                my: 'right-10 center',\n                at: 'left center',\n                of: target\n            });\n\n        }else if($box.hasClass('mc-right')){\n            $box.position({\n                my: 'left+10 center',\n                at: 'right center',\n                of: target\n            });\n\n        }else if($box.hasClass('mc-top')){\n            $box.position({\n                my: 'center bottom-10',\n                at: 'center top',\n                of: target\n            });\n\n        }else if($box.hasClass('mc-bottom')){\n            $box.position({\n                my: 'center top+10',\n                at: 'center bottom',\n                of: target\n            });\n        }\n    },\n\n    initKeyboard: function (selector){\n        $(document.body).keyup(function (e){\n            if(e.keyCode == 27){\n                $(selector).each(function(){\n                   if($(this).is(':visible')) {\n                       $(this).find('.js-close').click();\n                   }\n                });\n            }\n        });\n    },\n\n    initBoxes: function(selector){\n\n        $(selector).each(function(){\n            var $dialog = $(this);\n\n            if($dialog.find('.js-dialog-disabled').length)\n                return;\n\n            if($dialog.data('dialog-init'))\n                return;\n\n            if($dialog.data('init'))\n                return;\n\n            $dialog.data('init', true);\n\n            /*$dialog.hide();  Moved to style.css */\n\n            $dialog.addClass('edit-box');\n\n            $dialog.data('dialog-init', 1);\n            if($dialog.attr('title')){\n                $dialog.prepend('<header><h1>' + $(this).attr('title') + '</h1></header>');\n            }\n            var submit_label = $dialog.data('submit-label') ? $dialog.data('submit-label') : 'Enviar';\n            var cancel_label = $dialog.data('cancel-label') ? $dialog.data('cancel-label') : 'Cancelar';\n\n            $dialog.append('<footer><button class=\"mc-cancel btn btn-default\">' + cancel_label + '</button> <button type=\"submit\" class=\"mc-submit\">' + submit_label + '</button> </footer><div class=\"mc-arrow\"></div>');\n\n            // close button\n            $dialog.find('.mc-cancel').click(function (){\n                MapasCulturais.EditBox.close($dialog);\n                return false;\n            });\n\n            // submit form\n            $dialog.find('footer button.mc-submit').click(function(){\n                $dialog.find('form').submit();\n            });\n        });\n    },\n\n    initButtons: function(selector){\n        $(selector).each(function(){\n            var $button = $(this);\n            var dialog_selector = $(this).data('target');\n            var $dialog = $(dialog_selector);\n            if($dialog.find('.js-dialog-disabled').length)\n                $(this).addClass('inactive').addClass('hltip').attr('title', $dialog.find('.js-dialog-disabled').data('message'));\n\n        });\n        $(selector).click(function(){\n            var $button = $(this);\n            if($button.hasClass('inactive'))\n                return false;\n\n            var dialog_selector = $button.data('target');\n\n            MapasCulturais.EditBox.open(dialog_selector, $button);\n\n            if($button.data('dialog-title'))\n                $(dialog_selector).find('header h1').html($button.data('dialog-title'));\n\n            if( $button.data('dialog-callback') )\n                eval( $button.data('dialog-callback'))($button);\n\n            return false;\n        });\n    },\n\n    close: function(selector){\n        $('body').css('overflow','auto');\n        var $dialog = $(selector);\n        //alert('closing');\n        $dialog.find('.editable').editable('hide');\n        $dialog.hide();\n        return;\n    },\n\n    open: function(selector, $button){\n        var $dialog = $(selector);\n        $dialog.find('div.alert.danger').html('').hide();\n\n        MapasCulturais.AjaxUploader.resetProgressBar(selector);\n\n        $dialog.show();\n        $dialog.find('input,textarea').not(':hidden').first().focus();\n        $dialog.css('opacity',0);\n        MapasCulturais.EditBox.setPosition($dialog, $button);\n        setTimeout(function(){\n            MapasCulturais.EditBox.setPosition($dialog, $button);\n            $dialog.css('opacity',1);\n        },25);\n\n        return;\n    }\n};\n\n\nMapasCulturais.Video = {\n    collection : {},\n    parseURL : function(url){\n        return purl(url);\n    },\n    isYoutube : function(parsedURL){\n            return parsedURL.attr('host').indexOf('youtube') != -1;\n    },\n    getYoutubeData : function(youtubeVideoID){\n        return {\n            thumbnalURL : 'http://img.youtube.com/vi/'+videoID+'/0.jpg',\n            playerURL : '//www.youtube.com/embed/'+videoID+'?html5=1'\n        }\n    },\n    getVideoBasicData : function(url){\n        var parsedURL = this.parseURL(url);\n        var host = parsedURL.attr('host');\n        var provider = '';\n        var videoID = '';\n        if(parsedURL.attr('host').indexOf('youtube') != -1 ){\n            provider = 'youtube';\n            videoID = parsedURL.param('v');\n        }else if(parsedURL.attr('host').indexOf('vimeo') != -1){\n            provider = 'vimeo';\n            videoID = parsedURL.attr('path').split('/')[1];\n        }\n        return {\n            'parsedURL' : parsedURL,\n            'provider' : provider,\n            'videoID' : videoID\n        }\n    },\n    setupVideoGallery : function(gallerySelector){\n\n        if($(gallerySelector).length == 0)\n            return false;\n\n        $( gallerySelector + ' .js-metalist-item-display').each(function(){\n            MapasCulturais.Video.getAndSetVideoData($(this).data('videolink'), $(this).parent(), MapasCulturais.Video.setupVideoGalleryItem);\n        });\n        var $firstItem = $( gallerySelector + ' .js-metalist-item-display:first').parent();\n        if(!$firstItem.length) {\n            $('#video-player').hide();\n            return false;\n        }\n        $('iframe#video_display').attr('src', $firstItem.data('player-url'));\n        $firstItem.addClass('active');\n    },\n    setupVideoGalleryItem : function(videoData, $element){\n        //$Element should be a.js-metalist-item-display\n        $element.attr('href', '#video');\n        $element.data('player-url', videoData.playerURL);\n        $element.find('img').attr('src', videoData.thumbnailURL);\n\n        var video_id = $element.attr('id');\n\n        $element.on('click', function(){\n            $('iframe#video_display').attr('src', videoData.playerURL);\n            $('iframe#video_display').data('open-video', $(this).attr('id'));\n            $(this).parent().find('.active').removeClass('active');\n            $(this).addClass('active');\n        });\n\n        var $container = $element.parent();\n        if($element.find('.js-remove-item').length){\n            $element.find('.js-remove-item').data('remove-callback', function(){\n                if($('iframe#video_display').data('open-video') == video_id)\n                    $('iframe#video_display').attr('src', '');\n\n                if($container.find('>li').length == 0)\n                    $('#video-player').hide();\n            });\n        }\n\n        if($container.find('>li').length == 1){\n            $element.addClass('active');\n            $('iframe#video_display').attr('src', videoData.playerURL);\n        }\n\n    },\n    setTitle : function(videoData, $element){\n        $element.val(videoData.videoTitle);\n    },\n    getAndSetVideoData : function (videoURL, $element, callback){\n        videoURL = videoURL.trim();\n        var videoData = {\n            parsedURL : purl(videoURL),\n            provider : '',\n            videoID : '',\n            thumbnailURL : '',\n            playerURL : '',\n            details : {}\n        };\n\n        if(videoData.parsedURL.attr('host').indexOf('youtube') != -1){\n            videoData.provider = 'youtube';\n            videoData.videoID = videoData.parsedURL.param('v');\n            videoData.thumbnailURL = 'http://img.youtube.com/vi/'+videoData.videoID+'/0.jpg';\n            videoData.playerURL = '//www.youtube.com/embed/'+videoData.videoID+'?html5=1';\n            callback(videoData, $element);\n            $.getJSON('https://gdata.youtube.com/feeds/api/videos/'+videoData.videoID+'?v=2&alt=json', function(data) {\n                videoData.details = data;\n                videoData.videoTitle = data.entry.title.$t;\n                MapasCulturais.Video.collection[videoURL] = videoData;\n                callback(videoData, $element);\n                return videoData;\n            });\n        }else if(videoData.parsedURL.attr('host').indexOf('vimeo') != -1){\n            videoData.provider = 'vimeo';\n            var tmpArray = videoData.parsedURL.attr('path').split('/');\n            videoData.videoID = tmpArray[tmpArray.length-1];\n            $.getJSON('http://www.vimeo.com/api/v2/video/'+videoData.videoID+'.json?callback=?', {format: \"json\"}, function(data) {\n                videoData.details = data[0];\n                videoData.thumbnailURL = data[0].thumbnail_small;\n                videoData.playerURL = '//player.vimeo.com/video/'+videoData.videoID+'';\n                videoData.videoTitle = data[0].title;\n                callback(videoData, $element);\n                MapasCulturais.Video.collection[videoURL] = videoData;\n                return videoData;\n            });\n        }else{\n            //no valid provider\n            videoData.thumbnailURL = 'http://www.bizreport.com/images/shutterstock/2013/04/onlinevideo_135877229-thumb-380xauto-2057.jpg';\n            callback(videoData, $element);\n            return videoData;\n        }\n\n        var withDetails = function(){\n            // get details from youtube api\n            if(!videoData.details) {\n                $.getJSON('https://gdata.youtube.com/feeds/api/videos/'+videoData.videoID+'?v=2&alt=json', {format: \"json\"}, function(data) {\n                    videoData.details = data;\n                    functionName(videoData, $element);\n                    return videoData;\n                });\n            }\n        };\n    }\n};\n\nMapasCulturais.Search = {\n    limit: 10,\n\n    init : function(selector){\n        if( $(selector).length === 0 || $(selector).hasClass('select2-offscreen')) return false;\n\n        $(selector).each(function(){\n            var $selector = $(this);\n\n            $selector.editable({\n                type:'select2',\n                name: $selector.data('field-name') ? $selector.data('field-name') : null,\n                select2:{\n//                    multiple: $selector.data('multiple'),\n//                    tokenSeparators: [\";\",\";\"],\n//                    separator:'; ',\n//                    viewseparator: '; ',\n                    width: $selector.data('search-box-width'),\n                    placeholder: $selector.data('search-box-placeholder'),\n                    minimumInputLength: 0,\n                    allowClear: $selector.data('allow-clear'),\n                    initSelection: function(e,cb){\n                        cb({id: $selector.data('value'), name: $selector.data('editable').$element.html()});\n                    },\n                    ajax: {\n                        url: function(){\n                            var format = $selector.data('selection-format');\n                            var apiMethod = 'find';\n                            if(MapasCulturais.Search.formats[format] && MapasCulturais.Search.formats[format].apiMethod)\n                                apiMethod =  MapasCulturais.Search.formats[format].apiMethod;\n                            return MapasCulturais.baseURL + 'api/' + $selector.data('entity-controller') + '/' + apiMethod;\n                        },\n                        dataType: 'json',\n                        quietMillis: 350,\n                        data: function (term, page) { // page is the one-based page number tracked by Select2\n                            var searchParams = MapasCulturais.Search.getEntityController(term, page, $selector);\n\n                            var format = $selector.data('selection-format');\n\n                            if(MapasCulturais.Search.formats[format] && MapasCulturais.Search.formats[format].ajaxData)\n                                searchParams = MapasCulturais.Search.formats[format].ajaxData(searchParams, $selector);\n                            else\n                                searchParams = MapasCulturais.Search.ajaxData(searchParams, $selector);\n\n                            return searchParams;\n                        },\n                        results: function (data, page) {\n                            var more = data.length == MapasCulturais.Search.limit;\n                            // notice we return the value of more so Select2 knows if more results can be loaded\n\n                            return {results: data, more: more};\n                        }\n                    },\n                    formatResult: function(entity){\n                        var format = $selector.data('selection-format');\n                        if(MapasCulturais.Search.formats[format] && MapasCulturais.Search.formats[format].result)\n                            return MapasCulturais.Search.formats[format].result(entity, $selector);\n                        else\n                            return MapasCulturais.Search.formatResult(entity, $selector);\n                    }, // omitted for brevity, see the source of this page\n\n                    formatSelection: function(entity){\n                        var format = $selector.data('selection-format');\n                        return MapasCulturais.Search.formats[format].selection(entity, $selector);\n                    }, // omitted for brevity, see the source of this page\n\n                    formatNoMatches: function(term){\n                        var format = $selector.data('selection-format');\n                        return MapasCulturais.Search.formats[format].noMatches(term, $selector);\n                    },\n                    escapeMarkup: function (m) { return m; }, // we do not want to escape markup since we are displaying html in results\n                }\n            });\n            if($selector.data('disable-buttons') ){\n                $selector.on('shown', function(e, editable) {\n                    var format = $selector.data('selection-format');\n\n                    /*Hide editable buttons because the option showbuttons:false autosubmitts the form adding two agents...\n                    Also Auto-open select2 on editable.shown and auto-close editable popup on select2-close*/\n\n                    e.stopPropagation();\n                    if (arguments.length == 2) {\n                        setTimeout(function() {\n                            editable.input.$input.parents('.control-group').addClass('editable-popup-botoes-escondidos');\n                        }, 0);\n                        setTimeout(function() {\n                            editable.input.$input.select2(\"open\");\n                        }, 200);\n                        editable.input.$input.on('select2-close', function(){\n                            setTimeout(function() {\n                                $selector.editable('hide');\n                            }, 200);\n                        });\n                    }\n                });\n            }\n            if($selector.data('auto-open') ){\n                $selector.on('shown', function(e, editable) {\n                    setTimeout(function() {\n                        editable.input.$input.select2(\"open\");\n                    }, 200);\n                });\n            }\n            var format = $selector.data('selection-format');\n            $selector.on('save',function(){\n                try{\n                    MapasCulturais.Search.formats[format].onSave($selector);\n                }catch(e){\n                    console.log(\"EXECEPTION: \", e.message);\n                }\n            });\n            $selector.on('hidden',function(){\n                try{\n                    MapasCulturais.Search.formats[format].onHidden($selector);\n                }catch(e){\n                    console.log(\"EXECEPTION: \", e.message);\n                }\n            });\n\n        });\n    },\n\n\n\n    getEntityController : function(term, page, $selector){\n\n        var entitiyControllers = {\n            'default':{\n                name: 'ilike(*'+term.replace(' ', '*')+'*)', //search term\n                '@select': 'id,name,terms,type',\n                '@limit': MapasCulturais.Search.limit, // page size\n                '@page': page,\n                '@order':'name ASC', // page number\n                '@files':'(avatar.avatarSmall):url'\n            },\n            'agent':{ //apenas adicionei a shortDescription\n                name: 'ilike(*'+term.replace(' ', '*')+'*)', //search term,\n                '@select': 'id,name,terms,type',\n                '@limit': MapasCulturais.Search.limit, // page size\n                '@page': page,\n                '@order':'name ASC', // page number\n                '@files':'(avatar.avatarSmall):url'\n            }\n        };\n\n        if(entitiyControllers[$selector.data('entity-controller')]){\n            return entitiyControllers[$selector.data('entity-controller')];\n        }else{\n            return entitiyControllers['default'];\n        }\n    },\n\n    processEntity: function(entity, $selector){\n        entity.areas = function(){\n            if(this.terms && this.terms.area)\n                return this.terms.area.join(', ');\n            else\n                return '';\n        };\n\n        entity.linguagens = function(){\n            if(this.terms && this.terms.linguagem)\n                return this.terms.linguagem.join(', ');\n            else\n                return '';\n        };\n\n        entity.tags = function(){\n            if(this.terms && this.terms.tags)\n                return this.terms.tags.join(', ');\n            else\n                return '';\n        };\n\n        entity.thumbnail = function(){\n            var entityDefaultAvatar = MapasCulturais.assets['avatar'+$selector.data('entity-controller')[0].toUpperCase() + $selector.data('entity-controller').slice(1)];\n            if(this['@files:avatar.avatarSmall'])\n                return this['@files:avatar.avatarSmall'].url;\n            else\n                return entityDefaultAvatar;\n        };\n\n    },\n\n    renderTemplate : function(template, entity, $selector){\n        this.processEntity(entity, $selector);\n        return Mustache.render(template, entity);\n    },\n\n    getEntityThumbnail : function (entity, thumbName){\n        if(!entity.files || entity.files.length == 0 || !entity.files[thumbName] || entity.files[thumbName].length == 0)\n            return '';\n        else{\n            if(entity.files[thumbName].files['avatarSmall'])\n                return entity.files[thumbName].files['avatarSmall'].url;\n        }\n    },\n\n    formatResult : function (entity, $selector) {\n        var searchResultTemplate = $($selector.data('search-result-template')).text();\n        return this.renderTemplate(searchResultTemplate, entity, $selector);\n    },\n\n    ajaxData: function(searchParams, $selector){\n        var excludedIds = MapasCulturais.request.controller === $selector.data('entity-controller') && MapasCulturais.entity.id ? [MapasCulturais.entity.id] : [];\n\n        if(excludedIds.length > 0)\n            searchParams.id = '!in(' + excludedIds.toString() + ')';\n\n        return searchParams;\n    },\n\n    formats: {\n        chooseProject:{\n            //apiMethod : 'findByUserApprovedRegistration',\n            onSave: function($selector){\n                var entity = $selector.data('entity');\n                $selector.data('value', entity.id);\n                $selector.data('value-name', entity.name);\n            },\n            selection: function(entity, $selector){\n                $selector.data('entity', entity);\n                return entity.name;\n            },\n\n            noMatches: function(term, $selector){\n                return 'Nenhum projeto encontrado.';\n            },\n\n            onClear: function($selector){\n            },\n\n            ajaxData: function(searchParams){\n                searchParams['@permissions'] = 'requestEventRelation';\n                return searchParams;\n            }\n        },\n\n        chooseSpace: {\n            onSave: function($selector){\n                var entity = $selector.data('entity'),\n                    avatarUrl = MapasCulturais.defaultAvatarURL,\n                    shortDescription = entity.shortDescription ? entity.shortDescription.replace(\"\\n\",'<br/>') : '';\n\n                $selector.data('value', entity.id);\n\n                try{\n                    avatarUrl = entity.files.avatar.files.avatarSmall.url;\n                }catch(e){};\n\n                $selector.parents('.js-space').find('.js-space-avatar').attr('src', avatarUrl);\n                $selector.parents('.js-space').find('.js-space-description').html(shortDescription);\n\n                $selector.parents('form').find('input[name=\"spaceId\"]').val(entity.id);\n            },\n            onHidden : function ($selector) {\n                $selector.removeClass('editable-unsaved');\n            },\n\n            selection: function(entity, $selector){\n                $selector.data('entity', entity);\n                return entity.name;\n            },\n\n            noMatches: function(term, $selector){\n                return 'Nenhum espaço encontrado.';\n            },\n\n            onClear: function($selector){ },\n\n            ajaxData: function(searchParams, $selector){\n\n                if($selector.data('value')){\n                    searchParams.id = '!in('+$selector.data('value')+')';\n                }\n\n                //if(!MapasCulturais.cookies.get('mapasculturais.adm'))\n                //    searchParams.owner = 'in(@me.spaces)';\n\n                searchParams['@select'] += ',shortDescription';\n//                searchParams['@permissions'] += '@control';\n                return searchParams;\n            }\n        },\n\n        createAgentRelation: {\n            selection: function (entity, $selector) {\n                var $selectionTarget =   $($selector.data('selection-target'));\n                var targetAction =      $selector.data('target-action');\n                var selectionTemplate = $($selector.data('selection-template')).text();\n\n                var groupname = $selector.parents('.js-related-group').find('.js-related-group-name').text();\n\n                $.post(\n                    MapasCulturais.baseURL + MapasCulturais.request.controller + '/createAgentRelation/id:' + MapasCulturais.entity.id,\n                    {agentId: entity.id, group:groupname, has_control: '0'}\n                );\n\n\n                if(targetAction == 'append'){\n                    MapasCulturais.RelatedAgents.addAgentToGroup(groupname, entity);\n                    return $selector.data('search-box-placeholder');\n                }else{\n                    $selectionTarget.html(markup);\n                    return entity.name;\n                }\n            },\n\n            noMatches: function (term, $selector){\n                var noResultTemplate = $($selector.data('no-result-template')).text();\n                $('#dialog-adicionar-integrante').data('group-element', $selector.parents('.js-related-group').find('.js-relatedAgentsContainer'));\n                //return term + ' HAHAHA!';\n                return noResultTemplate.replace('{{group}}', $selector.parents('.js-related-group').find('.js-related-group-name').text());\n            },\n\n            ajaxData: function(searchParams, $selector){\n                var group = $selector.parents('.js-related-group').find('.js-related-group-name').text();\n\n                var excludedIds = MapasCulturais.request.controller === 'agent' && MapasCulturais.entity.id? [MapasCulturais.entity.id] : [];\n                try{\n                    if(MapasCulturais.agentRelationGroupExludeIds[group])\n                        excludedIds = excludedIds.concat(MapasCulturais.agentRelationGroupExludeIds[group]);\n                }catch(e){}\n\n                excludedIds = excludedIds.concat (\n                    $selector.parents('.js-related-group').find('.agentes .avatar').map(\n                        function(){ return $(this).data('id'); }\n                ).toArray());\n\n\n                if ( excludedIds.length > 0)\n                    searchParams.id = '!in('+excludedIds.toString()+')';\n\n                return searchParams;\n            }\n        },\n\n        parentSpace:{\n            selection: function(entity, $selector){\n                return entity.name;\n            },\n\n            noMatches: function(term, $selector){\n                return 'Nenhum espaço encontrado.';\n            },\n\n            onClear: function($selector){\n            },\n\n            ajaxData: function(searchParams, $selector){\n                if(MapasCulturais.entity.id){\n                    var excludeIds = [MapasCulturais.entity.id].concat(MapasCulturais.entity.childrenIds);\n                    if(excludeIds){\n                        searchParams['id'] = '!IN(' + excludeIds + ')';\n                    }\n\n                }\n                return searchParams;\n            }\n        },\n\n        parentProject:{\n            selection: function(entity, $selector){\n                return entity.name;\n            },\n\n            noMatches: function(term, $selector){\n                return 'Nenhum projeto encontrado.';\n            },\n\n            onClear: function($selector){\n            },\n\n            ajaxData: function(searchParams, $selector){\n                if(MapasCulturais.entity.id){\n                    var excludeIds = [MapasCulturais.entity.id].concat(MapasCulturais.entity.childrenIds);\n                    if(excludeIds){\n                        searchParams['id'] = '!IN(' + excludeIds + ')';\n                    }\n\n                }\n\n                return searchParams;\n            }\n        },\n\n        projectRegistration: {\n            onSave: function($selector){\n                var entity = $selector.data('entity'),\n                    avatarUrl = MapasCulturais.defaultAvatarURL,\n                    shortDescription = entity.shortDescription.replace(\"\\n\",'<br/>');\n\n                $('#registration-agent-id').val(entity.id);\n\n            },\n\n            onHidden : function ($selector) {\n                $selector.removeClass('editable-unsaved');\n            },\n\n            selection: function(entity, $selector){\n                $selector.data('entity', entity);\n                return entity.name;\n            },\n\n            noMatches: function(term, $selector){\n                return 'Nenhum agente encontrado.';\n            },\n\n            onClear: function($selector){ },\n\n            ajaxData: function(searchParams, $selector){\n                var excludedIds = MapasCulturais.request.controller === 'agent' && MapasCulturais.entity.id? [MapasCulturais.entity.id] : [];\n\n                excludedIds.push($selector.data('value'));\n\n                if ( excludedIds.length > 0)\n                    searchParams.id = '!in('+excludedIds.toString()+')';\n\n                if(!MapasCulturais.cookies.get('mapasculturais.adm'))\n                    searchParams.user = 'eq(@me)';\n\n                if($selector.data('profiles-only'))\n                    searchParams.isUserProfile = 'eq(true)';\n\n                searchParams['@select'] += ',shortDescription,';\n                return searchParams;\n            }\n\n        },\n\n        changeOwner:{\n            onSave: function($selector){\n                var entity = $selector.data('entity'),\n                    avatarUrl = MapasCulturais.defaultAvatarURL,\n                    shortDescription = entity.shortDescription.replace(\"\\n\",'<br/>');\n\n                $selector.data('value', entity.id);\n\n                try{\n                    avatarUrl = entity.files.avatar.files.avatarSmall.url;\n                }catch(e){};\n\n                $selector.parents('.js-owner').find('.js-owner-avatar').attr('src', avatarUrl);\n                $selector.parents('.js-owner').find('.js-owner-description').html(shortDescription);\n\n            },\n\n            selection: function(entity, $selector){\n                $selector.data('entity', entity);\n                return entity.name;\n            },\n\n            noMatches: function(term, $selector){\n                return 'Nenhum agente encontrado.';\n            },\n\n            onClear: function($selector){ },\n\n            ajaxData: function(searchParams, $selector){\n                var excludedIds = [$selector.editable('getValue').ownerId];\n\n                if(MapasCulturais.request.controller === 'agent' && MapasCulturais.entity.id){\n                    excludedIds.push(MapasCulturais.entity.id);\n                    if(MapasCulturais.entity.childrenIds){\n                        excludedIds = excludedIds.concat(MapasCulturais.entity.childrenIds);\n                    }\n                }\n\n                if ( excludedIds.length > 0)\n                    searchParams.id = '!in('+excludedIds.toString()+')';\n\n                searchParams['@select'] += ',shortDescription';\n                searchParams['@permissions'] = '@control';\n                return searchParams;\n            }\n        }\n    }\n};\n\n\nMapasCulturais.cookies = {\n    get: function(name) {\n        var nameEQ = name + \"=\";\n        var ca = document.cookie.split(';');\n        for(var i=0;i < ca.length;i++) {\n            var c = ca[i];\n            while (c.charAt(0)==' ') c = c.substring(1,c.length);\n            if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length,c.length);\n        }\n        return null;\n    },\n\n    set: function(key, value, options){\n        options = $.extend({}, options);\n\n        if (value == null) {\n            options.expires = -1;\n        }\n\n        if (typeof options.expires === 'number') {\n            var days = options.expires, t = options.expires = new Date();\n            t.setDate(t.getDate() + days);\n            options.expires = options.expires.toUTCString();\n        }else{\n            options.expires = 'Session';\n        }\n\n        value = String(value);\n\n        return (document.cookie = [\n            encodeURIComponent(key), '=', options.raw ? value : encodeURIComponent(value),\n            options.expires ? '; expires=' + options.expires : '', // use expires attribute, max-age is not supported by IE\n            options.path    ? '; path=' + options.path : '',\n            options.domain  ? '; domain=' + options.domain : '',\n            options.secure  ? '; secure' : ''\n            ].join(''));\n    }\n};\n","//Inicia o mapa para a busca e configura o timeout do scroll\njQuery(document).ready(function() {\n\n    if ($('body').hasClass('action-search')) {\n        MapasCulturais.Map.initialize({mapSelector: '.js-map', locateMeControl: false, exportToGlobalScope: true, mapCenter: MapasCulturais.mapCenter});\n    }\n\n});\n\n\n(function(angular) {\n    var app = angular.module('ng-mapasculturais', []);\n    app.config([\"$httpProvider\", function($httpProvider) {\n\n            $httpProvider.responseInterceptors.push(['$q', '$rootScope', function($q, $rootScope) {\n\n                return function(promise) {\n                    $rootScope.$broadcast(\"event:startProgress\");\n                    return promise\n                        .then(\n                            function(response) {\n                                $rootScope.$broadcast(\"event:endProgress\");\n                                return response;\n                            },\n                            function(response) { //on error\n                                $rootScope.$broadcast(\"event:endProgress\");\n                                return $q.reject(response);\n                            }\n                        );\n\n                };\n            }]);\n        }]);\n})(angular);\n\n","(function(angular){\n    \"use strict\";\n\n    var module = angular.module('mc.module.notifications', []);\n\n    module.factory('NotificationService', ['$log','$http', '$q', '$rootScope', function($log, $http, $q, $rootScope){\n\n        var service = {};\n\n        service.url = MapasCulturais.baseURL + 'notification/';\n\n        service.get = function (){\n            var deferred = $q.defer();\n            $http.get(\n                MapasCulturais.baseURL+'api/notification/find/?&@select=id,status,isRequest,createTimestamp,message,approveUrl,request.permissionTo.approve,request.permissionTo.reject,request.requesterUser.id&user=eq(@me)&@ORDER=createTimestamp%20DESC'\n            ).success(function(data){\n                deferred.resolve(data);\n            }).error(function(){\n                deferred.reject('There was an error');\n            });\n            return deferred.promise;\n        };\n        service.updateOne = function(id, action){\n            var deferred = $q.defer();\n            $http.get(\n                service.url+action+'/'+id)\n            .success(function(data){\n                deferred.resolve(data);\n            }).error(function(){\n                deferred.reject('There was an error');\n            });\n            return deferred.promise;\n        };\n        return service;\n    }]);\n\n    module.controller('NotificationController', ['$log', '$sce', '$scope', '$rootScope', '$interval', 'NotificationService', function($log, $sce, $scope, $rootScope, $interval, NotificationService){\n\n        $scope.panelURI = MapasCulturais.baseURL+'panel';\n        $scope.MapasCulturais = MapasCulturais;\n\n        MapasCulturais.notifications.forEach(function(value,index){\n            MapasCulturais.notifications[index].message = $sce.trustAsHtml(value.message);\n        });\n        $scope.data = MapasCulturais.notifications;\n\n        var getNotifications = function (){\n            NotificationService.get().then(function(data){\n                if(data){\n                    data.forEach(function(value,index){\n                        data[index].message = $sce.trustAsHtml(value.message);\n                    });\n                    $scope.data = data;\n                }\n            });\n        };\n\n        $interval(function(){\n            getNotifications();\n        }, 60*1000);\n\n        $scope.approve = function(id){\n            NotificationService.updateOne(id,'approve').then(getNotifications);\n        };\n        $scope.reject = function(id){\n            NotificationService.updateOne(id,'reject').then(getNotifications);\n        };\n        $scope.delete = function(id){\n            NotificationService.updateOne(id,'delete').then(getNotifications);\n        };\n\n        $scope.adjustScroll = function(){\n            jQuery('.notifications .submenu ul').slimScroll({\n                position: 'right',\n                distance: '0px',\n                color: '#000',\n                height: '316px',\n                alwaysVisible: true,\n                railVisible: true\n            });\n        };\n    }]);\n\n    module.directive('onLastRepeat', function() {\n        return function(scope, element, attrs) {\n            if (scope.$last) { // all are rendered\n                scope.$evalAsync(attrs.onLastRepeat);\n            }\n        };\n    });\n\n    angular.element(document).ready(function(){\n        var app = null;\n        //checks existence of default search and Entity (singles') angular modules\n        ['search.app', 'entity.app'].forEach(function(moduleName){\n            if(!app){\n                try{\n                    app = angular.module(moduleName);\n                }catch(e){}\n            }\n        });\n        //can't find expected app\n        if(!app) {\n            var ctrl = document.querySelector('[ng-controller=NotificationController]');\n\n            // let's search again\n            if(ctrl && !angular.element(ctrl.parentElement).scope()) {\n                angular.bootstrap(ctrl.parentElement, ['mc.module.notifications']);\n            }\n        }\n        app = angular.module('mc.module.notifications');\n    });\n\n})(angular);\n\n\n"]}